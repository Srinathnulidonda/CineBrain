<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Browser - CineScope Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
        }

        .admin-container {
            min-height: 100vh;
            padding-top: 80px;
        }

        .navbar {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(15, 15, 35, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .admin-badge {
            background: linear-gradient(45deg, #ef4444, #dc2626);
            color: #ffffff;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .page-header {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(168, 85, 247, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 1.5rem;
            padding: 2rem;
            margin-bottom: 3rem;
        }

        .search-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .search-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .search-tab {
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            padding: 1rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .search-tab.active {
            color: #ef4444;
        }

        .search-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #ef4444;
        }

        .search-form {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .search-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 0.5rem;
            color: #ffffff;
            padding: 0.875rem 1rem;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #ef4444;
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.2);
        }

        .btn-search {
            background: linear-gradient(45deg, #ef4444, #dc2626);
            border: none;
            padding: 0.875rem 2rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #ffffff;
        }

        .btn-search:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.4);
        }

        .search-filters {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-select {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 0.5rem;
            color: #ffffff;
            padding: 0.5rem 1rem;
            cursor: pointer;
        }

        .results-section {
            margin-top: 2rem;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .results-count {
            color: rgba(255, 255, 255, 0.7);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .result-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .result-card.added {
            border-color: #22c55e;
            background: rgba(34, 197, 94, 0.1);
        }

        .result-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .result-content {
            padding: 1.5rem;
        }

        .result-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #ffffff;
        }

        .result-meta {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .result-description {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.4;
            margin-bottom: 1rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .result-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-add {
            flex: 1;
            background: linear-gradient(45deg, #22c55e, #16a34a);
            border: none;
            padding: 0.75rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #ffffff;
        }

        .btn-add:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.4);
        }

        .btn-add:disabled {
            background: rgba(255, 255, 255, 0.1);
            cursor: not-allowed;
            transform: none;
        }

        .btn-view {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-view:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 4rem;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #ef4444;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 3rem;
        }

        .page-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #ffffff;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.2);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-info {
            color: rgba(255, 255, 255, 0.8);
        }

        .source-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: linear-gradient(45deg, #3b82f6, #2563eb);
            color: #ffffff;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .source-badge.tmdb {
            background: linear-gradient(45deg, #01d277, #00a858);
        }

        .source-badge.omdb {
            background: linear-gradient(45deg, #f5c518, #f59e0b);
        }

        .source-badge.anime {
            background: linear-gradient(45deg, #e11d48, #be123c);
        }

        @media (max-width: 768px) {
            .admin-container {
                padding-top: 70px;
            }

            .page-header {
                padding: 1.5rem;
                margin-bottom: 2rem;
            }

            .search-section {
                padding: 1.5rem;
            }

            .search-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .search-form {
                flex-direction: column;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }

            .result-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <div class="logo">CineScope</div>
                    <span class="admin-badge">ADMIN</span>
                </div>
                
                <div class="hidden md:flex space-x-6">
                    <a href="dashboard.html" class="text-white hover:text-red-400 transition-colors">Dashboard</a>
                    <a href="content-browser.html" class="text-red-400">Content Browser</a>
                    <a href="posts.html" class="text-white hover:text-red-400 transition-colors">Posts</a>
                    <a href="analytics.html" class="text-white hover:text-red-400 transition-colors">Analytics</a>
                </div>

                <div class="flex items-center space-x-4">
                    <span class="text-red-400 font-semibold" id="adminName">Admin</span>
                    <button onclick="logout()" class="text-white hover:text-red-400 transition-colors">
                        <i class="fas fa-sign-out-alt text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="admin-container">
        <div class="container mx-auto px-4">
            <!-- Page Header -->
            <div class="page-header">
                <h1 class="text-3xl font-bold text-white mb-2">
                    <i class="fas fa-search mr-3"></i>
                    Content Browser
                </h1>
                <p class="text-gray-300">Search and add movies, TV shows, and anime from external sources</p>
            </div>

            <!-- Search Section -->
            <div class="search-section">
                <!-- Search Tabs -->
                <div class="search-tabs">
                    <button class="search-tab active" data-source="tmdb">
                        <i class="fas fa-film mr-2"></i>
                        TMDB
                    </button>
                    <button class="search-tab" data-source="omdb">
                        <i class="fas fa-database mr-2"></i>
                        OMDb
                    </button>
                    <button class="search-tab" data-source="anime">
                        <i class="fas fa-dragon mr-2"></i>
                        Anime (Jikan)
                    </button>
                </div>

                <!-- Search Form -->
                <form id="searchForm" class="search-form">
                    <input type="text" id="searchQuery" class="search-input" placeholder="Search for movies, TV shows, or anime..." required>
                    <button type="submit" class="btn-search">
                        <i class="fas fa-search mr-2"></i>
                        Search
                    </button>
                </form>

                <!-- Search Filters -->
                <div class="search-filters">
                    <select id="contentType" class="filter-select">
                        <option value="multi">All Types</option>
                        <option value="movie">Movies</option>
                        <option value="tv">TV Shows</option>
                    </select>
                    <select id="yearFilter" class="filter-select">
                        <option value="">All Years</option>
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                        <option value="2021">2021</option>
                        <option value="2020">2020</option>
                    </select>
                    <select id="languageFilter" class="filter-select">
                        <option value="">All Languages</option>
                        <option value="en">English</option>
                        <option value="hi">Hindi</option>
                        <option value="te">Telugu</option>
                        <option value="ta">Tamil</option>
                        <option value="ja">Japanese</option>
                        <option value="ko">Korean</option>
                    </select>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results-section">
                <div class="results-header">
                    <h2 class="text-2xl font-bold text-white">Search Results</h2>
                    <span class="results-count" id="resultsCount">0 results found</span>
                </div>

                <!-- Results Grid -->
                <div id="resultsGrid" class="results-grid">
                    <!-- Results will be loaded here -->
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="loading-spinner" style="display: none;">
                    <div class="spinner"></div>
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="text-center py-16" style="display: none;">
                    <i class="fas fa-search text-6xl text-gray-600 mb-4"></i>
                    <h3 class="text-2xl font-semibold text-gray-400 mb-2">No results found</h3>
                    <p class="text-gray-500">Try searching with different keywords or filters</p>
                </div>

                <!-- Pagination -->
                <div id="pagination" class="pagination" style="display: none;">
                    <button id="prevBtn" class="page-btn" onclick="changePage(-1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <span class="page-info">
                        Page <span id="currentPage">1</span> of <span id="totalPages">1</span>
                    </span>
                    <button id="nextBtn" class="page-btn" onclick="changePage(1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'https://backend-app-970m.onrender.com/api';
        let authToken = window.authToken;
        let currentUser = window.currentUser;
        let currentSource = 'tmdb';
        let currentPage = 1;
        let totalPages = 1;
        let searchResults = [];
        let addedContent = new Set();

        document.addEventListener('DOMContentLoaded', function() {
            checkAdminAuth();
            initializeContentBrowser();
        });

        function checkAdminAuth() {
            if (!authToken || !currentUser || !currentUser.is_admin) {
                window.location.href = '../login.html';
                return;
            }

            document.getElementById('adminName').textContent = currentUser.username;
        }

        function initializeContentBrowser() {
            setupEventListeners();
            loadAddedContent();
        }

        function setupEventListeners() {
            // Search tabs
            document.querySelectorAll('.search-tab').forEach(tab => {
                tab.addEventListener('click', handleTabClick);
            });

            // Search form
            document.getElementById('searchForm').addEventListener('submit', handleSearch);

            // Filters
            document.getElementById('contentType').addEventListener('change', () => {
                if (searchResults.length > 0) {
                    filterResults();
                }
            });
        }

        function handleTabClick(e) {
            const tab = e.currentTarget;
            const source = tab.dataset.source;

            // Update active state
            document.querySelectorAll('.search-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');

            // Update current source
            currentSource = source;

            // Update form based on source
            updateSearchForm(source);

            // Clear results
            clearResults();
        }

        function updateSearchForm(source) {
            const contentTypeSelect = document.getElementById('contentType');
            
            if (source === 'anime') {
                contentTypeSelect.innerHTML = `
                    <option value="tv">TV Series</option>
                    <option value="movie">Movies</option>
                    <option value="ova">OVA</option>
                    <option value="special">Special</option>
                `;
            } else if (source === 'omdb') {
                contentTypeSelect.innerHTML = `
                    <option value="movie">Movies</option>
                    <option value="series">TV Series</option>
                    <option value="episode">Episodes</option>
                `;
            } else {
                contentTypeSelect.innerHTML = `
                    <option value="multi">All Types</option>
                    <option value="movie">Movies</option>
                    <option value="tv">TV Shows</option>
                `;
            }
        }

        async function handleSearch(e) {
            e.preventDefault();
            
            const query = document.getElementById('searchQuery').value.trim();
            if (!query) return;

            currentPage = 1;
            await performSearch(query);
        }

        async function performSearch(query) {
            showLoading(true);
            clearResults();

            try {
                const response = await fetch(`${API_BASE}/admin/search?query=${encodeURIComponent(query)}&source=${currentSource}&page=${currentPage}`, {
                    headers: {
                        'Authorization': `Bearer ${authToken}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    searchResults = data.results || [];
                    totalPages = data.total_pages || 1;
                    
                    displayResults(searchResults);
                    updateResultsCount(searchResults.length);
                    updatePagination();
                } else {
                    showError('Search failed. Please try again.');
                }
            } catch (error) {
                console.error('Search error:', error);
                showError('Network error. Please check your connection.');
            } finally {
                showLoading(false);
            }
        }

        function displayResults(results) {
            const grid = document.getElementById('resultsGrid');
            
            if (!results.length) {
                showEmptyState();
                return;
            }

            const resultsHTML = results.map(item => createResultCard(item)).join('');
            grid.innerHTML = resultsHTML;
            
            document.getElementById('emptyState').style.display = 'none';
            grid.style.display = 'grid';
        }

        function createResultCard(item) {
            const isAdded = addedContent.has(item.id) || addedContent.has(item.imdb_id);
            const sourceBadgeClass = currentSource === 'tmdb' ? 'tmdb' : currentSource === 'omdb' ? 'omdb' : 'anime';
            
            return `
                <div class="result-card ${isAdded ? 'added' : ''}" id="card-${item.id}">
                    <div class="source-badge ${sourceBadgeClass}">${currentSource.toUpperCase()}</div>
                    <img src="${item.poster_path || getPlaceholderImage(300, 200)}" 
                         alt="${item.title}" 
                         class="result-image"
                         onerror="this.src='${getPlaceholderImage(300, 200)}'">
                    <div class="result-content">
                        <h3 class="result-title">${item.title}</h3>
                        <div class="result-meta">
                            <span class="px-2 py-1 bg-blue-600 rounded text-xs">${item.content_type?.toUpperCase() || 'MOVIE'}</span>
                            ${item.release_date ? `<span>${new Date(item.release_date).getFullYear()}</span>` : ''}
                            ${item.rating ? `<span>⭐ ${item.rating}</span>` : ''}
                        </div>
                        <p class="result-description">${item.overview || 'No description available'}</p>
                        <div class="result-actions">
                            ${!isAdded ? `
                                <button class="btn-add" onclick="addContent('${item.id}', '${currentSource}')">
                                    <i class="fas fa-plus mr-2"></i>
                                    Add to Platform
                                </button>
                            ` : `
                                <button class="btn-add" disabled>
                                    <i class="fas fa-check mr-2"></i>
                                    Already Added
                                </button>
                            `}
                            <button class="btn-view" onclick="viewExternalDetails('${item.id}', '${currentSource}')">
                                <i class="fas fa-external-link-alt"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        async function addContent(contentId, source) {
            const card = document.getElementById(`card-${contentId}`);
            const addBtn = card.querySelector('.btn-add');
            
            // Disable button and show loading
            addBtn.disabled = true;
            addBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Adding...';

            try {
                // Find the content in search results
                const content = searchResults.find(item => item.id == contentId);
                if (!content) {
                    throw new Error('Content not found');
                }

                // Prepare content data
                const contentData = {
                    id: content.id,
                    title: content.title,
                    content_type: content.content_type || 'movie',
                    overview: content.overview,
                    release_date: content.release_date,
                    poster_path: content.poster_path,
                    rating: content.rating,
                    source: source,
                    genres: content.genres || [],
                    languages: content.languages || ['en']
                };

                const response = await fetch(`${API_BASE}/admin/content`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify(contentData)
                });

                const data = await response.json();

                if (response.ok) {
                    // Mark as added
                    addedContent.add(contentId);
                    card.classList.add('added');
                    
                    // Update button
                    addBtn.innerHTML = '<i class="fas fa-check mr-2"></i>Already Added';
                    
                    showToast('Content added successfully!', 'success');
                    
                    // Check if we should create a recommendation
                    if (confirm('Would you like to create a recommendation for this content?')) {
                        createRecommendation(data.content_id || contentId, content.title);
                    }
                } else {
                    throw new Error(data.error || 'Failed to add content');
                }
            } catch (error) {
                console.error('Error adding content:', error);
                showToast(error.message || 'Failed to add content', 'error');
                
                // Reset button
                addBtn.disabled = false;
                addBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>Add to Platform';
            }
        }

        async function createRecommendation(contentId, title) {
            const description = prompt(`Enter your recommendation for "${title}":`);
            
            if (!description) return;

            try {
                const response = await fetch(`${API_BASE}/admin/recommendations`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({
                        content_id: contentId,
                        recommendation_type: 'admin_choice',
                        description: description
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    showToast('Recommendation created and sent to Telegram!', 'success');
                } else {
                    throw new Error('Failed to create recommendation');
                }
            } catch (error) {
                console.error('Error creating recommendation:', error);
                showToast('Failed to create recommendation', 'error');
            }
        }

        function viewExternalDetails(contentId, source) {
            let url = '';
            
            switch (source) {
                case 'tmdb':
                    const item = searchResults.find(r => r.id == contentId);
                    const type = item?.content_type === 'tv' ? 'tv' : 'movie';
                    url = `https://www.themoviedb.org/${type}/${contentId}`;
                    break;
                case 'omdb':
                    url = `https://www.imdb.com/title/${contentId}`;
                    break;
                case 'anime':
                    url = `https://myanimelist.net/anime/${contentId}`;
                    break;
            }
            
            if (url) {
                window.open(url, '_blank');
            }
        }

        function filterResults() {
            const contentType = document.getElementById('contentType').value;
            const year = document.getElementById('yearFilter').value;
            const language = document.getElementById('languageFilter').value;

            let filteredResults = [...searchResults];

            if (contentType && contentType !== 'multi') {
                filteredResults = filteredResults.filter(item => 
                    item.content_type === contentType
                );
            }

            if (year) {
                filteredResults = filteredResults.filter(item => {
                    const releaseYear = item.release_date ? new Date(item.release_date).getFullYear() : '';
                    return releaseYear == year;
                });
            }

            displayResults(filteredResults);
            updateResultsCount(filteredResults.length);
        }

        function changePage(direction) {
            const newPage = currentPage + direction;
            
            if (newPage < 1 || newPage > totalPages) return;
            
            currentPage = newPage;
            const query = document.getElementById('searchQuery').value;
            performSearch(query);
        }

        function updatePagination() {
            const pagination = document.getElementById('pagination');
            const currentPageSpan = document.getElementById('currentPage');
            const totalPagesSpan = document.getElementById('totalPages');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            if (totalPages > 1) {
                pagination.style.display = 'flex';
                currentPageSpan.textContent = currentPage;
                totalPagesSpan.textContent = totalPages;
                
                prevBtn.disabled = currentPage === 1;
                nextBtn.disabled = currentPage === totalPages;
            } else {
                pagination.style.display = 'none';
            }
        }

        function updateResultsCount(count) {
            document.getElementById('resultsCount').textContent = `${count} results found`;
        }

        function showLoading(show) {
            document.getElementById('loadingState').style.display = show ? 'flex' : 'none';
            document.getElementById('resultsGrid').style.display = show ? 'none' : 'grid';
        }

        function showEmptyState() {
            document.getElementById('emptyState').style.display = 'block';
            document.getElementById('resultsGrid').style.display = 'none';
        }

        function showError(message) {
            document.getElementById('resultsGrid').innerHTML = `
                <div class="col-span-full text-center text-red-400 py-16">
                    <i class="fas fa-exclamation-triangle text-6xl mb-4"></i>
                    <h3 class="text-2xl font-semibold mb-2">Error</h3>
                    <p>${message}</p>
                </div>
            `;
        }

        function clearResults() {
            document.getElementById('resultsGrid').innerHTML = '';
            document.getElementById('resultsCount').textContent = '0 results found';
            document.getElementById('pagination').style.display = 'none';
            searchResults = [];
        }

        async function loadAddedContent() {
            // This would load already added content IDs to prevent duplicates
            // For now, we'll just initialize the set
            addedContent = new Set();
        }

        function getPlaceholderImage(width, height) {
            return `data:image/svg+xml;base64,${btoa(`
                <svg width="${width}" height="${height}" viewBox="0 0 ${width} ${height}" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="${width}" height="${height}" fill="#374151"/>
                    <path d="M${width/2 - 20} ${height/2 - 15}V${height/2 + 15}H${width/2 + 20}V${height/2 - 15}H${width/2 - 20}Z" fill="#6B7280"/>
                </svg>
            `)}`;
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg text-white font-medium transition-all duration-300 transform translate-x-full`;
            
            if (type === 'success') {
                toast.classList.add('bg-green-600');
            } else if (type === 'error') {
                toast.classList.add('bg-red-600');
            } else {
                toast.classList.add('bg-blue-600');
            }
            
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.remove('translate-x-full'), 100);
            setTimeout(() => {
                toast.classList.add('translate-x-full');
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 3000);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                window.authToken = null;
                window.currentUser = null;
                window.location.href = '../login.html';
            }
        }
    </script>
</body>
</html>