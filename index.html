<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineScope - Discover Amazing Movies, TV Shows & Anime</title>
    <meta name="description" content="Discover trending movies, TV shows, and anime with personalized recommendations powered by AI. Your cinematic journey starts here.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg">
    <link rel="icon" type="image/png" href="/assets/icons/favicon.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/responsive.css">
    
    <!-- PWA Meta -->
    <meta name="theme-color" content="#0066ff">
    <link rel="manifest" href="/manifest.json">
    
    <!-- Open Graph -->
    <meta property="og:title" content="CineScope - Discover Movies & TV Shows">
    <meta property="og:description" content="Discover trending movies, TV shows, and anime with personalized recommendations">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cinescope.vercel.app">
    
    <!-- Preload critical resources -->
    <link rel="preload" as="style" href="/css/main.css">
    <link rel="preload" as="script" href="/js/main.js">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="navbar-container">
            <a href="/" class="navbar-brand" onclick="event.preventDefault(); appState?.navigateTo('')">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                    <circle cx="16" cy="16" r="16" fill="url(#gradient)"/>
                    <path d="M12 8v16l8-8-8-8z" fill="white"/>
                    <defs>
                        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#0066ff"/>
                            <stop offset="100%" stop-color="#6b46c1"/>
                        </linearGradient>
                    </defs>
                </svg>
                CineScope
            </a>
            
            <ul class="navbar-menu">
                <li class="navbar-item">
                    <a href="/" class="navbar-link active" onclick="event.preventDefault(); appState?.navigateTo('')">Home</a>
                </li>
                <li class="navbar-item dropdown">
                    <a href="#" class="navbar-link">Categories ‚ñº</a>
                    <div class="dropdown-menu">
                        <a href="/categories/trending" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('categories/trending')">Trending</a>
                        <a href="/categories/popular" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('categories/popular')">Popular</a>
                        <a href="/categories/new-releases" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('categories/new-releases')">New Releases</a>
                        <a href="/categories/critic-choices" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('categories/critic-choices')">Critics' Choice</a>
                        <a href="/categories/movies" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('categories/movies')">Movies</a>
                        <a href="/categories/tv-shows" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('categories/tv-shows')">TV Shows</a>
                        <a href="/categories/anime" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('categories/anime')">Anime</a>
                    </div>
                </li>
                <li class="navbar-item dropdown">
                    <a href="#" class="navbar-link">Languages ‚ñº</a>
                    <div class="dropdown-menu">
                        <a href="/languages/english" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('languages/english')">English</a>
                        <a href="/languages/hindi" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('languages/hindi')">Hindi</a>
                        <a href="/languages/telugu" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('languages/telugu')">Telugu</a>
                        <a href="/languages/tamil" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('languages/tamil')">Tamil</a>
                        <a href="/languages/kannada" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('languages/kannada')">Kannada</a>
                        <a href="/languages/malayalam" class="dropdown-item" onclick="event.preventDefault(); appState?.navigateTo('languages/malayalam')">Malayalam</a>
                    </div>
                </li>
            </ul>
            
            <div class="navbar-search">
                <input 
                    type="text" 
                    class="navbar-search-input" 
                    placeholder="Search movies, TV shows, anime..."
                    autocomplete="off"
                >
                <svg class="navbar-search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                </svg>
            </div>
            
            <div class="navbar-actions">
                <!-- Auth buttons will be inserted here by JavaScript -->
            </div>
            
            <button class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <ul class="mobile-menu-list">
            <li class="mobile-menu-item">
                <a href="/" class="mobile-menu-link" onclick="event.preventDefault(); appState?.navigateTo(''); toggleMobileMenu()">Home</a>
            </li>
            <li class="mobile-menu-item">
                <a href="/categories/trending" class="mobile-menu-link" onclick="event.preventDefault(); appState?.navigateTo('categories/trending'); toggleMobileMenu()">Trending</a>
            </li>
            <li class="mobile-menu-item">
                <a href="/categories/movies" class="mobile-menu-link" onclick="event.preventDefault(); appState?.navigateTo('categories/movies'); toggleMobileMenu()">Movies</a>
            </li>
            <li class="mobile-menu-item">
                <a href="/categories/tv-shows" class="mobile-menu-link" onclick="event.preventDefault(); appState?.navigateTo('categories/tv-shows'); toggleMobileMenu()">TV Shows</a>
            </li>
            <li class="mobile-menu-item">
                <a href="/categories/anime" class="mobile-menu-link" onclick="event.preventDefault(); appState?.navigateTo('categories/anime'); toggleMobileMenu()">Anime</a>
            </li>
        </ul>
        
        <div class="mobile-menu-search">
            <input 
                type="text" 
                class="form-input" 
                placeholder="Search..."
                id="mobileSearchInput"
            >
        </div>
    </div>
    
    <!-- Main Content -->
    <main id="mainContent">
        <!-- Hero Section -->
        <section class="hero" id="heroSection">
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <h1 class="hero-title fade-in">Discover Your Next Favorite</h1>
                <p class="hero-description fade-in">Explore trending movies, binge-worthy TV shows, and amazing anime with personalized recommendations powered by AI.</p>
                <div class="hero-actions fade-in">
                    <button class="btn btn-primary btn-lg" onclick="scrollToTrending()">
                        ‚ú® Explore Trending
                    </button>
                    <button class="btn btn-outline btn-lg" onclick="showDiscoverModal()">
                        üéØ Get Recommendations
                    </button>
                </div>
            </div>
            <div class="hero-background" id="heroBackground"></div>
        </section>
        
        <!-- Content Sections -->
        <div class="container">
            <!-- Quick Actions -->
            <section class="quick-actions fade-in" style="margin: 2rem 0;">
                <div class="flex gap-4 justify-center flex-wrap">
                    <button class="btn btn-secondary" onclick="appState?.navigateTo('categories/trending')">
                        üî• Trending Now
                    </button>
                    <button class="btn btn-secondary" onclick="appState?.navigateTo('categories/new-releases')">
                        üÜï New Releases
                    </button>
                    <button class="btn btn-secondary" onclick="appState?.navigateTo('categories/critic-choices')">
                        üèÜ Critics' Choice
                    </button>
                    <button class="btn btn-secondary" onclick="appState?.navigateTo('categories/anime')">
                        üéå Anime
                    </button>
                </div>
            </section>
            
            <!-- Content Carousels -->
            <div id="contentCarousels">
                <!-- Carousels will be loaded here -->
            </div>
            
            <!-- Genre Showcase -->
            <section class="genre-showcase" style="margin: 3rem 0;">
                <h2 class="text-center" style="margin-bottom: 2rem;">Explore by Genre</h2>
                <div class="genre-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div class="genre-card card" onclick="appState?.navigateTo('categories/movies?genre=action')">
                        <h3>üé¨ Action</h3>
                        <p class="text-muted">Explosive thrills and adventures</p>
                    </div>
                    <div class="genre-card card" onclick="appState?.navigateTo('categories/movies?genre=comedy')">
                        <h3>üòÇ Comedy</h3>
                        <p class="text-muted">Laugh-out-loud entertainment</p>
                    </div>
                    <div class="genre-card card" onclick="appState?.navigateTo('categories/movies?genre=drama')">
                        <h3>üé≠ Drama</h3>
                        <p class="text-muted">Emotional storytelling</p>
                    </div>
                    <div class="genre-card card" onclick="appState?.navigateTo('categories/movies?genre=horror')">
                        <h3>üëª Horror</h3>
                        <p class="text-muted">Spine-chilling experiences</p>
                    </div>
                    <div class="genre-card card" onclick="appState?.navigateTo('categories/movies?genre=romance')">
                        <h3>üíï Romance</h3>
                        <p class="text-muted">Love stories that warm hearts</p>
                    </div>
                    <div class="genre-card card" onclick="appState?.navigateTo('categories/movies?genre=sci-fi')">
                        <h3>üöÄ Sci-Fi</h3>
                        <p class="text-muted">Future worlds and possibilities</p>
                    </div>
                </div>
            </section>
            
            <!-- Regional Content -->
            <section class="regional-showcase" style="margin: 3rem 0;">
                <h2 class="text-center" style="margin-bottom: 2rem;">Regional Cinema</h2>
                <div class="regional-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                    <div class="regional-card card" onclick="appState?.navigateTo('languages/hindi')">
                        <h3>üáÆüá≥ Bollywood</h3>
                        <p class="text-muted">Latest Hindi movies and classics</p>
                    </div>
                    <div class="regional-card card" onclick="appState?.navigateTo('languages/telugu')">
                        <h3>üé¨ Tollywood</h3>
                        <p class="text-muted">Telugu cinema at its finest</p>
                    </div>
                    <div class="regional-card card" onclick="appState?.navigateTo('languages/tamil')">
                        <h3>üé≠ Kollywood</h3>
                        <p class="text-muted">Tamil movies and entertainment</p>
                    </div>
                    <div class="regional-card card" onclick="appState?.navigateTo('languages/english')">
                        <h3>üåü Hollywood</h3>
                        <p class="text-muted">International blockbusters</p>
                    </div>
                </div>
            </section>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="footer" style="background: var(--bg-secondary); padding: 3rem 0; margin-top: 4rem; border-top: 1px solid var(--bg-hover);">
        <div class="container">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
                <div>
                    <h4 style="color: var(--text-primary); margin-bottom: 1rem;">CineScope</h4>
                    <p class="text-muted">Your ultimate destination for discovering movies, TV shows, and anime with personalized AI recommendations.</p>
                </div>
                <div>
                    <h5 style="color: var(--text-primary); margin-bottom: 1rem;">Categories</h5>
                    <ul style="list-style: none; padding: 0;">
                        <li><a href="/categories/trending" class="text-muted" style="text-decoration: none;" onclick="event.preventDefault(); appState?.navigateTo('categories/trending')">Trending</a></li>
                        <li><a href="/categories/movies" class="text-muted" style="text-decoration: none;" onclick="event.preventDefault(); appState?.navigateTo('categories/movies')">Movies</a></li>
                        <li><a href="/categories/tv-shows" class="text-muted" style="text-decoration: none;" onclick="event.preventDefault(); appState?.navigateTo('categories/tv-shows')">TV Shows</a></li>
                        <li><a href="/categories/anime" class="text-muted" style="text-decoration: none;" onclick="event.preventDefault(); appState?.navigateTo('categories/anime')">Anime</a></li>
                    </ul>
                </div>
                <div>
                    <h5 style="color: var(--text-primary); margin-bottom: 1rem;">Support</h5>
                    <ul style="list-style: none; padding: 0;">
                        <li><a href="/help" class="text-muted" style="text-decoration: none;">Help Center</a></li>
                        <li><a href="/privacy" class="text-muted" style="text-decoration: none;">Privacy Policy</a></li>
                        <li><a href="/terms" class="text-muted" style="text-decoration: none;">Terms of Service</a></li>
                        <li><a href="/contact" class="text-muted" style="text-decoration: none;">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div style="text-align: center; padding-top: 2rem; border-top: 1px solid var(--bg-hover);">
                <p class="text-muted">&copy; 2024 CineScope. All rights reserved. Powered by TMDB, Jikan, and AI.</p>
            </div>
        </div>
    </footer>
    
    <!-- Scripts -->
    <script src="/js/main.js"></script>
    <script>
        // Homepage specific functionality
        class HomePage {
            constructor() {
                this.init();
            }
            
            async init() {
                await this.loadHeroContent();
                await this.loadCarousels();
                this.setupEventListeners();
            }
            
            async loadHeroContent() {
                try {
                    // Get a trending movie for hero
                    const trending = await apiService.getTrending('movie', 1);
                    if (trending.recommendations && trending.recommendations.length > 0) {
                        const heroMovie = trending.recommendations[0];
                        this.updateHeroContent(heroMovie);
                    }
                } catch (error) {
                    console.error('Error loading hero content:', error);
                }
            }
            
            updateHeroContent(movie) {
                const heroSection = document.getElementById('heroSection');
                const heroBackground = document.getElementById('heroBackground');
                
                if (movie.backdrop_path || movie.poster_path) {
                    const imageUrl = movie.backdrop_path 
                        ? ComponentFactory.getImageUrl(movie.backdrop_path.replace('w500', 'w1280'))
                        : ComponentFactory.getImageUrl(movie.poster_path);
                    
                    heroBackground.style.backgroundImage = `url('${imageUrl}')`;
                    heroBackground.style.backgroundSize = 'cover';
                    heroBackground.style.backgroundPosition = 'center';
                }
                
                // Update hero content with movie details
                const heroContent = heroSection.querySelector('.hero-content');
                heroContent.innerHTML = `
                    <h1 class="hero-title fade-in">${movie.title}</h1>
                    <p class="hero-description fade-in">${movie.overview || 'Discover amazing content with personalized recommendations.'}</p>
                    <div class="hero-actions fade-in">
                        ${movie.youtube_trailer ? 
                            `<button class="btn btn-primary btn-lg" onclick="playTrailer('${movie.youtube_trailer}')">
                                ‚ñ∂ Watch Trailer
                            </button>` : 
                            `<button class="btn btn-primary btn-lg" onclick="scrollToTrending()">
                                ‚ú® Explore Trending
                            </button>`
                        }
                        <button class="btn btn-outline btn-lg" onclick="navigateToDetails(${movie.id})">
                            More Info
                        </button>
                    </div>
                `;
            }
            
            async loadCarousels() {
                const container = document.getElementById('contentCarousels');
                container.innerHTML = UIUtils.createLoadingSpinner();
                
                try {
                    const [trending, newReleases, criticsChoice, anime] = await Promise.all([
                        apiService.getTrending('all', 20),
                        apiService.getNewReleases(null, 'movie', 20),
                        apiService.getCriticsChoice('movie', 20),
                        apiService.getAnimeRecommendations(null, 20)
                    ]);
                    
                    let carouselsHTML = '';
                    
                    if (trending.recommendations) {
                        carouselsHTML += ComponentFactory.createCarousel('üî• Trending Now', trending.recommendations);
                    }
                    
                    if (newReleases.recommendations) {
                        carouselsHTML += ComponentFactory.createCarousel('üÜï New Releases', newReleases.recommendations);
                    }
                    
                    if (criticsChoice.recommendations) {
                        carouselsHTML += ComponentFactory.createCarousel('üèÜ Critics\' Choice', criticsChoice.recommendations);
                    }
                    
                    if (anime.recommendations) {
                        carouselsHTML += ComponentFactory.createCarousel('üéå Popular Anime', anime.recommendations);
                    }
                    
                    // Add anonymous recommendations if user is not logged in
                    if (!appState.user) {
                        try {
                            const anonymous = await apiService.getAnonymousRecommendations(20);
                            if (anonymous.recommendations) {
                                carouselsHTML += ComponentFactory.createCarousel('üéØ Recommended For You', anonymous.recommendations);
                            }
                        } catch (error) {
                            console.log('Anonymous recommendations not available');
                        }
                    } else {
                        // Add personalized recommendations for logged-in users
                        try {
                            const personalized = await apiService.getPersonalizedRecommendations(20);
                            if (personalized.recommendations) {
                                carouselsHTML = ComponentFactory.createCarousel('üéØ Recommended For You', personalized.recommendations) + carouselsHTML;
                            }
                        } catch (error) {
                            console.log('Personalized recommendations not available');
                        }
                    }
                    
                    container.innerHTML = carouselsHTML;
                    
                    // Reinitialize carousels
                    carouselManager.initializeCarousels();
                    
                    // Initialize lazy loading for new images
                    UIUtils.lazyLoadImages();
                    
                } catch (error) {
                    console.error('Error loading carousels:', error);
                    container.innerHTML = `
                        <div class="text-center" style="padding: 2rem;">
                            <p class="text-muted">Unable to load content. Please try again later.</p>
                            <button class="btn btn-primary" onclick="location.reload()">Retry</button>
                        </div>
                    `;
                }
            }
            
            setupEventListeners() {
                // Mobile menu toggle
                const hamburger = document.getElementById('hamburger');
                const mobileMenu = document.getElementById('mobileMenu');
                
                if (hamburger && mobileMenu) {
                    hamburger.addEventListener('click', () => {
                        hamburger.classList.toggle('active');
                        mobileMenu.classList.toggle('active');
                    });
                }
                
                // Mobile search
                const mobileSearchInput = document.getElementById('mobileSearchInput');
                if (mobileSearchInput) {
                    mobileSearchInput.addEventListener('input', UIUtils.debounce((e) => {
                        // Handle mobile search
                        console.log('Mobile search:', e.target.value);
                    }, 300));
                }
            }
        }
        
        // Global functions for homepage
        function scrollToTrending() {
            const trendingSection = document.querySelector('.carousel');
            if (trendingSection) {
                trendingSection.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        function showDiscoverModal() {
            if (!appState.user) {
                showLoginModal();
                return;
            }
            
            const discoverHTML = `
                <div class="text-center">
                    <h3 style="margin-bottom: 1rem;">üéØ Get Personalized Recommendations</h3>
                    <p class="text-muted" style="margin-bottom: 2rem;">Based on your viewing history and preferences</p>
                    <div class="flex gap-3 justify-center flex-wrap">
                        <button class="btn btn-primary" onclick="appState?.navigateTo('dashboard'); document.querySelector('.modal').remove()">
                            View Dashboard
                        </button>
                        <button class="btn btn-outline" onclick="appState?.navigateTo('categories/trending'); document.querySelector('.modal').remove()">
                            Explore Trending
                        </button>
                    </div>
                </div>
            `;
            
            UIUtils.showModal(discoverHTML, { title: 'Discover Content' });
        }
        
        function toggleMobileMenu() {
            const hamburger = document.getElementById('hamburger');
            const mobileMenu = document.getElementById('mobileMenu');
            
            if (hamburger && mobileMenu) {
                hamburger.classList.remove('active');
                mobileMenu.classList.remove('active');
            }
        }
        
        // Initialize homepage when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Wait for global services to be ready
            setTimeout(() => {
                if (typeof appState !== 'undefined') {
                    window.homePage = new HomePage();
                }
            }, 100);
        });
    </script>
</body>
</html>