<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="CineScope - Your premium destination for movie and TV discovery with AI-powered recommendations">
    <meta name="keywords" content="movies, tv shows, anime, streaming, recommendations, entertainment">
    <meta name="author" content="CineScope">

    <title>CineScope - Premium Movie & TV Discovery</title>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Tailwind CSS (with prefix) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            prefix: 'tw-',
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'cs-void': '#0a0a0b',
                        'cs-charcoal': '#121218',
                        'cs-surface': '#1a1a22',
                        'cs-blue': '#2563eb',
                        'cs-purple': '#9333ea'
                    }
                }
            }
        }
    </script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/bootstrap-overrides.css">
    <link rel="stylesheet" href="/css/tailwind.css">
    <link rel="stylesheet" href="/css/animation.css">
    <link rel="stylesheet" href="/css/responsive.css">
</head>

<body class="bg-black">
    <!-- Layout Container -->
    <div id="app-container">
        <!-- Top Bar Container (Desktop) -->
        <div id="topbar-container" class="d-none d-lg-block"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Hero Section -->
            <section class="hero-section">
                <div class="container-fluid">
                    <div class="row min-vh-100 align-items-center">
                        <div class="col-lg-6">
                            <div class="hero-content animate-fade-in-up">
                                <h1 class="display-1 fw-bold text-gradient-animate mb-4">
                                    Discover Your Next
                                    <span class="text-primary">Favorite</span>
                                </h1>
                                <p class="lead text-muted mb-5">
                                    Experience the future of entertainment discovery with AI-powered recommendations
                                    tailored just for you. From blockbuster movies to hidden gems.
                                </p>

                                <!-- Search Bar -->
                                <div class="hero-search mb-4" data-search-widget>
                                    <div class="search-bar-widget">
                                        <div class="position-relative">
                                            <div class="input-group input-group-lg">
                                                <span class="input-group-text bg-dark border-secondary">
                                                    <i class="bi bi-search text-muted"></i>
                                                </span>
                                                <input type="search"
                                                    class="form-control form-control-lg bg-dark border-secondary text-white search-input"
                                                    placeholder="Search movies, TV shows, anime..." autocomplete="off">
                                                <button class="btn btn-primary search-btn" type="button">
                                                    <span class="search-btn-text">Search</span>
                                                    <div class="spinner-border spinner-border-sm d-none" role="status">
                                                        <span class="visually-hidden">Loading...</span>
                                                    </div>
                                                </button>
                                            </div>

                                            <!-- Search Results Dropdown -->
                                            <div class="search-results-dropdown position-absolute w-100 bg-dark border border-secondary rounded-bottom shadow-lg mt-1 d-none"
                                                style="z-index: 1050;">
                                                <div class="search-results-content"></div>
                                            </div>

                                            <!-- Search Suggestions -->
                                            <div class="search-suggestions-dropdown position-absolute w-100 bg-dark border border-secondary rounded-bottom shadow-lg mt-1 d-none"
                                                style="z-index: 1050;">
                                                <div class="p-3">
                                                    <h6 class="text-white mb-3">
                                                        <i class="bi bi-lightbulb me-2"></i>Search Suggestions
                                                    </h6>
                                                    <div class="search-suggestions-content"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Quick Actions -->
                                <div class="hero-actions d-flex flex-wrap gap-3">
                                    <a href="/?section=trending" class="btn btn-outline-primary">
                                        <i class="bi bi-fire me-2"></i>Trending Now
                                    </a>
                                    <a href="/?section=new-releases" class="btn btn-outline-success">
                                        <i class="bi bi-star me-2"></i>New Releases
                                    </a>
                                    <a href="/content/anime" class="btn btn-outline-info">
                                        <i class="bi bi-heart-eyes me-2"></i>Anime
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="hero-visual text-center animate-fade-in">
                                <div class="hero-cards-showcase">
                                    <!-- Featured content cards will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Content Sections -->
            <div class="container-fluid">
                <!-- Trending Section -->
                <section id="trending-section" class="section-padding">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-4 fw-bold">
                            <i class="bi bi-fire text-danger me-3"></i>Trending Now
                        </h2>
                        <p class="lead">What everyone's watching right now</p>
                    </div>
                    <div id="trending-content" class="content-grid-container">
                        <!-- Loading state -->
                        <div class="d-flex justify-content-center py-5">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- New Releases Section -->
                <section id="new-releases-section" class="section-padding">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-4 fw-bold">
                            <i class="bi bi-star text-success me-3"></i>New Releases
                        </h2>
                        <p class="lead">Fresh content just added</p>
                    </div>
                    <div id="new-releases-content" class="content-grid-container">
                        <!-- Loading state -->
                        <div class="d-flex justify-content-center py-5">
                            <div class="spinner-border text-success" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Critics' Choice Section -->
                <section id="critics-choice-section" class="section-padding">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-4 fw-bold">
                            <i class="bi bi-award text-warning me-3"></i>Critics' Choice
                        </h2>
                        <p class="lead">Critically acclaimed masterpieces</p>
                    </div>
                    <div id="critics-choice-content" class="content-grid-container">
                        <!-- Loading state -->
                        <div class="d-flex justify-content-center py-5">
                            <div class="spinner-border text-warning" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Admin's Choice Section -->
                <section id="admin-choice-section" class="section-padding">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-4 fw-bold">
                            <i class="bi bi-shield-check text-info me-3"></i>Admin's Choice
                        </h2>
                        <p class="lead">Handpicked recommendations from our experts</p>
                    </div>
                    <div id="admin-choice-content" class="content-grid-container">
                        <!-- Loading state -->
                        <div class="d-flex justify-content-center py-5">
                            <div class="spinner-border text-info" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Personalized Section (for logged-in users) -->
                <section id="personalized-section" class="section-padding d-none">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-4 fw-bold">
                            <i class="bi bi-person-heart text-purple me-3"></i>Recommended for You
                        </h2>
                        <p class="lead">AI-powered recommendations based on your preferences</p>
                    </div>
                    <div id="personalized-content" class="content-grid-container">
                        <!-- Loading state -->
                        <div class="d-flex justify-content-center py-5">
                            <div class="spinner-border text-purple" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Categories Section -->
                <section class="section-padding bg-dark">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-4 fw-bold">Explore Categories</h2>
                        <p class="lead">Find content by your favorite genres</p>
                    </div>

                    <div class="row g-4">
                        <div class="col-md-6 col-lg-3">
                            <a href="/content/genre/action"
                                class="card bg-gradient text-white h-100 text-decoration-none category-card"
                                style="background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);">
                                <div class="card-body text-center p-4">
                                    <i class="bi bi-lightning-fill display-1 mb-3"></i>
                                    <h5 class="card-title">Action</h5>
                                    <p class="card-text">High-octane thrills and excitement</p>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <a href="/content/genre/comedy"
                                class="card bg-gradient text-white h-100 text-decoration-none category-card"
                                style="background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);">
                                <div class="card-body text-center p-4">
                                    <i class="bi bi-emoji-laughing-fill display-1 mb-3"></i>
                                    <h5 class="card-title">Comedy</h5>
                                    <p class="card-text">Laughter and entertainment</p>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <a href="/content/genre/drama"
                                class="card bg-gradient text-white h-100 text-decoration-none category-card"
                                style="background: linear-gradient(135deg, #6f42c1 0%, #e83e8c 100%);">
                                <div class="card-body text-center p-4">
                                    <i class="bi bi-heart-fill display-1 mb-3"></i>
                                    <h5 class="card-title">Drama</h5>
                                    <p class="card-text">Emotional storytelling</p>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-6 col-lg-3">
                            <a href="/content/anime"
                                class="card bg-gradient text-white h-100 text-decoration-none category-card"
                                style="background: linear-gradient(135deg, #0dcaf0 0%, #6f42c1 100%);">
                                <div class="card-body text-center p-4">
                                    <i class="bi bi-heart-eyes-fill display-1 mb-3"></i>
                                    <h5 class="card-title">Anime</h5>
                                    <p class="card-text">Japanese animation</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Mobile Navigation Container -->
        <div id="mobile-nav-container" class="d-lg-none"></div>
    </div>

    <!-- Include Widget Templates -->
    <div id="widget-templates" class="d-none">
        <!-- Content Card Template -->
        <template id="content-card-template">
            <div class="col-6 col-md-4 col-lg-3 col-xl-2 mb-4">
                <div class="card content-card bg-dark border-0 h-100 position-relative" data-content-id="">
                    <div class="card-img-wrapper position-relative overflow-hidden">
                        <img src="" class="card-img-top" alt="" loading="lazy"
                            onerror="this.src='/assets/placeholder-poster.jpg'">
                        <div
                            class="card-overlay position-absolute w-100 h-100 d-flex align-items-center justify-content-center">
                            <div class="d-flex gap-2">
                                <button class="btn btn-primary btn-sm rounded-circle p-2 play-trailer-btn"
                                    title="Play Trailer">
                                    <i class="bi bi-play-fill"></i>
                                </button>
                                <button class="btn btn-outline-light btn-sm rounded-circle p-2 quick-view-btn"
                                    title="Quick View">
                                    <i class="bi bi-eye-fill"></i>
                                </button>
                            </div>
                        </div>
                        <div class="position-absolute top-0 end-0 m-2 rating-badge">
                            <span class="badge bg-primary rounded-pill">
                                <i class="bi bi-star-fill me-1"></i><span class="rating-value">0.0</span>
                            </span>
                        </div>
                        <div class="position-absolute top-0 start-0 m-2 content-type-badge">
                            <span class="badge bg-secondary">MOVIE</span>
                        </div>
                        <div class="position-absolute bottom-0 start-0 m-2 special-badges"></div>
                    </div>
                    <div class="card-body p-3">
                        <h6 class="card-title text-white mb-2 text-truncate" title=""></h6>
                        <p class="card-text text-muted small mb-2 genres-text"></p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted small release-date"></span>
                            <div class="btn-group" role="group">
                                <button class="btn btn-outline-light btn-sm watchlist-btn" title="Add to Watchlist">
                                    <i class="bi bi-bookmark"></i>
                                </button>
                                <button class="btn btn-outline-light btn-sm favorite-btn" title="Add to Favorites">
                                    <i class="bi bi-heart"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </template>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Core JavaScript -->
    <script src="/js/config.js"></script>
    <script src="/js/storage.js"></script>
    <script src="/js/http.js"></script>
    <script src="/js/ui.js"></script>
    <script src="/js/app.js"></script>

    <!-- Widget Scripts -->
    <script src="/widgets/content-card.html"></script>
    <script src="/widgets/search-bar.html"></script>

    <!-- Page Script -->
    <script>
        // Homepage functionality
        document.addEventListener('DOMContentLoaded', async function () {
            console.log('🏠 Loading CineScope Homepage...');

            // Set page title
            CineScope.UI.updatePageTitle('Home');

            // Initialize search bar
            const searchWidget = document.querySelector('[data-search-widget]');
            if (searchWidget) {
                CineScope.Widgets.SearchBar.init(searchWidget, {
                    showSuggestions: true,
                    showHistory: true
                });
            }

            // Load content sections
            await loadContentSections();

            // Show personalized section for logged-in users
            const currentUser = CineScope.Storage.user.get();
            if (currentUser) {
                await loadPersonalizedContent();
            }

            // Handle section-specific loading from URL params
            const urlParams = new URLSearchParams(window.location.search);
            const section = urlParams.get('section');
            if (section) {
                scrollToSection(section);
            }

            console.log('✅ Homepage loaded successfully');
        });

        // Load content sections
        async function loadContentSections() {
            const sections = [
                { id: 'trending', endpoint: CineScope.API.ENDPOINTS.CONTENT.TRENDING, limit: 20 },
                { id: 'new-releases', endpoint: CineScope.API.ENDPOINTS.CONTENT.NEW_RELEASES, limit: 20 },
                { id: 'critics-choice', endpoint: CineScope.API.ENDPOINTS.CONTENT.CRITICS_CHOICE, limit: 20 },
                { id: 'admin-choice', endpoint: CineScope.API.ENDPOINTS.CONTENT.ADMIN_CHOICE, limit: 12 }
            ];

            // Load sections in parallel
            const promises = sections.map(section => loadSection(section));
            await Promise.allSettled(promises);
        }

        // Load individual section
        async function loadSection(section) {
            const container = document.getElementById(`${section.id}-content`);
            if (!container) return;

            try {
                console.log(`📡 Loading ${section.id} content...`);

                const response = await CineScope.HTTP.get(section.endpoint, { limit: section.limit });
                const content = response.recommendations || response.results || [];

                if (content.length > 0) {
                    CineScope.Widgets.ContentCard.createGrid(content, container, {
                        staggerAnimation: true,
                        showTrailer: true,
                        showRating: true,
                        showGenres: true
                    });
                    console.log(`✅ Loaded ${content.length} items for ${section.id}`);
                } else {
                    container.innerHTML = `
                        <div class="text-center py-5">
                            <i class="bi bi-info-circle display-1 text-muted mb-3"></i>
                            <h5 class="text-muted">No content available</h5>
                            <p class="text-muted">Check back later for updates</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error(`❌ Failed to load ${section.id}:`, error);
                container.innerHTML = `
                    <div class="text-center py-5">
                        <i class="bi bi-exclamation-triangle display-1 text-danger mb-3"></i>
                        <h5 class="text-danger">Failed to load content</h5>
                        <p class="text-muted">${error.message}</p>
                        <button class="btn btn-primary" onclick="loadSection(${JSON.stringify(section)})">
                            <i class="bi bi-arrow-clockwise me-2"></i>Try Again
                        </button>
                    </div>
                `;
            }
        }

        // Load personalized content for logged-in users
        async function loadPersonalizedContent() {
            const section = document.getElementById('personalized-section');
            const container = document.getElementById('personalized-content');

            if (!section || !container) return;

            try {
                console.log('🤖 Loading personalized recommendations...');

                const response = await CineScope.HTTP.user.getPersonalized({ limit: 20 });
                const content = response.recommendations || [];

                if (content.length > 0) {
                    section.classList.remove('d-none');
                    CineScope.Widgets.ContentCard.createGrid(content, container, {
                        staggerAnimation: true,
                        showTrailer: true,
                        showRating: true,
                        showGenres: true
                    });
                    console.log(`✅ Loaded ${content.length} personalized recommendations`);
                }
            } catch (error) {
                console.warn('⚠️ Failed to load personalized content:', error);
                // Don't show error for personalized content, just hide the section
                section.classList.add('d-none');
            }
        }

        // Scroll to specific section
        function scrollToSection(sectionName) {
            const sectionElement = document.getElementById(`${sectionName}-section`);
            if (sectionElement) {
                sectionElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Category card hover effects
        document.addEventListener('DOMContentLoaded', function () {
            const categoryCards = document.querySelectorAll('.category-card');
            categoryCards.forEach(card => {
                card.addEventListener('mouseenter', function () {
                    this.style.transform = 'translateY(-8px) scale(1.02)';
                });

                card.addEventListener('mouseleave', function () {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });
        });

        // Intersection Observer for animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate');
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        // Observe sections for animation
        document.addEventListener('DOMContentLoaded', function () {
            const sections = document.querySelectorAll('.section-padding');
            sections.forEach(section => {
                section.classList.add('fade-up-on-scroll');
                observer.observe(section);
            });
        });
    </script>
</body>

</html>