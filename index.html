<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>CineBrain - Your Streaming Guide</title>

  <!-- Bootstrap CSS (for TopBar) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- TailwindCSS (for Mobile Nav) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'cinebrain-red': '#E50914',
            'cinebrain-blue': '#0073E6',
            'cinebrain-purple': '#8B5CF6',
            'cinebrain-dark': '#0F0F0F',
            'cinebrain-darker': '#000000',
          }
        }
      }
    }
  </script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Inter:wght@300;400;500;600;700&display=swap"
    rel="stylesheet">

  <!-- Component CSS Files -->
  <link rel="stylesheet" href="/css/topbar.css">
  <link rel="stylesheet" href="/css/mobile-nav.css">

  <!-- Feather Icons -->
  <script src="https://unpkg.com/feather-icons"></script>

  <!-- Page Specific Styles -->
  <style>
    /* Body padding adjustments for both navigations */
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bs-body-bg, #000);
      color: var(--bs-body-color, #fff);
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }

    /* Desktop view - only top padding for topbar */
    @media (min-width: 768px) {
      body {
        padding-top: var(--navbar-height, 60px);
        padding-bottom: 0;
      }
    }

    /* Mobile view - padding for both top and bottom nav */
    @media (max-width: 767px) {
      body {
        padding-top: var(--navbar-height, 56px);
        padding-bottom: calc(var(--nav-height, 60px) + var(--safe-area-inset-bottom, 0px));
      }
    }

    /* Main content area */
    .main-content {
      min-height: calc(100vh - var(--navbar-height, 60px));
      padding: 20px;
    }

    @media (max-width: 767px) {
      .main-content {
        min-height: calc(100vh - var(--navbar-height, 56px) - var(--nav-height, 60px));
      }
    }

    /* Placeholder content styling */
    .placeholder-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 400px;
      text-align: center;
      padding: 40px 20px;
    }

    .placeholder-content h1 {
      font-size: clamp(2rem, 5vw, 3rem);
      margin-bottom: 1rem;
      background: linear-gradient(135deg, #E50914, #8B5CF6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .placeholder-content p {
      font-size: clamp(1rem, 2vw, 1.25rem);
      color: #888;
      max-width: 600px;
    }
  </style>
</head>

<body>
  <!-- Desktop TopBar Navigation -->
  <nav class="navbar navbar-expand-lg navbar-cinebrain fixed-top">
    <div class="container-fluid">
      <!-- Brand Section -->
      <div class="navbar-brand-wrapper">
        <a href="/" style="text-decoration: none;">
          <div class="navbar-brand-cinebrain">CineBrain</div>
          <div class="tagline">
            <span class="tagline-full">The Mind Behind Your Next Favorite</span>
            <span class="tagline-medium" style="display: none;">Your Next Favorite</span>
            <span class="tagline-short" style="display: none;">Next Favorite</span>
          </div>
        </a>
      </div>

      <!-- Desktop Search (Hidden on Mobile) -->
      <div class="search-container desktop-search">
        <div class="input-group">
          <span class="input-group-text bg-transparent border-0 ps-2 pe-1">
            <i data-feather="search" class="text-secondary" style="width: 18px; height: 18px;"></i>
          </span>
          <input type="text" class="form-control search-input border-0 ps-1" id="desktopSearchInput"
            placeholder="Search movies, shows, anime..." autocomplete="off">
        </div>
        <div class="search-results" id="desktopSearchResults"></div>
      </div>

      <!-- Right Section: Icons -->
      <div class="nav-icons-section">
        <!-- Mobile Search Trigger -->
        <button class="icon-button mobile-search-trigger" id="mobileSearchTrigger" aria-label="Search">
          <i data-feather="search"></i>
        </button>

        <!-- Theme Toggle -->
        <button class="icon-button theme-toggle" id="themeToggle" aria-label="Toggle theme">
          <i data-feather="sun" class="theme-icon"></i>
        </button>

        <!-- Avatar/User Menu -->
        <div class="dropdown">
          <div class="avatar-menu" data-bs-toggle="dropdown" aria-expanded="false" id="avatarMenu" role="button">
            <i data-feather="user"></i>
          </div>
          <ul class="dropdown-menu dropdown-menu-end dropdown-menu-cinebrain" id="userDropdown">
            <!-- Dynamic content inserted by JavaScript -->
          </ul>
        </div>
      </div>
    </div>
  </nav>

  <!-- Mobile Search Overlay (For TopBar Mobile Search) -->
  <div class="mobile-search-overlay" id="mobileSearchOverlay">
    <div class="container">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="mb-0">Search</h4>
        <button class="btn btn-link p-0" id="closeMobileSearch" aria-label="Close search">
          <i data-feather="x" style="width: 28px; height: 28px;"></i>
        </button>
      </div>
      <div class="search-container" style="display: block; margin: 0; max-width: 100%;">
        <input type="text" class="form-control form-control-lg search-input" id="mobileSearchInput"
          placeholder="Search movies, shows, anime..." autocomplete="off">
        <div class="search-results mt-3" id="mobileSearchResults"></div>
      </div>
    </div>
  </div>

  <!-- Mobile Bottom Navigation Bar -->
  <nav class="mobile-nav fixed bottom-0 inset-x-0 z-50 block md:hidden" role="navigation" aria-label="Main navigation">
    <div class="flex h-full">
      <!-- Home Tab -->
      <button class="nav-tab flex-1 text-gray-400 active text-white" data-route="/index.html" data-tab="home" role="tab"
        aria-selected="true" aria-label="Home">
        <div class="nav-icon relative">
          <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
        </div>
        <span class="nav-label">Home</span>
      </button>

      <!-- Discover Tab -->
      <button class="nav-tab flex-1 text-gray-400" data-route="/content/trending.html" data-tab="discover" role="tab"
        aria-selected="false" aria-label="Discover trending content">
        <div class="nav-icon relative">
          <svg fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M19.48 12.35c-1.57-4.08-7.16-4.3-5.81-10.23.1-.44-.37-.78-.75-.55C9.29 3.71 6.68 8 8.87 13.62c.18.46-.36.89-.75.59-1.81-1.37-2-3.34-1.84-4.75.06-.52-.62-.77-.91-.34C4.69 10.16 4 11.84 4 14.37c.38 5.6 5.11 7.32 6.81 7.54 2.43.31 5.06-.14 6.95-1.87 2.08-1.93 2.84-5.01 1.72-7.69zm-9.28 5.03c1.44.35 2.89-.04 3.87-.82-.72-.42-1.52-.66-2.34-.66-.47 0-.93.06-1.38.18-.27.07-.56-.08-.63-.35-.06-.27.08-.56.35-.63.48-.13.98-.19 1.48-.19 1.02 0 2.01.32 2.85.89.28.2.61.38.97.52.36-.42.66-.9.87-1.43-.69-.49-1.51-.8-2.39-.87-.28-.02-.49-.26-.47-.54.02-.28.26-.49.54-.47 1.03.09 1.99.47 2.79 1.05.17-.4.28-.82.32-1.26.02-.26-.08-.51-.26-.7-.47-.49-1.32-.69-2.34-.49.02-.29.04-.58.04-.88 0-2.19-1.79-3.98-3.98-3.98s-3.98 1.79-3.98 3.98c0 .3.03.59.07.87-.45-.14-.92-.21-1.39-.14.09 1.23.67 2.46 1.7 3.36.44.39.99.64 1.59.78z" />
          </svg>
        </div>
        <span class="nav-label">Discover</span>
      </button>

      <!-- Search Tab -->
      <button class="nav-tab flex-1 text-gray-400" data-route="/content/search.html" data-tab="search" role="tab"
        aria-selected="false" aria-label="Search content">
        <div class="nav-icon relative">
          <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </div>
        <span class="nav-label">Search</span>
      </button>

      <!-- Watchlist Tab -->
      <button class="nav-tab flex-1 text-gray-400" data-route="/user/watchlist.html" data-tab="watchlist" role="tab"
        aria-selected="false" aria-label="My watchlist">
        <div class="nav-icon relative">
          <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
          </svg>
          <span class="nav-badge" id="watchlistBadge" style="display: none;">0</span>
        </div>
        <span class="nav-label">My List</span>
      </button>

      <!-- Profile Tab -->
      <button class="nav-tab flex-1 text-gray-400" data-tab="profile" role="tab" aria-selected="false"
        aria-label="Profile menu">
        <div class="nav-icon relative" id="profileIcon">
          <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
        </div>
        <span class="nav-label">Profile</span>
      </button>
    </div>
  </nav>

  <!-- Mobile Search Overlay -->
  <div class="search-overlay" id="searchOverlay">
    <div class="search-container p-4">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-semibold">Search</h2>
        <button class="p-2" id="closeSearch" aria-label="Close search">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <input type="text" class="search-input w-full" id="searchInput" placeholder="Search movies, shows, anime..."
        autocomplete="off">

      <div class="mt-4 flex-1 overflow-y-auto" id="searchResults">
        <!-- Search results will be inserted here -->
      </div>
    </div>
  </div>

  <!-- Mobile Profile Menu Overlay -->
  <div class="profile-menu-overlay" id="profileMenuOverlay"></div>

  <!-- Mobile Profile Menu -->
  <div class="profile-menu" id="profileMenu">
    <div class="menu-handle"></div>
    <div id="profileMenuContent">
      <!-- Menu content will be inserted here -->
    </div>
  </div>

  <!-- Main Content Area -->
  <main class="main-content">
    <div class="placeholder-content">
      <h1>Welcome to CineBrain</h1>
      <p>Your intelligent streaming companion. Add your content here.</p>
    </div>
  </main>

  <!-- Bootstrap JS (for TopBar dropdown) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Component JavaScript Files -->
  <script src="/js/topbar.js"></script>
  <script src="/js/movie-nav.js"></script>

  <!-- Initialization Script -->
  <script>
    // Wait for both components to load
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize Feather icons
      if (typeof feather !== 'undefined') {
        feather.replace();
      }

      // Sync theme between components
      setTimeout(() => {
        const syncTheme = () => {
          const currentTheme = localStorage.getItem('cinebrain-theme') || 'dark';
          document.documentElement.setAttribute('data-theme', currentTheme);
        };

        // Initial sync
        syncTheme();

        // Override theme toggle functions to sync both components
        if (window.topbar && window.mobileNav) {
          const originalTopbarToggle = window.topbar.toggleTheme.bind(window.topbar);
          window.topbar.toggleTheme = () => {
            originalTopbarToggle();
            syncTheme();
          };

          const originalMobileToggle = window.mobileNav.toggleTheme.bind(window.mobileNav);
          window.mobileNav.toggleTheme = () => {
            originalMobileToggle();
            syncTheme();
            if (window.topbar && window.topbar.setTheme) {
              const theme = localStorage.getItem('cinebrain-theme') || 'dark';
              window.topbar.setTheme(theme);
            }
          };
        }
      }, 100);
    });
  </script>
</body>

</html>