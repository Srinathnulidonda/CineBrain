<!DOCTYPE html>
<html lang="en">
<head>
    <title>CineScope - Your Personal Cinema Guide</title>
    <div data-include="head"></div>
</head>
<body>
    <!-- Global Loader -->
    <div class="global-loader">
        <div class="cinematic-loader">
            <div class="film-strip"></div>
            <div class="loading-text">Loading Cinema...</div>
        </div>
    </div>

    <div data-include="header"></div>

    <main>
        <!-- Hero Section -->
        <section class="hero" id="hero-section">
            <div class="hero-background"></div>
            <div class="hero-overlay"></div>
            <div class="hero-content">
                <div class="hero-info">
                    <h1 class="hero-title">Discover Your Next Favorite</h1>
                    <p class="hero-description">
                        Experience the rarest gem in entertainment discovery. Our AI-powered recommendations bring you 
                        movies, TV shows, and anime that perfectly match your taste, creating a serene journey through cinema.
                    </p>
                    <div class="hero-actions">
                        <button class="btn btn-primary" onclick="exploreContent()">
                            üé¨ Start Exploring
                        </button>
                        <button class="btn btn-secondary" onclick="window.location.href='/login'">
                            üë§ Create Account
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features">
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">üéØ</div>
                    <h3 class="feature-title">AI-Powered Recommendations</h3>
                    <p class="feature-description">
                        Our advanced machine learning algorithms analyze your preferences to suggest content you'll love.
                    </p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üåç</div>
                    <h3 class="feature-title">Global Content Library</h3>
                    <p class="feature-description">
                        Explore movies, TV shows, and anime from around the world in multiple languages.
                    </p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üì±</div>
                    <h3 class="feature-title">Mobile First Experience</h3>
                    <p class="feature-description">
                        Enjoy a seamless experience across all devices with our responsive design.
                    </p>
                </div>
            </div>
        </section>

        <!-- Content Sections -->
        <div id="content-sections">
            <!-- Trending content will be loaded here -->
        </div>
    </main>

    <div data-include="footer"></div>

    <!-- Scripts -->
    <script src="/js/include.js"></script>
    <script src="/js/main.js"></script>
    
    <script>
        // Homepage specific functionality
        class Homepage {
            static async init() {
                try {
                    UIComponents.showLoader();
                    await this.loadHeroContent();
                    await this.loadHomepageRecommendations();
                } catch (error) {
                    console.error('Homepage initialization failed:', error);
                    UIComponents.showToast('Failed to load content', 'error');
                } finally {
                    UIComponents.hideLoader();
                }
            }

            static async loadHeroContent() {
                try {
                    // Get trending content for hero background
                    const trending = await ApiService.getTrending('movie', 1);
                    if (trending.recommendations && trending.recommendations.length > 0) {
                        const heroContent = trending.recommendations[0];
                        const heroSection = document.getElementById('hero-section');
                        const heroBackground = heroSection.querySelector('.hero-background');
                        
                        if (heroContent.backdrop_path) {
                            heroBackground.style.backgroundImage = `url(${heroContent.backdrop_path})`;
                        }
                    }
                } catch (error) {
                    console.error('Failed to load hero content:', error);
                }
            }

            static async loadHomepageRecommendations() {
                const contentSections = document.getElementById('content-sections');
                let sectionsHTML = '';

                try {
                    // Load different recommendation categories
                    const [trending, popular, newReleases, criticsChoice, anime] = await Promise.all([
                        ApiService.getTrending('all', 20),
                        ApiService.getAnonymousRecommendations(),
                        ApiService.getNewReleases(null, 'movie', 15),
                        ApiService.getCriticsChoice('movie', 15),
                        ApiService.getAnimeRecommendations(null, 15)
                    ]);

                    // Create sections for each category
                    if (trending.recommendations && trending.recommendations.length > 0) {
                        sectionsHTML += UIComponents.createCarousel(
                            'üî• Trending Now',
                            trending.recommendations,
                            'trending-section'
                        );
                    }

                    if (popular.recommendations && popular.recommendations.length > 0) {
                        sectionsHTML += UIComponents.createCarousel(
                            '‚≠ê Popular Picks',
                            popular.recommendations,
                            'popular-section'
                        );
                    }

                    if (newReleases.recommendations && newReleases.recommendations.length > 0) {
                        sectionsHTML += UIComponents.createCarousel(
                            'üÜï New Releases',
                            newReleases.recommendations,
                            'new-releases-section'
                        );
                    }

                    if (criticsChoice.recommendations && criticsChoice.recommendations.length > 0) {
                        sectionsHTML += UIComponents.createCarousel(
                            'üèÜ Critics\' Choice',
                            criticsChoice.recommendations,
                            'critics-choice-section'
                        );
                    }

                    if (anime.recommendations && anime.recommendations.length > 0) {
                        sectionsHTML += UIComponents.createCarousel(
                            'üéå Anime Collection',
                            anime.recommendations,
                            'anime-section'
                        );
                    }

                    // Add regional content
                    const regionalSections = ['hindi', 'telugu', 'tamil'];
                    for (const language of regionalSections) {
                        try {
                            const regional = await ApiService.getRegionalContent(language, 'movie', 10);
                            if (regional.recommendations && regional.recommendations.length > 0) {
                                sectionsHTML += UIComponents.createCarousel(
                                    `üåç ${language.charAt(0).toUpperCase() + language.slice(1)} Cinema`,
                                    regional.recommendations,
                                    `${language}-section`
                                );
                            }
                        } catch (error) {
                            console.error(`Failed to load ${language} content:`, error);
                        }
                    }

                    contentSections.innerHTML = sectionsHTML;
                } catch (error) {
                    console.error('Failed to load recommendations:', error);
                    contentSections.innerHTML = `
                        <div style="text-align: center; padding: var(--space-3xl);">
                            <h2>Content is loading...</h2>
                            <p>Please check your connection and try again.</p>
                            <button class="btn btn-primary" onclick="Homepage.loadHomepageRecommendations()">
                                Retry
                            </button>
                        </div>
                    `;
                }
            }
        }

        // Explore content function
        function exploreContent() {
            const contentSections = document.getElementById('content-sections');
            contentSections.scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize homepage when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                Homepage.init();
            }, 100); // Small delay to ensure includes are loaded
        });
    </script>
</body>
</html>