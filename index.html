<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description"
        content="CineScope - Discover movies, TV shows, and anime with personalized recommendations">
    <title>CineScope - Your Cinema Universe</title>

    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="/css/base.css" rel="stylesheet">
    <link href="/css/bootstrap-overrides.css" rel="stylesheet">
    <link href="/css/tailwind.css" rel="stylesheet">
    <link href="/css/animation.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">
    <link href="/css/utilities.css" rel="stylesheet">
</head>

<body>
    <!-- Topbar -->
    <div id="topbar-container"></div>

    <!-- Main Content -->
    <main class="container-fluid py-4">
        <!-- Hero Section -->
        <section class="hero-section mb-5">
            <div class="row align-items-center min-vh-50">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4 text-gradient-animated">
                        Welcome to CineScope
                    </h1>
                    <p class="lead mb-4">
                        Discover your next favorite movie, TV show, or anime with AI-powered recommendations tailored
                        just for you.
                    </p>
                    <div class="d-flex gap-3 flex-wrap">
                        <a href="/content/search" class="btn btn-primary btn-lg">
                            <i class="bi bi-search"></i> Explore Now
                        </a>
                        <a href="/auth/register" class="btn btn-outline-primary btn-lg" id="get-started-btn">
                            Get Started
                        </a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div id="featured-carousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-inner" id="featured-content">
                            <!-- Featured content will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Trending Section -->
        <section class="mb-5">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h3 mb-0">üî• Trending Now</h2>
                <a href="/content/search?sort=trending" class="text-decoration-none">
                    See All <i class="bi bi-chevron-right"></i>
                </a>
            </div>
            <div id="trending-content" class="content-grid">
                <!-- Content will be loaded here -->
            </div>
        </section>

        <!-- New Releases -->
        <section class="mb-5">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h3 mb-0">üÜï New Releases</h2>
                <a href="/content/search?sort=new" class="text-decoration-none">
                    See All <i class="bi bi-chevron-right"></i>
                </a>
            </div>
            <div id="new-releases-content" class="content-grid">
                <!-- Content will be loaded here -->
            </div>
        </section>

        <!-- Critics Choice -->
        <section class="mb-5">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h3 mb-0">‚≠ê Critics' Choice</h2>
                <a href="/content/search?sort=rating" class="text-decoration-none">
                    See All <i class="bi bi-chevron-right"></i>
                </a>
            </div>
            <div id="critics-choice-content" class="content-grid">
                <!-- Content will be loaded here -->
            </div>
        </section>

        <!-- Admin's Choice (if available) -->
        <section class="mb-5" id="admin-choice-section" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h3 mb-0">üëë Admin's Choice</h2>
                <a href="/content/search?sort=admin" class="text-decoration-none">
                    See All <i class="bi bi-chevron-right"></i>
                </a>
            </div>
            <div id="admin-choice-content" class="content-grid">
                <!-- Content will be loaded here -->
            </div>
        </section>

        <!-- Browse by Genre -->
        <section class="mb-5">
            <h2 class="h3 mb-4">Browse by Genre</h2>
            <div class="row g-3" id="genre-cards">
                <!-- Genre cards will be loaded here -->
            </div>
        </section>

        <!-- Regional Content -->
        <section class="mb-5">
            <h2 class="h3 mb-4">Regional Cinema</h2>
            <div class="row g-3" id="regional-cards">
                <!-- Regional cards will be loaded here -->
            </div>
        </section>
    </main>

    <!-- Mobile Navigation -->
    <div id="mobile-nav-container"></div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/config.js"></script>
    <script src="/js/storage.js"></script>
    <script src="/js/http.js"></script>
    <script src="/js/ui.js"></script>
    <script src="/js/app.js"></script>

    <!-- Page Specific Script -->
    <script>
        // Home page logic
        async function initHomePage() {
            // Check if user is logged in
            const user = storage.getUser();
            if (user) {
                document.getElementById('get-started-btn')?.remove();
            }

            // Load featured content
            loadFeaturedContent();

            // Load content sections
            app.loadTrendingContent('trending-content');
            app.loadNewReleases('new-releases-content');
            app.loadCriticsChoice('critics-choice-content');

            // Load admin's choice if available
            loadAdminChoice();

            // Load genre cards
            loadGenreCards();

            // Load regional cards
            loadRegionalCards();
        }

        async function loadFeaturedContent() {
            try {
                const data = await api.getTrending({ limit: 5 });
                const carousel = document.getElementById('featured-content');

                data.recommendations.forEach((content, index) => {
                    const slide = document.createElement('div');
                    slide.className = `carousel-item ${index === 0 ? 'active' : ''}`;

                    const backdropUrl = content.backdrop_path ?
                        `${CONFIG.TMDB_IMAGE_BASE}/w1280${content.backdrop_path}` :
                        content.poster_path;

                    slide.innerHTML = `
            <div class="position-relative" style="cursor: pointer;" 
                 onclick="window.location.href='/content/details?id=${content.id}'">
              <img src="${backdropUrl}" class="d-block w-100 rounded-lg" 
                   style="max-height: 400px; object-fit: cover;" alt="${content.title}">
              <div class="position-absolute bottom-0 start-0 w-100 p-4" 
                   style="background: linear-gradient(transparent, rgba(0,0,0,0.9));">
                <h5 class="text-white mb-2">${content.title}</h5>
                <div class="d-flex gap-2">
                  ${content.rating ? `<span class="badge badge-blue"><i class="bi bi-star-fill"></i> ${content.rating.toFixed(1)}</span>` : ''}
                  <span class="badge badge-purple">${content.content_type.toUpperCase()}</span>
                </div>
              </div>
            </div>
          `;

                    carousel.appendChild(slide);
                });
            } catch (error) {
                console.error('Failed to load featured content:', error);
            }
        }

        async function loadAdminChoice() {
            try {
                const data = await api.getAdminChoice({ limit: 6 });
                if (data.recommendations && data.recommendations.length > 0) {
                    document.getElementById('admin-choice-section').style.display = 'block';
                    ui.createContentGrid(data.recommendations, 'admin-choice-content');
                }
            } catch (error) {
                console.error('Failed to load admin choice:', error);
            }
        }

        function loadGenreCards() {
            const genres = ['Action', 'Comedy', 'Drama', 'Horror', 'Romance', 'Sci-Fi'];
            const container = document.getElementById('genre-cards');

            genres.forEach(genre => {
                const col = document.createElement('div');
                col.className = 'col-6 col-md-4 col-lg-2';
                col.innerHTML = `
          <div class="card hover-lift cursor-pointer h-100" 
               onclick="window.location.href='/content/genre?g=${genre.toLowerCase()}'">
            <div class="card-body text-center">
              <i class="bi bi-film display-4 text-gradient-animated"></i>
              <h6 class="mt-2 mb-0">${genre}</h6>
            </div>
          </div>
        `;
                container.appendChild(col);
            });
        }

        function loadRegionalCards() {
            const regions = [
                { code: 'hindi', name: 'Hindi', icon: 'üáÆüá≥' },
                { code: 'telugu', name: 'Telugu', icon: 'üé¨' },
                { code: 'tamil', name: 'Tamil', icon: 'üé≠' },
                { code: 'malayalam', name: 'Malayalam', icon: 'üé™' }
            ];

            const container = document.getElementById('regional-cards');

            regions.forEach(region => {
                const col = document.createElement('div');
                col.className = 'col-6 col-md-3';
                col.innerHTML = `
          <div class="card hover-lift cursor-pointer h-100" 
               onclick="window.location.href='/content/regional?lang=${region.code}'">
            <div class="card-body text-center">
              <div class="display-4">${region.icon}</div>
              <h6 class="mt-2 mb-0">${region.name}</h6>
            </div>
          </div>
        `;
                container.appendChild(col);
            });
        }

        // Initialize page
        initHomePage();
    </script>
</body>

</html>