Re-design the details.html page for my CineBrain project.
The page must visually match the style of my existing index, topbar, mobile-nav and content-card, while maintaining a cinematic, modern look.
Ensure the layout is clean, responsive, and optimized for both desktop and mobile.
Use reusable components where possible and keep it consistent with the overall design system.

make the similar titles and more form genre should have the same stylings of content-card 
cast and crew should be scrollable 
the size of the text and photos should be auto adjustable according to the size of the mobile which should be same as above content-card and topbar 
the main poster is not showing full 
make the share styling best and professional like other top companies 
on the click of on cast of crew it should redirect ot persons.html file to get this cast or crew complete details
provide the complete updated production-level code for the html, css and js files with all the code

don't provide me the unnecessary code

details.html
<!DOCTYPE html><html lang="en"><head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"> <meta http-equiv="X-UA-Compatible" content="ie=edge">
text

<!-- Security Headers -->
<meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com https://fonts.gstatic.com https://www.googletagmanager.com;
    style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' data: https: blob:;
    connect-src 'self' https://backend-app-970m.onrender.com https://api.themoviedb.org https://image.tmdb.org https://api.jikan.moe https://www.omdbapi.com https://www.googleapis.com https://cdn.jsdelivr.net https://www.google-analytics.com;
    base-uri 'self';
    form-action 'self';
    frame-src 'self' https://www.youtube.com https://www.youtube-nocookie.com;
">

<!-- Primary Meta Tags - Will be updated dynamically -->
<title>Loading... - CineBrain</title>
<meta name="title" content="Details - CineBrain" id="meta-title">
<meta name="description"
    content="Watch detailed information, trailers, cast & crew, reviews, and get AI-powered personalized recommendations on CineBrain."
    id="meta-description">

<!-- Theme Color -->
<meta name="theme-color" content="#113CCF">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<!-- Favicon -->
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-icon-180x180.png">
<link rel="canonical" href="" id="canonical-url">

<!-- Open Graph - Will be updated dynamically -->
<meta property="og:type" content="video.movie" id="og-type">
<meta property="og:url" content="" id="og-url">
<meta property="og:title" content="Watch Details on CineBrain" id="og-title">
<meta property="og:description" content="Get complete information including cast, crew, trailers, and reviews."
    id="og-description">
<meta property="og:image" content="https://cinebrain.vercel.app/assets/images/og-image-1200x630.jpg" id="og-image">
<meta property="og:site_name" content="CineBrain">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@CineBrain">
<meta name="twitter:title" content="" id="twitter-title">
<meta name="twitter:description" content="" id="twitter-description">
<meta name="twitter:image" content="" id="twitter-image">

<!-- Preconnect -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="preconnect" href="https://image.tmdb.org">

<!-- Prefetch DNS for analytics -->
<link rel="dns-prefetch" href="https://www.google-analytics.com">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Bangers&family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link rel="stylesheet" href="/assets/css/topbar.css">
<link rel="stylesheet" href="/assets/css/mobile-nav.css">
<link rel="stylesheet" href="/assets/css/content-card.css">
<link rel="stylesheet" href="/assets/css/theme.css">
<link rel="stylesheet" href="/assets/css/details.css">

<!-- Theme Script -->
<script>
    (function () {
        try {
            const savedTheme = localStorage.getItem('cinebrain-theme');
            const theme = (savedTheme === 'light' || savedTheme === 'dark') ? savedTheme : 'dark';
            document.documentElement.setAttribute('data-theme', theme);
            document.documentElement.setAttribute('data-bs-theme', theme);
        } catch (e) {
            document.documentElement.setAttribute('data-theme', 'dark');
            document.documentElement.setAttribute('data-bs-theme', 'dark');
        }
    })();
</script>

<!-- Structured Data - Will be populated by JS -->
<script type="application/ld+json" id="structured-data"></script>
</head><body itemscope itemtype="https://schema.org/WebPage">
text

<!-- Skip to main content -->
<a href="#main-content" class="visually-hidden-focusable">Skip to main content</a>

<!-- Enhanced Loading State -->
<div class="details-loader" id="pageLoader" role="progressbar" aria-label="Loading content">
    <div class="loader-backdrop"></div>
    <div class="loader-content">
        <div class="cinebrain-pulse">
            <div class="pulse-ring"></div>
            <div class="pulse-ring"></div>
            <div class="pulse-ring"></div>
        </div>
        <div class="loader-text">Loading Details</div>
        <div class="loader-progress" id="loadingProgress">
            <div class="progress-bar" id="progressBar"></div>
        </div>
    </div>
</div>

<!-- Main TopBar Navigation -->
<header itemscope itemtype="https://schema.org/WPHeader">
    <nav class="navbar navbar-expand-lg navbar-cinebrain fixed-top" role="navigation" aria-label="Main navigation">
        <div class="container-fluid">
            <!-- Brand Section -->
            <div class="navbar-brand-wrapper">
                <a href="/" style="text-decoration: none;" aria-label="CineBrain Home">
                    <h1 class="navbar-brand-cinebrain">CineBrain</h1>
                    <div class="tagline">
                        <span class="tagline-full">The Mind Behind Your Next Favorite</span>
                        <span class="tagline-medium" style="display: none;">Your Next Favorite</span>
                        <span class="tagline-short" style="display: none;">Next Favorite</span>
                    </div>
                </a>
            </div>

            <!-- Desktop Search -->
            <div class="search-container desktop-search" id="desktopSearchContainer">
                <div class="search-wrapper">
                    <div class="search-bar-wrapper">
                        <div class="search-input-wrapper">
                            <i data-feather="search" class="search-icon" aria-hidden="true"></i>
                            <input type="text" class="form-control search-input" id="desktopSearchInput"
                                placeholder="Search movies, shows, anime..." autocomplete="off" maxlength="100"
                                aria-label="Search content">
                            <button class="search-clear" id="searchClear" aria-label="Clear search"
                                style="display: none;">
                                <i data-feather="x" aria-hidden="true"></i>
                            </button>
                        </div>
                        <div class="search-results" id="desktopSearchResults" role="listbox"
                            aria-label="Search results"></div>
                    </div>
                </div>
            </div>

            <!-- Right Section: Icons -->
            <div class="nav-icons-section">
                <!-- Mobile Search Trigger -->
                <button class="icon-button mobile-search-trigger" id="mobileSearchTrigger" aria-label="Open search">
                    <i data-feather="search" aria-hidden="true"></i>
                </button>

                <!-- Theme Toggle -->
                <button class="icon-button theme-toggle" id="themeToggle" aria-label="Toggle theme">
                    <i data-feather="sun" class="theme-icon theme-icon-light" aria-hidden="true"></i>
                    <i data-feather="moon" class="theme-icon theme-icon-dark" aria-hidden="true"></i>
                </button>

                <!-- Avatar/User Menu -->
                <div class="dropdown">
                    <div class="avatar-menu" data-bs-toggle="dropdown" aria-expanded="false" id="avatarMenu"
                        role="button" aria-haspopup="true" aria-label="User menu">
                        <i data-feather="user" aria-hidden="true"></i>
                    </div>
                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-cinebrain" id="userDropdown"></ul>
                </div>
            </div>
        </div>
    </nav>
</header>

<!-- Mobile Search Overlay -->
<div class="mobile-search-overlay" id="mobileSearchOverlay" aria-hidden="true" role="dialog" aria-label="Search">
    <div class="container">
        <div class="mobile-search-header">
            <button class="btn-back" id="closeMobileSearch" aria-label="Close search">
                <i data-feather="arrow-left" aria-hidden="true"></i>
            </button>
            <div class="mobile-search-input-wrapper">
                <i data-feather="search" class="search-icon" aria-hidden="true"></i>
                <input type="text" class="form-control search-input" id="mobileSearchInput"
                    placeholder="Search movies, shows, anime..." autocomplete="off" autofocus maxlength="100"
                    aria-label="Search content">
            </div>
        </div>
        <div class="search-results mobile-results" id="mobileSearchResults" role="listbox"
            aria-label="Search results"></div>
    </div>
</div>

<!-- Main Content Area -->
<main id="main-content" role="main" itemscope itemtype="https://schema.org/Movie">

    <!-- Enhanced Hero Section -->
    <section class="detail-hero" id="heroSection" aria-label="Content details">
        <!-- Dynamic backdrop with parallax -->
        <div class="hero-backdrop-container">
            <div class="hero-backdrop" id="heroBackdrop" role="img" aria-label="Background image"></div>
            <div class="hero-gradient-overlay"></div>
            <div class="hero-noise-overlay"></div>
        </div>

        <!-- Hero Content -->
        <div class="hero-inner">
            <div class="container-xl">
                <div class="hero-layout">
                    <!-- Poster Section -->
                    <div class="poster-section">
                        <div class="poster-card">
                            <div class="poster-image-container">
                                <img id="posterImage" class="poster-img" alt="Content poster" itemprop="image">
                                <div class="poster-shimmer" aria-hidden="true"></div>
                            </div>
                            <div class="poster-badges">
                                <span class="quality-badge" id="qualityBadge" style="display: none;">4K</span>
                                <span class="type-badge" id="contentTypeBadge">MOVIE</span>
                            </div>
                            <!-- Mobile Action Bar -->
                            <div class="mobile-action-bar" role="toolbar" aria-label="Content actions">
                                <button class="action-icon-btn play-btn" id="mobilePlayBtn"
                                    aria-label="Play trailer">
                                    <i data-feather="play-circle" aria-hidden="true"></i>
                                </button>
                                <button class="action-icon-btn" id="mobileWatchlistBtn"
                                    aria-label="Add to watchlist">
                                    <i data-feather="bookmark" aria-hidden="true"></i>
                                </button>
                                <button class="action-icon-btn" id="mobileFavoriteBtn"
                                    aria-label="Add to favorites">
                                    <i data-feather="heart" aria-hidden="true"></i>
                                </button>
                                <button class="action-icon-btn" id="mobileShareBtn" aria-label="Share content">
                                    <i data-feather="share-2" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Info Section -->
                    <div class="info-section">
                        <!-- Title Block -->
                        <div class="title-block">
                            <h1 class="main-title" id="contentTitle" itemprop="name">
                                <span class="title-skeleton" aria-hidden="true"></span>
                            </h1>
                            <div class="subtitle" id="originalTitle" itemprop="alternateName"></div>
                        </div>

                        <!-- Meta Pills -->
                        <div class="meta-pills" role="list" aria-label="Content metadata">
                            <span class="meta-pill year" id="releaseYear" role="listitem">
                                <i data-feather="calendar" aria-hidden="true"></i>
                                <span>2024</span>
                            </span>
                            <span class="meta-pill runtime" id="runtime" role="listitem">
                                <i data-feather="clock" aria-hidden="true"></i>
                                <span>0h 0m</span>
                            </span>
                            <span class="meta-pill rating" id="contentRating" role="listitem">
                                <i data-feather="star" aria-hidden="true"></i>
                                <span>0.0</span>
                            </span>
                            <span class="meta-pill language" id="originalLanguage" role="listitem">
                                <i data-feather="globe" aria-hidden="true"></i>
                                <span>EN</span>
                            </span>
                        </div>

                        <!-- Genre Tags -->
                        <div class="genre-tags" id="genreChips" itemprop="genre" role="list" aria-label="Genres">
                        </div>

                        <!-- Quick Synopsis -->
                        <div class="quick-synopsis" id="quickSynopsis" itemprop="description"></div>

                        <!-- Desktop Actions -->
                        <div class="desktop-actions" role="toolbar" aria-label="Content actions">
                            <button class="btn-primary-action" id="watchTrailerBtn" aria-label="Play trailer">
                                <i data-feather="play" aria-hidden="true"></i>
                                <span>Play Trailer</span>
                            </button>
                            <div class="action-buttons-group">
                                <button class="btn-circle-action" id="watchlistBtn" aria-label="Add to watchlist">
                                    <i data-feather="bookmark" aria-hidden="true"></i>
                                </button>
                                <button class="btn-circle-action" id="favoriteBtn" aria-label="Add to favorites">
                                    <i data-feather="heart" aria-hidden="true"></i>
                                </button>
                                <button class="btn-circle-action" id="shareBtn" aria-label="Share content">
                                    <i data-feather="share-2" aria-hidden="true"></i>
                                </button>
                                <button class="btn-circle-action" id="rateBtn" aria-label="Rate content">
                                    <i data-feather="star" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Stats Bar -->
                        <div class="stats-bar" role="list" aria-label="Content statistics">
                            <div class="stat-item" role="listitem">
                                <div class="stat-value" id="voteCount">0</div>
                                <div class="stat-label">Votes</div>
                            </div>
                            <div class="stat-item" role="listitem">
                                <div class="stat-value" id="popularityValue">0</div>
                                <div class="stat-label">Popularity</div>
                            </div>
                            <div class="stat-item" id="imdbStat" style="display: none;" role="listitem">
                                <div class="stat-value" id="imdbRating">0.0</div>
                                <div class="stat-label">IMDb</div>
                            </div>
                            <div class="stat-item" id="trendingStat" style="display: none;" role="listitem">
                                <div class="stat-value">#<span id="trendingRank">0</span></div>
                                <div class="stat-label">Trending</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Content Tabs Navigation -->
    <section class="content-navigation" role="tablist" aria-label="Content sections">
        <div class="container-xl">
            <div class="nav-tabs-wrapper">
                <button class="nav-tab active" data-tab="overview" role="tab" aria-selected="true"
                    aria-controls="overviewTab" tabindex="0">Overview</button>
                <button class="nav-tab" data-tab="cast" role="tab" aria-selected="false" aria-controls="castTab"
                    tabindex="-1">Cast & Crew</button>
                <button class="nav-tab" data-tab="media" role="tab" aria-selected="false" aria-controls="mediaTab"
                    tabindex="-1">Media</button>
                <button class="nav-tab" data-tab="reviews" role="tab" aria-selected="false"
                    aria-controls="reviewsTab" tabindex="-1">Reviews</button>
                <button class="nav-tab" data-tab="similar" role="tab" aria-selected="false"
                    aria-controls="similarTab" tabindex="-1">Similar</button>
            </div>
        </div>
    </section>

    <!-- Tab Content Container -->
    <div class="tab-content-container">

        <!-- Overview Tab -->
        <div class="tab-pane active" id="overviewTab" role="tabpanel" aria-labelledby="overview-tab">
            <div class="container-xl">
                <div class="overview-grid">
                    <!-- Main Content -->
                    <div class="overview-main">
                        <!-- Synopsis Card -->
                        <div class="detail-card">
                            <h2 class="card-title">
                                <i data-feather="file-text" aria-hidden="true"></i>
                                Storyline
                            </h2>
                            <div class="synopsis-content" id="synopsisContent">
                                <p class="synopsis-text" id="overviewText"></p>
                                <button class="expand-btn" id="expandSynopsisBtn" aria-expanded="false">
                                    <span>Show More</span>
                                    <i data-feather="chevron-down" aria-hidden="true"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Where to Watch -->
                        <div class="detail-card" id="streamingCard" style="display: none;">
                            <h2 class="card-title">
                                <i data-feather="tv" aria-hidden="true"></i>
                                Where to Watch
                            </h2>
                            <div class="streaming-grid" id="streamingProviders" role="list"
                                aria-label="Streaming providers"></div>
                        </div>

                        <!-- Content Warnings -->
                        <div class="detail-card" id="warningsCard" style="display: none;">
                            <h2 class="card-title">
                                <i data-feather="alert-triangle" aria-hidden="true"></i>
                                Content Advisories
                            </h2>
                            <div class="content-warnings" id="contentWarnings"></div>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="overview-sidebar">
                        <!-- Info Card -->
                        <div class="detail-card">
                            <h3 class="card-subtitle">Information</h3>
                            <div class="info-grid">
                                <div class="info-row">
                                    <span class="info-label">Status</span>
                                    <span class="info-value" id="status">-</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Release Date</span>
                                    <span class="info-value" id="releaseDate">-</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Budget</span>
                                    <span class="info-value" id="budget">-</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Revenue</span>
                                    <span class="info-value" id="revenue">-</span>
                                </div>
                                <div class="info-row" id="seasonsRow" style="display: none;">
                                    <span class="info-label">Seasons</span>
                                    <span class="info-value" id="seasonsCount">-</span>
                                </div>
                                <div class="info-row" id="episodesRow" style="display: none;">
                                    <span class="info-label">Episodes</span>
                                    <span class="info-value" id="episodesCount">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Production Card -->
                        <div class="detail-card" id="productionCard">
                            <h3 class="card-subtitle">Production</h3>
                            <div class="production-list" id="productionCompanies"></div>
                        </div>

                        <!-- Keywords -->
                        <div class="detail-card" id="keywordsCard" style="display: none;">
                            <h3 class="card-subtitle">Keywords</h3>
                            <div class="keywords-list" id="keywordsList" role="list" aria-label="Content keywords">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cast & Crew Tab -->
        <div class="tab-pane" id="castTab" role="tabpanel" aria-labelledby="cast-tab">
            <div class="container-xl">
                <!-- Cast Section -->
                <div class="detail-card">
                    <div class="section-header">
                        <h2 class="card-title">Cast</h2>
                        <button class="view-all-btn" id="viewAllCast">View All</button>
                    </div>
                    <div class="cast-grid" id="castGrid" role="list" aria-label="Cast members"></div>
                    <div class="empty-state" id="noCast" style="display: none;" role="status">
                        <i data-feather="users" aria-hidden="true"></i>
                        <p>No cast information available</p>
                    </div>
                </div>

                <!-- Crew Section -->
                <div class="detail-card">
                    <div class="section-header">
                        <h2 class="card-title">Crew</h2>
                        <button class="view-all-btn" id="viewAllCrew">View All</button>
                    </div>
                    <div class="crew-grid" id="crewGrid" role="list" aria-label="Crew members"></div>
                    <div class="empty-state" id="noCrew" style="display: none;" role="status">
                        <i data-feather="briefcase" aria-hidden="true"></i>
                        <p>No crew information available</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Media Tab -->
        <div class="tab-pane" id="mediaTab" role="tabpanel" aria-labelledby="media-tab">
            <div class="container-xl">
                <!-- Videos Section -->
                <div class="detail-card" id="videosCard">
                    <h2 class="card-title">Videos</h2>
                    <div class="videos-grid" id="videosGrid" role="list" aria-label="Videos"></div>
                    <div class="empty-state" id="noVideos" style="display: none;" role="status">
                        <i data-feather="play" aria-hidden="true"></i>
                        <p>No videos available</p>
                    </div>
                </div>

                <!-- Images Section -->
                <div class="detail-card" id="imagesCard">
                    <div class="media-tabs" role="tablist" aria-label="Image categories">
                        <button class="media-tab active" data-media="backdrops" role="tab"
                            aria-selected="true">Backdrops</button>
                        <button class="media-tab" data-media="posters" role="tab"
                            aria-selected="false">Posters</button>
                    </div>
                    <div class="images-grid" id="imagesGrid" role="list" aria-label="Images"></div>
                    <div class="empty-state" id="noImages" style="display: none;" role="status">
                        <i data-feather="image" aria-hidden="true"></i>
                        <p>No images available</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reviews Tab -->
        <div class="tab-pane" id="reviewsTab" role="tabpanel" aria-labelledby="reviews-tab">
            <div class="container-xl">
                <div class="reviews-header">
                    <h2 class="card-title">User Reviews</h2>
                    <button class="btn-write-review" id="writeReviewBtn">
                        <i data-feather="edit-3" aria-hidden="true"></i>
                        Write Review
                    </button>
                </div>
                <div class="reviews-list" id="reviewsList" role="list" aria-label="User reviews"></div>
                <div class="empty-state" id="noReviews" style="display: none;" role="status">
                    <i data-feather="message-square" aria-hidden="true"></i>
                    <p>No reviews yet. Be the first to write one!</p>
                </div>
            </div>
        </div>

        <!-- Similar Tab -->
        <div class="tab-pane" id="similarTab" role="tabpanel" aria-labelledby="similar-tab">
            <div class="container-xl">
                <!-- Similar Content -->
                <div class="content-row">
                    <div class="row-header">
                        <h2 class="row-title">Similar Titles</h2>
                    </div>
                    <div class="carousel-container">
                        <button class="carousel-nav prev" aria-label="Previous similar content">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" d="M15 18l-6-6 6-6" />
                            </svg>
                        </button>
                        <div class="carousel-wrapper" id="similarContent" role="list" aria-label="Similar content">
                        </div>
                        <button class="carousel-nav next" aria-label="Next similar content">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" d="M9 18l6-6-6-6" />
                            </svg>
                        </button>
                    </div>
                    <div class="empty-state" id="noSimilar" style="display: none;" role="status">
                        <i data-feather="search" aria-hidden="true"></i>
                        <p>No similar content found</p>
                    </div>
                </div>

                <!-- More from Genre -->
                <div class="content-row">
                    <div class="row-header">
                        <h2 class="row-title" id="genreTitle">More from Genre</h2>
                    </div>
                    <div class="carousel-container">
                        <button class="carousel-nav prev" aria-label="Previous genre content">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" d="M15 18l-6-6 6-6" />
                            </svg>
                        </button>
                        <div class="carousel-wrapper" id="genreContent" role="list" aria-label="Genre content">
                        </div>
                        <button class="carousel-nav next" aria-label="Next genre content">
                            <svg viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" d="M9 18l6-6-6-6" />
                            </svg>
                        </button>
                    </div>
                    <div class="empty-state" id="noGenre" style="display: none;" role="status">
                        <i data-feather="film" aria-hidden="true"></i>
                        <p>No genre content found</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

</main>

<!-- Mobile Bottom Navigation -->
<nav class="mobile-bottom-nav" id="mobileBottomNav" aria-label="Mobile navigation">
    <div class="mobile-nav-container" id="mobileNavContainer"></div>
</nav>

<!-- More Menu Overlay -->
<aside class="mobile-menu-overlay" id="mobileMenuOverlay" aria-hidden="true" role="dialog" aria-label="Mobile menu">
    <div class="menu-handle"></div>
    <div class="menu-header">
        <h3 class="menu-title">CineBrain Menu</h3>
        <button class="menu-close-btn" id="mobileMenuClose" aria-label="Close menu">
            <i data-feather="x" aria-hidden="true"></i>
        </button>
    </div>

    <section class="menu-section">
        <h4 class="menu-section-title">Browse Categories</h4>
        <div class="mobile-menu-grid" id="mobileMenuGrid"></div>
    </section>

    <section class="menu-section">
        <h4 class="menu-section-title" id="userSectionTitle">Account</h4>
        <div class="mobile-menu-list" id="mobileMenuList"></div>
    </section>

    <footer class="menu-footer">
        <div class="menu-footer-info">
            <span class="app-version">CineBrain v2.0.0</span>
            <span class="menu-footer-separator">•</span>
            <a href="/pages/privacy.html" class="menu-footer-link">Privacy</a>
            <span class="menu-footer-separator">•</span>
            <a href="/pages/terms.html" class="menu-footer-link">Terms</a>
        </div>
    </footer>
</aside>

<!-- Backdrop -->
<div class="mobile-backdrop" id="mobileBackdrop" aria-hidden="true"></div>

<!-- Modals -->
<!-- Trailer Modal -->
<div class="modal fade" id="trailerModal" tabindex="-1" aria-hidden="true" aria-labelledby="trailerTitle">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="trailerTitle">Trailer</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="ratio ratio-16x9">
                    <iframe id="trailerFrame" src="" frameborder="0" allowfullscreen title="Video trailer"></iframe>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Share Modal -->
<div class="modal fade" id="shareModal" tabindex="-1" aria-hidden="true" aria-labelledby="shareModalTitle">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="shareModalTitle">Share</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="share-grid" role="group" aria-label="Share options">
                    <button class="share-btn" id="shareWhatsApp" aria-label="Share on WhatsApp">
                        <i data-feather="message-circle" aria-hidden="true"></i>
                        <span>WhatsApp</span>
                    </button>
                    <button class="share-btn" id="shareTwitter" aria-label="Share on Twitter">
                        <i data-feather="twitter" aria-hidden="true"></i>
                        <span>Twitter</span>
                    </button>
                    <button class="share-btn" id="shareFacebook" aria-label="Share on Facebook">
                        <i data-feather="facebook" aria-hidden="true"></i>
                        <span>Facebook</span>
                    </button>
                    <button class="share-btn" id="copyLink" aria-label="Copy link">
                        <i data-feather="link" aria-hidden="true"></i>
                        <span>Copy Link</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Rating Modal -->
<div class="modal fade" id="ratingModal" tabindex="-1" aria-hidden="true" aria-labelledby="ratingModalTitle">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ratingModalTitle">Rate This</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="rating-stars" id="ratingStars" role="radiogroup" aria-label="Rate from 1 to 10 stars">
                    <!-- Stars will be generated by JS -->
                </div>
                <div class="rating-value-display">
                    <span id="selectedRating">0</span>/10
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="submitRating">Submit Rating</button>
            </div>
        </div>
    </div>
</div>

<!-- Person Detail Modal -->
<div class="modal fade" id="personModal" tabindex="-1" aria-hidden="true" aria-labelledby="personModalTitle">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="personModalTitle">Person Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="personModalBody">
                <!-- Person details will be loaded here -->
            </div>
        </div>
    </div>
</div>

<!-- Error Toast -->
<div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="errorToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <strong class="me-auto">CineBrain</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body" id="toastMessage">
            <!-- Toast message will be set by JS -->
        </div>
    </div>
</div>

<!-- Lightbox -->
<div class="image-lightbox" id="imageLightbox" role="dialog" aria-label="Image viewer">
    <button class="lightbox-close" id="closeLightbox" aria-label="Close image viewer">
        <i data-feather="x" aria-hidden="true"></i>
    </button>
    <div class="lightbox-content">
        <img id="lightboxImage" src="" alt="Enlarged image">
    </div>
</div>

<!-- Bootstrap Bundle JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Feather Icons -->
<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>

<!-- Custom JavaScript -->
<script src="/assets/js/theme-manager.js"></script>
<script src="/assets/js/topbar.js"></script>
<script src="/assets/js/mobile-nav.js"></script>
<script src="/assets/js/content-card.js"></script>
<script src="/assets/js/details.js"></script>

<!-- Analytics -->
<script>
    // Simple analytics implementation
    window.addEventListener('load', () => {
        if (window.gtag) {
            gtag('config', 'GA_MEASUREMENT_ID', {
                page_title: document.title,
                page_location: window.location.href
            });
        }
    });
</script>
</body></html>
details.css
:root {
/* Hero dimensions */
--hero-height: clamp(450px, 70vh, 650px);
--hero-mobile-height: clamp(500px, 80vh, 600px);

text

/* Content spacing */
--content-padding: clamp(16px, 4vw, 32px);
--section-gap: clamp(24px, 5vw, 48px);
--card-padding: clamp(20px, 4vw, 32px);

/* Poster dimensions */
--poster-width: clamp(150px, 30vw, 250px);
--poster-mobile-width: clamp(120px, 35vw, 160px);

/* Typography scale */
--title-size: clamp(1.75rem, 5vw, 3rem);
--subtitle-size: clamp(1rem, 2.5vw, 1.25rem);
--body-size: clamp(0.875rem, 2vw, 1rem);
--small-size: clamp(0.75rem, 1.8vw, 0.875rem);

/* Z-index layers */
--z-backdrop: 1;
--z-content: 2;
--z-overlay: 3;
--z-modal: 1050;
--z-lightbox: 1060;
}

/* Enhanced Page Loader */
.details-loader {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
z-index: 9999;
display: flex;
align-items: center;
justify-content: center;
transition: opacity 0.3s, visibility 0.3s;
}

.details-loader.hidden {
opacity: 0;
visibility: hidden;
pointer-events: none;
}

.loader-backdrop {
position: absolute;
inset: 0;
background: var(--card-bg);
opacity: 0.95;
}

.loader-content {
position: relative;
text-align: center;
}

.cinebrain-pulse {
position: relative;
width: 60px;
height: 60px;
margin: 0 auto 20px;
}

.pulse-ring {
position: absolute;
inset: 0;
border: 2px solid var(--cinebrain-primary);
border-radius: 50%;
animation: pulse-expand 1.5s ease-out infinite;
}

.pulse-ring:nth-child(2) {
animation-delay: 0.5s;
}

.pulse-ring:nth-child(3) {
animation-delay: 1s;
}

@keyframes pulse-expand {
0% {
transform: scale(0.8);
opacity: 1;
}

text

100% {
    transform: scale(2);
    opacity: 0;
}
}

.loader-text {
color: var(--text-secondary);
font-size: var(--small-size);
font-weight: 500;
animation: fade-pulse 1.5s ease-in-out infinite;
}

@keyframes fade-pulse {

text

0%,
100% {
    opacity: 0.5;
}

50% {
    opacity: 1;
}
}

/* Enhanced Hero Section */
.detail-hero {
position: relative;
min-height: var(--hero-height);
margin-top: var(--navbar-height);
overflow: hidden;
background: var(--card-bg);
}

@media (max-width: 767px) {
.detail-hero {
min-height: var(--hero-mobile-height);
}
}

/* Backdrop with parallax effect */
.hero-backdrop-container {
position: absolute;
inset: -10%;
z-index: var(--z-backdrop);
}

.hero-backdrop {
position: absolute;
inset: 0;
background-size: cover;
background-position: center 20%;
filter: blur(8px);
transform: scale(1.1);
opacity: 0.4;
transition: transform 10s ease-out;
}

.hero-gradient-overlay {
position: absolute;
inset: 0;
background: linear-gradient(to bottom,
transparent 0%,
rgba(var(--bg-rgb), 0.3) 30%,
rgba(var(--bg-rgb), 0.7) 60%,
var(--card-bg) 100%);
}

.hero-noise-overlay {
position: absolute;
inset: 0;
opacity: 0.03;
background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100'%3E%3Cfilter id='noise'%3E%3CfeTurbulence baseFrequency='0.9' /%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.5'/%3E%3C/svg%3E");
}

/* Hero Content Layout */
.hero-inner {
position: relative;
z-index: var(--z-content);
padding: var(--section-gap) 0;
}

.hero-layout {
display: grid;
grid-template-columns: auto 1fr;
gap: clamp(24px, 5vw, 48px);
align-items: start;
}

@media (max-width: 767px) {
.hero-layout {
grid-template-columns: 1fr;
gap: clamp(20px, 4vw, 32px);
}
}

/* Poster Section */
.poster-section {
position: relative;
}

.poster-card {
position: relative;
width: var(--poster-width);
margin: 0 auto;
}

@media (max-width: 767px) {
.poster-card {
width: var(--poster-mobile-width);
}
}

.poster-image-container {
position: relative;
aspect-ratio: 2/3;
border-radius: clamp(8px, 2vw, 16px);
overflow: hidden;
box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
background: var(--skeleton-bg);
}

.poster-img {
width: 100%;
height: 100%;
object-fit: cover;
opacity: 0;
transition: opacity 0.5s ease;
}

.poster-img.loaded {
opacity: 1;
}

.poster-shimmer {
position: absolute;
inset: 0;
background: linear-gradient(90deg,
var(--skeleton-bg) 0%,
var(--skeleton-shine) 50%,
var(--skeleton-bg) 100%);
background-size: 200% 100%;
animation: shimmer 1.5s infinite;
}

.poster-img.loaded+.poster-shimmer {
display: none;
}

@keyframes shimmer {
0% {
background-position: 200% 0;
}

text

100% {
    background-position: -200% 0;
}
}

.poster-badges {
position: absolute;
top: 12px;
right: 12px;
display: flex;
flex-direction: column;
gap: 8px;
z-index: var(--z-overlay);
}

.quality-badge,
.type-badge {
padding: 4px 8px;
background: var(--card-bg);
backdrop-filter: blur(10px);
border: 1px solid var(--nav-button-border);
border-radius: 4px;
font-size: 10px;
font-weight: 700;
letter-spacing: 0.5px;
text-transform: uppercase;
color: var(--text-primary);
}

.quality-badge {
background: var(--cinebrain-primary);
color: white;
border: none;
}

/* Mobile Action Bar */
.mobile-action-bar {
display: none;
grid-template-columns: repeat(4, 1fr);
gap: 12px;
margin-top: 16px;
}

@media (max-width: 767px) {
.mobile-action-bar {
display: grid;
}
}

.action-icon-btn {
aspect-ratio: 1;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
border-radius: 12px;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: var(--card-transition);
}

.action-icon-btn:hover {
background: var(--genre-chip-hover-bg);
transform: translateY(-2px);
}

.action-icon-btn.play-btn {
background: var(--cinebrain-primary);
color: white;
border: none;
}

.action-icon-btn.active {
background: var(--cinebrain-primary);
color: white;
}

.action-icon-btn svg {
width: 20px;
height: 20px;
}

/* Info Section */
.info-section {
display: flex;
flex-direction: column;
gap: clamp(16px, 3vw, 24px);
}

/* Title Block */
.title-block {
animation: fadeInUp 0.6s ease-out;
}

.main-title {
font-size: var(--title-size);
font-weight: 700;
line-height: 1.1;
color: var(--text-primary);
margin-bottom: 8px;
letter-spacing: -0.02em;
}

.title-skeleton {
display: inline-block;
width: 300px;
height: 40px;
background: var(--skeleton-bg);
border-radius: 8px;
animation: shimmer 1.5s infinite;
}

.subtitle {
font-size: var(--subtitle-size);
color: var(--text-secondary);
font-style: italic;
opacity: 0.8;
}

/* Meta Pills */
.meta-pills {
display: flex;
flex-wrap: wrap;
gap: 10px;
animation: fadeInUp 0.7s ease-out;
}

.meta-pill {
display: inline-flex;
align-items: center;
gap: 6px;
padding: 8px 14px;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
border-radius: 20px;
font-size: var(--small-size);
color: var(--text-primary);
font-weight: 500;
}

.meta-pill svg {
width: 14px;
height: 14px;
opacity: 0.7;
}

.meta-pill.rating {
background: var(--card-hover-bg);
border-color: var(--rating-gold);
}

.meta-pill.rating svg {
fill: var(--rating-star-color);
opacity: 1;
}

/* Genre Tags */
.genre-tags {
display: flex;
flex-wrap: wrap;
gap: 8px;
animation: fadeInUp 0.8s ease-out;
}

.genre-tag {
padding: 6px 14px;
background: transparent;
border: 1px solid var(--nav-button-border);
border-radius: 20px;
font-size: var(--small-size);
color: var(--text-secondary);
cursor: pointer;
transition: var(--card-transition);
}

.genre-tag:hover {
background: var(--genre-chip-hover-bg);
color: var(--text-primary);
transform: translateY(-2px);
}

/* Quick Synopsis */
.quick-synopsis {
font-size: var(--body-size);
line-height: 1.6;
color: var(--text-secondary);
display: -webkit-box;
-webkit-line-clamp: 3;
-webkit-box-orient: vertical;
overflow: hidden;
animation: fadeInUp 0.9s ease-out;
}

/* Desktop Actions */
.desktop-actions {
display: flex;
align-items: center;
gap: 16px;
animation: fadeInUp 1s ease-out;
}

@media (max-width: 767px) {
.desktop-actions {
display: none;
}
}

.btn-primary-action {
display: inline-flex;
align-items: center;
gap: 10px;
padding: 14px 28px;
background: var(--cinebrain-primary);
color: white;
border: none;
border-radius: 30px;
font-size: var(--body-size);
font-weight: 600;
cursor: pointer;
transition: var(--card-transition);
}

.btn-primary-action:hover {
background: var(--cinebrain-primary-light);
transform: translateY(-2px);
box-shadow: 0 10px 30px rgba(17, 60, 207, 0.3);
}

.btn-primary-action svg {
width: 18px;
height: 18px;
}

.action-buttons-group {
display: flex;
gap: 10px;
}

.btn-circle-action {
width: 48px;
height: 48px;
border-radius: 50%;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: var(--card-transition);
}

.btn-circle-action:hover {
background: var(--genre-chip-hover-bg);
transform: scale(1.1);
}

.btn-circle-action.active {
background: var(--cinebrain-primary);
color: white;
border-color: var(--cinebrain-primary);
}

.btn-circle-action svg {
width: 20px;
height: 20px;
}

/* Stats Bar */
.stats-bar {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
gap: 16px;
padding: 16px;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
border-radius: 12px;
animation: fadeInUp 1.1s ease-out;
}

.stat-item {
text-align: center;
}

.stat-value {
font-size: clamp(1.25rem, 3vw, 1.5rem);
font-weight: 700;
color: var(--text-primary);
line-height: 1;
margin-bottom: 4px;
}

.stat-label {
font-size: var(--small-size);
color: var(--text-secondary);
text-transform: uppercase;
letter-spacing: 0.5px;
}

/* Content Navigation Tabs */
.content-navigation {
position: sticky;
top: var(--navbar-height);
background: var(--card-bg);
border-bottom: 1px solid var(--nav-button-border);
z-index: 100;
margin-bottom: var(--section-gap);
}

.nav-tabs-wrapper {
display: flex;
gap: 0;
overflow-x: auto;
scrollbar-width: none;
-webkit-overflow-scrolling: touch;
}

.nav-tabs-wrapper::-webkit-scrollbar {
display: none;
}

.nav-tab {
flex-shrink: 0;
padding: 16px 24px;
background: transparent;
border: none;
border-bottom: 2px solid transparent;
color: var(--text-secondary);
font-size: var(--body-size);
font-weight: 500;
cursor: pointer;
transition: var(--card-transition);
white-space: nowrap;
}

.nav-tab:hover {
color: var(--text-primary);
}

.nav-tab.active {
color: var(--text-primary);
border-bottom-color: var(--cinebrain-primary);
}

/* Tab Content */
.tab-content-container {
min-height: 400px;
}

.tab-pane {
display: none;
animation: fadeIn 0.3s ease;
}

.tab-pane.active {
display: block;
}

@keyframes fadeIn {
from {
opacity: 0;
}

text

to {
    opacity: 1;
}
}

@keyframes fadeInUp {
from {
opacity: 0;
transform: translateY(20px);
}

text

to {
    opacity: 1;
    transform: translateY(0);
}
}

/* Detail Cards */
.detail-card {
background: var(--card-bg);
border: 1px solid var(--nav-button-border);
border-radius: 16px;
padding: var(--card-padding);
margin-bottom: var(--section-gap);
}

.card-title {
font-size: clamp(1.25rem, 3vw, 1.5rem);
font-weight: 600;
color: var(--text-primary);
margin-bottom: 20px;
display: flex;
align-items: center;
gap: 10px;
}

.card-title svg {
width: 24px;
height: 24px;
color: var(--cinebrain-primary);
}

.card-subtitle {
font-size: clamp(1rem, 2.5vw, 1.125rem);
font-weight: 600;
color: var(--text-primary);
margin-bottom: 16px;
}

/* Overview Grid */
.overview-grid {
display: grid;
grid-template-columns: 1fr 380px;
gap: var(--section-gap);
}

@media (max-width: 991px) {
.overview-grid {
grid-template-columns: 1fr;
}
}

/* Synopsis Content */
.synopsis-content {
position: relative;
}

.synopsis-text {
font-size: var(--body-size);
line-height: 1.7;
color: var(--text-secondary);
max-height: 150px;
overflow: hidden;
transition: max-height 0.5s ease;
}

.synopsis-text.expanded {
max-height: none;
}

.expand-btn {
display: inline-flex;
align-items: center;
gap: 6px;
margin-top: 12px;
padding: 8px 16px;
background: transparent;
border: 1px solid var(--nav-button-border);
border-radius: 20px;
color: var(--text-primary);
font-size: var(--small-size);
cursor: pointer;
transition: var(--card-transition);
}

.expand-btn:hover {
background: var(--card-hover-bg);
}

.expand-btn svg {
width: 16px;
height: 16px;
transition: transform 0.3s;
}

.expand-btn.expanded svg {
transform: rotate(180deg);
}

/* Streaming Grid */
.streaming-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
gap: 16px;
}

.streaming-provider {
display: flex;
flex-direction: column;
align-items: center;
gap: 8px;
padding: 12px;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
border-radius: 12px;
cursor: pointer;
transition: var(--card-transition);
}

.streaming-provider:hover {
transform: translateY(-4px);
box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.provider-logo {
width: 48px;
height: 48px;
object-fit: contain;
}

.provider-name {
font-size: var(--small-size);
color: var(--text-primary);
text-align: center;
}

/* Info Grid */
.info-grid {
display: flex;
flex-direction: column;
gap: 12px;
}

.info-row {
display: flex;
justify-content: space-between;
padding: 8px 0;
border-bottom: 1px solid var(--nav-button-border);
}

.info-row:last-child {
border-bottom: none;
}

.info-label {
color: var(--text-secondary);
font-size: var(--small-size);
}

.info-value {
color: var(--text-primary);
font-weight: 500;
font-size: var(--small-size);
text-align: right;
}

/* Production List */
.production-list {
display: flex;
flex-direction: column;
gap: 12px;
}

.production-item {
display: flex;
align-items: center;
gap: 12px;
}

.production-logo {
width: 40px;
height: 40px;
object-fit: contain;
background: var(--card-hover-bg);
padding: 8px;
border-radius: 8px;
}

.production-name {
font-size: var(--small-size);
color: var(--text-primary);
}

/* Keywords List */
.keywords-list {
display: flex;
flex-wrap: wrap;
gap: 8px;
}

.keyword-tag {
padding: 4px 10px;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
border-radius: 12px;
font-size: var(--small-size);
color: var(--text-secondary);
cursor: pointer;
transition: var(--card-transition);
}

.keyword-tag:hover {
background: var(--genre-chip-hover-bg);
color: var(--text-primary);
}

/* Cast & Crew Grid */
.cast-grid,
.crew-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
gap: 20px;
}

@media (max-width: 767px) {

text

.cast-grid,
.crew-grid {
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 16px;
}
}

.cast-card,
.crew-card {
text-align: center;
cursor: pointer;
transition: transform 0.3s;
}

.cast-card:hover,
.crew-card:hover {
transform: translateY(-8px);
}

.person-photo {
width: 100%;
aspect-ratio: 1;
object-fit: cover;
border-radius: 50%;
background: var(--skeleton-bg);
margin-bottom: 12px;
border: 3px solid var(--card-bg);
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.person-name {
font-weight: 600;
font-size: var(--small-size);
color: var(--text-primary);
margin-bottom: 4px;
display: -webkit-box;
-webkit-line-clamp: 2;
-webkit-box-orient: vertical;
overflow: hidden;
}

.person-role {
font-size: var(--small-size);
color: var(--text-secondary);
display: -webkit-box;
-webkit-line-clamp: 2;
-webkit-box-orient: vertical;
overflow: hidden;
}

/* Section Header */
.section-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
}

.view-all-btn {
padding: 6px 12px;
background: transparent;
border: 1px solid var(--nav-button-border);
border-radius: 12px;
color: var(--text-secondary);
font-size: var(--small-size);
cursor: pointer;
transition: var(--card-transition);
}

.view-all-btn:hover {
background: var(--card-hover-bg);
color: var(--text-primary);
}

/* Media Grids */
.videos-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
gap: 20px;
}

@media (max-width: 767px) {
.videos-grid {
grid-template-columns: 1fr;
}
}

.video-card {
position: relative;
aspect-ratio: 16/9;
background: var(--skeleton-bg);
border-radius: 12px;
overflow: hidden;
cursor: pointer;
transition: transform 0.3s;
}

.video-card:hover {
transform: scale(1.05);
}

.video-thumbnail {
width: 100%;
height: 100%;
object-fit: cover;
}

.video-play-btn {
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
width: 60px;
height: 60px;
background: rgba(0, 0, 0, 0.7);
backdrop-filter: blur(10px);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: var(--card-transition);
}

.video-card:hover .video-play-btn {
background: var(--cinebrain-primary);
}

.video-play-btn svg {
width: 24px;
height: 24px;
fill: white;
margin-left: 4px;
}

.video-title {
position: absolute;
bottom: 0;
left: 0;
right: 0;
padding: 12px;
background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
color: white;
font-size: var(--small-size);
font-weight: 500;
}

/* Media Tabs */
.media-tabs {
display: flex;
gap: 8px;
margin-bottom: 20px;
}

.media-tab {
padding: 8px 16px;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
border-radius: 20px;
color: var(--text-secondary);
font-size: var(--small-size);
cursor: pointer;
transition: var(--card-transition);
}

.media-tab.active {
background: var(--cinebrain-primary);
color: white;
border-color: var(--cinebrain-primary);
}

.images-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
gap: 16px;
}

@media (max-width: 767px) {
.images-grid {
grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
gap: 12px;
}
}

.image-card {
aspect-ratio: 16/9;
background: var(--skeleton-bg);
border-radius: 8px;
overflow: hidden;
cursor: pointer;
transition: transform 0.3s;
}

.image-card:hover {
transform: scale(1.05);
}

.image-card img {
width: 100%;
height: 100%;
object-fit: cover;
}

/* Reviews */
.reviews-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 24px;
}

.btn-write-review {
display: inline-flex;
align-items: center;
gap: 8px;
padding: 10px 20px;
background: var(--cinebrain-primary);
color: white;
border: none;
border-radius: 20px;
font-size: var(--small-size);
font-weight: 500;
cursor: pointer;
transition: var(--card-transition);
}

.btn-write-review:hover {
background: var(--cinebrain-primary-light);
transform: translateY(-2px);
}

.btn-write-review svg {
width: 16px;
height: 16px;
}

.reviews-list {
display: flex;
flex-direction: column;
gap: 20px;
}

.review-card {
background: var(--card-bg);
border: 1px solid var(--nav-button-border);
border-radius: 12px;
padding: 20px;
}

.review-header {
display: flex;
justify-content: space-between;
align-items: flex-start;
margin-bottom: 16px;
}

.reviewer-info {
display: flex;
gap: 12px;
}

.reviewer-avatar {
width: 48px;
height: 48px;
border-radius: 50%;
object-fit: cover;
background: var(--skeleton-bg);
}

.reviewer-details {
display: flex;
flex-direction: column;
gap: 4px;
}

.reviewer-name {
font-weight: 600;
color: var(--text-primary);
font-size: var(--body-size);
}

.review-date {
font-size: var(--small-size);
color: var(--text-secondary);
}

.review-rating {
display: flex;
gap: 2px;
}

.review-rating svg {
width: 16px;
height: 16px;
fill: var(--rating-star-color);
}

.review-content {
margin-bottom: 16px;
}

.review-title {
font-weight: 600;
color: var(--text-primary);
margin-bottom: 8px;
}

.review-text {
font-size: var(--body-size);
line-height: 1.6;
color: var(--text-secondary);
}

.review-actions {
display: flex;
gap: 12px;
}

.review-action-btn {
display: inline-flex;
align-items: center;
gap: 6px;
padding: 6px 12px;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
border-radius: 12px;
color: var(--text-secondary);
font-size: var(--small-size);
cursor: pointer;
transition: var(--card-transition);
}

.review-action-btn:hover {
background: var(--genre-chip-hover-bg);
color: var(--text-primary);
}

.review-action-btn svg {
width: 14px;
height: 14px;
}

/* Empty State */
.empty-state {
text-align: center;
padding: 60px 20px;
color: var(--text-secondary);
}

.empty-state svg {
width: 64px;
height: 64px;
margin-bottom: 16px;
opacity: 0.3;
}

.empty-state p {
font-size: var(--body-size);
}

/* Share Modal */
.share-grid {
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 12px;
}

.share-btn {
display: flex;
flex-direction: column;
align-items: center;
gap: 8px;
padding: 20px;
background: var(--card-hover-bg);
border: 1px solid var(--nav-button-border);
border-radius: 12px;
cursor: pointer;
transition: var(--card-transition);
}

.share-btn:hover {
background: var(--genre-chip-hover-bg);
transform: translateY(-2px);
}

.share-btn svg {
width: 24px;
height: 24px;
}

.share-btn span {
font-size: var(--small-size);
color: var(--text-primary);
}

/* Rating Modal */
.rating-stars {
display: flex;
justify-content: center;
gap: 8px;
margin-bottom: 20px;
}

.rating-star {
font-size: 32px;
color: var(--text-secondary);
cursor: pointer;
transition: var(--card-transition);
}

.rating-star:hover,
.rating-star.active {
color: var(--rating-star-color);
transform: scale(1.1);
}

.rating-value-display {
text-align: center;
font-size: 24px;
font-weight: 700;
color: var(--text-primary);
}

/* Image Lightbox */
.image-lightbox {
position: fixed;
inset: 0;
background: rgba(0, 0, 0, 0.95);
z-index: var(--z-lightbox);
display: none;
align-items: center;
justify-content: center;
animation: fadeIn 0.3s ease;
}

.image-lightbox.active {
display: flex;
}

.lightbox-close {
position: absolute;
top: 20px;
right: 20px;
width: 48px;
height: 48px;
background: rgba(255, 255, 255, 0.1);
backdrop-filter: blur(10px);
border: none;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: var(--card-transition);
}

.lightbox-close:hover {
background: rgba(255, 255, 255, 0.2);
}

.lightbox-close svg {
width: 24px;
height: 24px;
stroke: white;
}

.lightbox-content {
max-width: 90vw;
max-height: 90vh;
}

.lightbox-content img {
width: 100%;
height: 100%;
object-fit: contain;
}

/* Modal Overrides */
.modal-content {
background: var(--card-bg);
border: 1px solid var(--nav-button-border);
border-radius: 16px;
}

.modal-header {
border-bottom: 1px solid var(--nav-button-border);
padding: 20px;
}

.modal-title {
color: var(--text-primary);
font-weight: 600;
}

.modal-body {
padding: 20px;
}

.btn-close {
filter: var(--text-primary)==#ffffff ? invert(1): none;
}

/* Responsive Adjustments */
@media (max-width: 991px) {
.container-xl {
padding-left: var(--content-padding);
padding-right: var(--content-padding);
}
}

@media (max-width: 767px) {
.detail-hero {
padding-bottom: 20px;
}

text

.poster-section {
    text-align: center;
}

.info-section {
    text-align: center;
}

.meta-pills {
    justify-content: center;
}

.genre-tags {
    justify-content: center;
}

.stats-bar {
    grid-template-columns: repeat(2, 1fr);
}

body {
    padding-bottom: calc(var(--mobile-nav-height) + var(--safe-area-bottom));
}
}

/* Print Styles */
@media print {

text

.navbar-cinebrain,
.mobile-bottom-nav,
.content-navigation,
.btn-primary-action,
.action-buttons-group,
.mobile-action-bar {
    display: none !important;
}

.detail-hero {
    min-height: auto;
    margin-top: 0;
}

.hero-backdrop-container {
    display: none;
}
}

/* Accessibility */
.btn-primary-action:focus-visible,
.btn-circle-action:focus-visible,
.nav-tab:focus-visible,
.expand-btn:focus-visible {
outline: 2px solid var(--cinebrain-primary);
outline-offset: 2px;
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {

text

*,
*::before,
*::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
}
}

details.js
// Enhanced Details Page with Modern Design
class DetailsPage {
constructor() {
// API Configuration
this.apiBase = 'https://backend-app-970m.onrender.com/api';
this.posterBase = 'https://image.tmdb.org/t/p/w500';
this.backdropBase = 'https://image.tmdb.org/t/p/w1280';

text

    // Content Data
    this.contentSlug = this.getContentSlugFromUrl();
    this.contentData = null;

    // Authentication
    this.authToken = localStorage.getItem('cinebrain-token');
    this.isAuthenticated = !!this.authToken;
    this.currentUser = this.getCurrentUser();

    // User Lists
    this.userWatchlist = new Set();
    this.userFavorites = new Set();

    // UI State
    this.currentTab = 'overview';
    this.expandedSynopsis = false;
    this.currentMediaType = 'backdrops';

    // Initialize
    this.init();
}

getContentSlugFromUrl() {
    const queryString = window.location.search.substring(1);
    return decodeURIComponent(queryString);
}

getCurrentUser() {
    try {
        const userStr = localStorage.getItem('cinebrain-user');
        return userStr ? JSON.parse(userStr) : null;
    } catch (e) {
        console.error('Error parsing user data:', e);
        return null;
    }
}

async init() {
    try {
        if (!this.contentSlug) {
            this.showError('No content specified');
            this.hideLoader();
            return;
        }

        // Load user lists if authenticated
        if (this.isAuthenticated) {
            await this.loadUserLists();
        }

        // Load content details
        await this.loadContentDetails();

        // Setup UI
        this.setupEventListeners();
        this.setupTabNavigation();
        this.setupMediaTabs();
        this.setupModals();

        // Initialize icons
        if (typeof feather !== 'undefined') {
            feather.replace();
        }

        // Hide loader
        this.hideLoader();

        // Load additional content
        setTimeout(() => {
            this.loadRecommendations();
        }, 500);

    } catch (error) {
        console.error('Initialization error:', error);
        this.showError(error.message);
        this.hideLoader();
    }
}

async loadContentDetails() {
    const url = `${this.apiBase}/details/${encodeURIComponent(this.contentSlug)}`;

    try {
        const response = await fetch(url, {
            headers: {
                'Accept': 'application/json',
                ...(this.authToken && { 'Authorization': `Bearer ${this.authToken}` })
            }
        });

        if (!response.ok) {
            throw new Error(`Failed to load content (${response.status})`);
        }

        this.contentData = await response.json();
        await this.renderContent();

    } catch (error) {
        console.error('Error loading content:', error);
        throw error;
    }
}

async renderContent() {
    const data = this.contentData;
    if (!data) return;

    // Update page title
    document.title = `${data.title || 'Content'} - CineBrain`;

    // Hero Section
    this.renderHero(data);

    // Overview Tab
    this.renderOverview(data);

    // Cast & Crew Tab
    this.renderCastCrew(data);

    // Media Tab
    this.renderMedia(data);

    // Reviews Tab
    this.renderReviews(data);

    // Update action buttons
    this.updateActionButtons();

    // Re-initialize icons
    if (typeof feather !== 'undefined') {
        feather.replace();
    }
}

renderHero(data) {
    // Backdrop
    if (data.backdrop_url) {
        const backdrop = document.getElementById('heroBackdrop');
        if (backdrop) {
            backdrop.style.backgroundImage = `url(${data.backdrop_url})`;
            // Add parallax effect on scroll
            window.addEventListener('scroll', () => {
                const scrolled = window.pageYOffset;
                backdrop.style.transform = `translateY(${scrolled * 0.5}px)`;
            });
        }
    }

    // Poster
    const poster = document.getElementById('posterImage');
    if (poster && data.poster_url) {
        const img = new Image();
        img.onload = () => {
            poster.src = img.src;
            poster.classList.add('loaded');
        };
        img.src = data.poster_url;
        poster.alt = data.title || 'Poster';
    }

    // Badges
    if (data.quality) {
        const qualityBadge = document.getElementById('qualityBadge');
        if (qualityBadge) {
            qualityBadge.textContent = data.quality;
            qualityBadge.style.display = 'inline-block';
        }
    }

    const typeBadge = document.getElementById('contentTypeBadge');
    if (typeBadge) {
        typeBadge.textContent = (data.content_type || 'movie').toUpperCase();
    }

    // Title
    this.updateElement('contentTitle', data.title);
    if (data.original_title && data.original_title !== data.title) {
        this.updateElement('originalTitle', data.original_title);
    }

    // Meta Pills
    if (data.metadata?.release_date) {
        const year = new Date(data.metadata.release_date).getFullYear();
        document.querySelector('#releaseYear span').textContent = year;
    }

    if (data.metadata?.runtime) {
        document.querySelector('#runtime span').textContent = this.formatRuntime(data.metadata.runtime);
    }

    if (data.ratings?.tmdb) {
        document.querySelector('#contentRating span').textContent = data.ratings.tmdb.score.toFixed(1);
    }

    if (data.metadata?.original_language) {
        document.querySelector('#originalLanguage span').textContent =
            this.getLanguageName(data.metadata.original_language);
    }

    // Genres
    this.renderGenres(data.metadata?.genres || []);

    // Quick Synopsis
    const synopsis = data.synopsis?.overview || data.overview || '';
    const quickSynopsis = document.getElementById('quickSynopsis');
    if (quickSynopsis) {
        quickSynopsis.textContent = synopsis.substring(0, 200) +
            (synopsis.length > 200 ? '...' : '');
    }

    // Stats Bar
    if (data.ratings?.tmdb) {
        this.updateElement('voteCount', this.formatNumber(data.ratings.tmdb.count));
    }

    if (data.metadata?.popularity) {
        this.updateElement('popularityValue', Math.round(data.metadata.popularity));
    }

    if (data.ratings?.imdb?.score) {
        document.getElementById('imdbStat').style.display = 'block';
        this.updateElement('imdbRating', data.ratings.imdb.score.toFixed(1));
    }

    if (data.trending_rank) {
        document.getElementById('trendingStat').style.display = 'block';
        this.updateElement('trendingRank', data.trending_rank);
    }
}

renderGenres(genres) {
    const container = document.getElementById('genreChips');
    if (!container) return;

    container.innerHTML = genres.map(genre => `
        <span class="genre-tag" data-genre="${this.escapeHtml(genre.toLowerCase())}">
            ${this.escapeHtml(genre)}
        </span>
    `).join('');

    // Add click handlers
    container.querySelectorAll('.genre-tag').forEach(tag => {
        tag.addEventListener('click', () => {
            const genre = tag.dataset.genre;
            window.location.href = `/explore.html?genre=${encodeURIComponent(genre)}`;
        });
    });
}

renderOverview(data) {
    // Synopsis
    const overviewText = document.getElementById('overviewText');
    if (overviewText) {
        overviewText.textContent = data.synopsis?.overview || data.overview || '';
    }

    // Streaming Providers
    if (data.streaming_info) {
        this.renderStreamingProviders(data.streaming_info);
    }

    // Information
    this.updateElement('status', data.metadata?.status || 'Released');
    this.updateElement('releaseDate', this.formatDate(data.metadata?.release_date));

    if (data.metadata?.budget) {
        this.updateElement('budget', this.formatCurrency(data.metadata.budget));
    }

    if (data.metadata?.revenue) {
        this.updateElement('revenue', this.formatCurrency(data.metadata.revenue));
    }

    // TV Show specific
    if (data.seasons_episodes) {
        if (data.seasons_episodes.season_count) {
            document.getElementById('seasonsRow').style.display = 'flex';
            this.updateElement('seasonsCount', data.seasons_episodes.season_count);
        }

        if (data.seasons_episodes.episode_count) {
            document.getElementById('episodesRow').style.display = 'flex';
            this.updateElement('episodesCount', data.seasons_episodes.episode_count);
        }
    }

    // Production Companies
    if (data.metadata?.production_companies) {
        this.renderProductionCompanies(data.metadata.production_companies);
    }

    // Keywords
    if (data.keywords && data.keywords.length > 0) {
        this.renderKeywords(data.keywords);
    }
}

renderStreamingProviders(streamingInfo) {
    const card = document.getElementById('streamingCard');
    const container = document.getElementById('streamingProviders');

    if (!container) return;

    const allProviders = [
        ...(streamingInfo.stream || []),
        ...(streamingInfo.rent || []),
        ...(streamingInfo.buy || [])
    ];

    if (allProviders.length > 0) {
        card.style.display = 'block';

        container.innerHTML = allProviders.map(provider => `
            <div class="streaming-provider">
                <img src="${provider.logo_path}" alt="${provider.provider_name}" class="provider-logo">
                <span class="provider-name">${provider.provider_name}</span>
            </div>
        `).join('');
    }
}

renderProductionCompanies(companies) {
    const container = document.getElementById('productionCompanies');
    if (!container) return;

    container.innerHTML = companies.map(company => `
        <div class="production-item">
            ${company.logo_path ? `
                <img src="${company.logo_path}" alt="${company.name}" class="production-logo">
            ` : ''}
            <span class="production-name">${company.name}</span>
        </div>
    `).join('');
}

renderKeywords(keywords) {
    const card = document.getElementById('keywordsCard');
    const container = document.getElementById('keywordsList');

    if (!container) return;

    card.style.display = 'block';

    container.innerHTML = keywords.map(keyword => `
        <span class="keyword-tag" data-keyword="${this.escapeHtml(keyword)}">
            ${this.escapeHtml(keyword)}
        </span>
    `).join('');
}

renderCastCrew(data) {
    if (!data.cast_crew) return;

    // Cast
    const castGrid = document.getElementById('castGrid');
    if (castGrid && data.cast_crew.cast) {
        const cast = data.cast_crew.cast.slice(0, 12); // Show first 12

        castGrid.innerHTML = cast.map(member => `
            <div class="cast-card" data-person-id="${member.id}">
                <img class="person-photo" 
                     src="${member.profile_path || this.getPlaceholderAvatar()}" 
                     alt="${this.escapeHtml(member.name)}"
                     loading="lazy">
                <div class="person-name">${this.escapeHtml(member.name)}</div>
                <div class="person-role">${this.escapeHtml(member.character || '')}</div>
            </div>
        `).join('');
    }

    // Crew
    const crewGrid = document.getElementById('crewGrid');
    if (crewGrid && data.cast_crew.crew) {
        const crew = [
            ...(data.cast_crew.crew.directors || []),
            ...(data.cast_crew.crew.writers || []),
            ...(data.cast_crew.crew.producers || [])
        ].slice(0, 12);

        crewGrid.innerHTML = crew.map(member => `
            <div class="crew-card" data-person-id="${member.id}">
                <img class="person-photo" 
                     src="${member.profile_path || this.getPlaceholderAvatar()}" 
                     alt="${this.escapeHtml(member.name)}"
                     loading="lazy">
                <div class="person-name">${this.escapeHtml(member.name)}</div>
                <div class="person-role">${this.escapeHtml(member.job || '')}</div>
            </div>
        `).join('');
    }
}

renderMedia(data) {
    // Videos
    if (data.videos && data.videos.length > 0) {
        this.renderVideos(data.videos);
    }

    // Images
    if (data.images) {
        this.renderImages(data.images);
    }
}

renderVideos(videos) {
    const container = document.getElementById('videosGrid');
    if (!container) return;

    container.innerHTML = videos.map(video => `
        <div class="video-card" data-video-key="${video.key}">
            <img src="https://img.youtube.com/vi/${video.key}/hqdefault.jpg" 
                 alt="${this.escapeHtml(video.name)}"
                 class="video-thumbnail">
            <div class="video-play-btn">
                <svg viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                </svg>
            </div>
            <div class="video-title">${this.escapeHtml(video.name)}</div>
        </div>
    `).join('');

    // Add click handlers
    container.querySelectorAll('.video-card').forEach(card => {
        card.addEventListener('click', () => {
            const key = card.dataset.videoKey;
            this.playVideo(key);
        });
    });
}

renderImages(images) {
    const container = document.getElementById('imagesGrid');
    if (!container) return;

    const renderImageType = (type) => {
        const imageList = images[type] || [];

        container.innerHTML = imageList.map(image => `
            <div class="image-card" data-image-url="${image.url}">
                <img src="${image.thumbnail || image.url}" 
                     alt="Image"
                     loading="lazy">
            </div>
        `).join('');

        // Add click handlers
        container.querySelectorAll('.image-card').forEach(card => {
            card.addEventListener('click', () => {
                const url = card.dataset.imageUrl;
                this.openLightbox(url);
            });
        });
    };

    // Default to backdrops
    renderImageType('backdrops');

    // Media tab handlers
    document.querySelectorAll('.media-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.media-tab').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            renderImageType(tab.dataset.media);
        });
    });
}

renderReviews(data) {
    const container = document.getElementById('reviewsList');
    const noReviews = document.getElementById('noReviews');

    if (!container) return;

    if (!data.reviews || data.reviews.length === 0) {
        container.style.display = 'none';
        if (noReviews) noReviews.style.display = 'flex';
        return;
    }

    container.innerHTML = data.reviews.map(review => `
        <div class="review-card">
            <div class="review-header">
                <div class="reviewer-info">
                    <img class="reviewer-avatar" 
                         src="${review.user.avatar || this.getPlaceholderAvatar()}" 
                         alt="${this.escapeHtml(review.user.username)}">
                    <div class="reviewer-details">
                        <div class="reviewer-name">${this.escapeHtml(review.user.username)}</div>
                        <div class="review-date">${this.formatDate(review.created_at)}</div>
                    </div>
                </div>
                <div class="review-rating">
                    ${this.renderStars(review.rating)}
                </div>
            </div>
            <div class="review-content">
                ${review.title ? `<h4 class="review-title">${this.escapeHtml(review.title)}</h4>` : ''}
                <p class="review-text">${this.escapeHtml(review.review_text)}</p>
            </div>
            <div class="review-actions">
                <button class="review-action-btn" data-review-id="${review.id}">
                    <i data-feather="thumbs-up"></i>
                    Helpful (${review.helpful_count || 0})
                </button>
            </div>
        </div>
    `).join('');

    // Re-initialize icons
    if (typeof feather !== 'undefined') {
        feather.replace();
    }
}

async loadRecommendations() {
    // Load similar content
    await this.loadSimilarContent();

    // Load genre-based content
    await this.loadGenreContent();
}

async loadSimilarContent() {
    if (!this.contentData?.id) return;

    try {
        const response = await fetch(
            `${this.apiBase}/recommendations/similar/${this.contentData.id}?limit=20`
        );

        if (response.ok) {
            const data = await response.json();
            if (data.similar_content) {
                this.renderCarousel('similarContent', data.similar_content);
            }
        }
    } catch (error) {
        console.error('Error loading similar content:', error);
    }
}

async loadGenreContent() {
    if (!this.contentData?.metadata?.genres?.[0]) return;

    const primaryGenre = this.contentData.metadata.genres[0].toLowerCase();

    // Update title
    const genreTitle = document.getElementById('genreTitle');
    if (genreTitle) {
        genreTitle.textContent = `More ${primaryGenre.charAt(0).toUpperCase() + primaryGenre.slice(1)}`;
    }

    try {
        const response = await fetch(
            `${this.apiBase}/recommendations/genre/${primaryGenre}?type=${this.contentData.content_type}&limit=20`
        );

        if (response.ok) {
            const data = await response.json();
            if (data.recommendations) {
                this.renderCarousel('genreContent', data.recommendations);
            }
        }
    } catch (error) {
        console.error('Error loading genre content:', error);
    }
}

renderCarousel(containerId, items) {
    const container = document.getElementById(containerId);
    if (!container || !items) return;

    // Use content card structure from content-card.js
    container.innerHTML = '';

    items.forEach(item => {
        const card = this.createContentCard(item);
        if (card) {
            container.appendChild(card);
        }
    });

    // Setup navigation
    const carouselContainer = container.closest('.carousel-container');
    if (carouselContainer) {
        this.setupCarouselNavigation(carouselContainer);
    }
}

createContentCard(content) {
    // Create card following content-card.js structure
    const card = document.createElement('div');
    card.className = 'content-card';
    card.dataset.contentId = content.id;

    const posterUrl = this.formatPosterUrl(content.poster_url || content.poster_path);
    const rating = content.rating ? content.rating.toFixed(1) : 'N/A';
    const year = content.year || (content.release_date ? new Date(content.release_date).getFullYear() : '');
    const isInWatchlist = this.userWatchlist.has(parseInt(content.id));

    card.innerHTML = `
        <div class="card-poster-container">
            <img class="card-poster" 
                 data-src="${posterUrl}" 
                 alt="${this.escapeHtml(content.title || 'Content')}" 
                 loading="lazy">
            <div class="content-type-badge ${content.content_type || 'movie'}">
                ${(content.content_type || 'movie').toUpperCase()}
            </div>
            <div class="card-overlays">
                <div class="card-top-overlay">
                    <div></div>
                    <button class="wishlist-btn ${isInWatchlist ? 'active' : ''}" 
                            data-content-id="${content.id}">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                    </button>
                </div>
                <div class="card-bottom-overlay">
                    <div class="rating-badge">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                        </svg>
                        <span>${rating}</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-info">
            <div class="card-title">${this.escapeHtml(content.title || 'Unknown')}</div>
            <div class="card-meta">
                ${year ? `<span class="card-year">${year}</span>` : ''}
            </div>
        </div>
    `;

    // Setup lazy loading
    this.setupLazyLoading(card);

    // Add click handler
    card.addEventListener('click', (e) => {
        if (!e.target.closest('.wishlist-btn')) {
            const slug = content.slug || `content-${content.id}`;
            window.location.href = `/content/details.html?${encodeURIComponent(slug)}`;
        }
    });

    return card;
}

setupEventListeners() {
    // Play trailer
    const trailerBtn = document.getElementById('watchTrailerBtn');
    if (trailerBtn) {
        trailerBtn.addEventListener('click', () => {
            if (this.contentData?.trailer) {
                this.playTrailer(this.contentData.trailer);
            } else {
                this.showToast('No trailer available', 'warning');
            }
        });
    }

    // Mobile play button
    const mobilePlayBtn = document.getElementById('mobilePlayBtn');
    if (mobilePlayBtn) {
        mobilePlayBtn.addEventListener('click', () => {
            if (this.contentData?.trailer) {
                this.playTrailer(this.contentData.trailer);
            } else {
                this.showToast('No trailer available', 'warning');
            }
        });
    }

    // Watchlist buttons
    ['watchlistBtn', 'mobileWatchlistBtn'].forEach(id => {
        const btn = document.getElementById(id);
        if (btn) {
            btn.addEventListener('click', () => this.toggleWatchlist());
        }
    });

    // Favorite buttons
    ['favoriteBtn', 'mobileFavoriteBtn'].forEach(id => {
        const btn = document.getElementById(id);
        if (btn) {
            btn.addEventListener('click', () => this.toggleFavorite());
        }
    });

    // Share buttons
    ['shareBtn', 'mobileShareBtn'].forEach(id => {
        const btn = document.getElementById(id);
        if (btn) {
            btn.addEventListener('click', () => this.openShareModal());
        }
    });

    // Rate button
    const rateBtn = document.getElementById('rateBtn');
    if (rateBtn) {
        rateBtn.addEventListener('click', () => this.openRatingModal());
    }

    // Expand synopsis
    const expandBtn = document.getElementById('expandSynopsisBtn');
    if (expandBtn) {
        expandBtn.addEventListener('click', () => {
            const synopsisText = document.getElementById('overviewText');
            synopsisText.classList.toggle('expanded');
            expandBtn.classList.toggle('expanded');
            expandBtn.querySelector('span').textContent =
                synopsisText.classList.contains('expanded') ? 'Show Less' : 'Show More';
        });
    }

    // Write review button
    const writeReviewBtn = document.getElementById('writeReviewBtn');
    if (writeReviewBtn) {
        writeReviewBtn.addEventListener('click', () => {
            if (this.isAuthenticated) {
                window.location.href = `/review/write.html?content=${this.contentSlug}`;
            } else {
                this.showToast('Please login to write a review', 'warning');
                setTimeout(() => {
                    // Include current page URL as redirect parameter
                    window.location.href = '/auth/login.html?redirect=' + encodeURIComponent(window.location.href);
                }, 1000);
            }
        });
    }
}

setupTabNavigation() {
    const tabs = document.querySelectorAll('.nav-tab');
    const panes = document.querySelectorAll('.tab-pane');

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const targetTab = tab.dataset.tab;

            // Update tabs
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');

            // Update panes
            panes.forEach(pane => {
                pane.classList.remove('active');
                if (pane.id === `${targetTab}Tab`) {
                    pane.classList.add('active');
                }
            });

            this.currentTab = targetTab;
        });
    });
}

setupMediaTabs() {
    // Handled in renderImages
}

setupModals() {
    // Share modal handlers
    this.setupShareHandlers();

    // Rating modal
    this.setupRatingModal();
}

setupShareHandlers() {
    const shareUrl = window.location.href;
    const shareTitle = this.contentData?.title || 'Check out this on CineBrain';

    // WhatsApp
    const whatsappBtn = document.getElementById('shareWhatsApp');
    if (whatsappBtn) {
        whatsappBtn.addEventListener('click', () => {
            const url = `https://wa.me/?text=${encodeURIComponent(shareTitle + '\n' + shareUrl)}`;
            window.open(url, '_blank');
        });
    }

    // Twitter
    const twitterBtn = document.getElementById('shareTwitter');
    if (twitterBtn) {
        twitterBtn.addEventListener('click', () => {
            const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareTitle)}&url=${encodeURIComponent(shareUrl)}`;
            window.open(url, '_blank');
        });
    }

    // Facebook
    const facebookBtn = document.getElementById('shareFacebook');
    if (facebookBtn) {
        facebookBtn.addEventListener('click', () => {
            const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
            window.open(url, '_blank');
        });
    }

    // Copy Link
    const copyLinkBtn = document.getElementById('copyLink');
    if (copyLinkBtn) {
        copyLinkBtn.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(shareUrl);
                this.showToast('Link copied to clipboard', 'success');

                // Close modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('shareModal'));
                if (modal) modal.hide();
            } catch (error) {
                this.showToast('Failed to copy link', 'error');
            }
        });
    }
}

setupRatingModal() {
    const starsContainer = document.getElementById('ratingStars');
    const ratingDisplay = document.getElementById('selectedRating');
    const submitBtn = document.getElementById('submitRating');

    if (!starsContainer) return;

    let selectedRating = 0;

    // Create 10 stars
    for (let i = 1; i <= 10; i++) {
        const star = document.createElement('span');
        star.className = 'rating-star';
        star.innerHTML = '★';
        star.dataset.rating = i;

        star.addEventListener('click', () => {
            selectedRating = i;
            ratingDisplay.textContent = i;

            // Update star display
            starsContainer.querySelectorAll('.rating-star').forEach((s, index) => {
                s.classList.toggle('active', index < i);
            });
        });

        star.addEventListener('mouseenter', () => {
            starsContainer.querySelectorAll('.rating-star').forEach((s, index) => {
                s.classList.toggle('hover', index < i);
            });
        });

        starsContainer.appendChild(star);
    }

    starsContainer.addEventListener('mouseleave', () => {
        starsContainer.querySelectorAll('.rating-star').forEach(s => {
            s.classList.remove('hover');
        });
    });

    if (submitBtn) {
        submitBtn.addEventListener('click', () => {
            if (selectedRating > 0) {
                this.submitRating(selectedRating);
            }
        });
    }
}

async toggleWatchlist() {
    if (!this.isAuthenticated) {
        this.redirectToLogin('Please login to add to watchlist');
        return;
    }

    const btns = ['watchlistBtn', 'mobileWatchlistBtn'].map(id => document.getElementById(id)).filter(Boolean);

    btns.forEach(btn => btn.disabled = true);

    const isActive = btns[0]?.classList.contains('active');
    const contentId = this.contentData.id;

    try {
        const response = await fetch(`${this.apiBase}/interactions`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${this.authToken}`
            },
            body: JSON.stringify({
                content_id: parseInt(contentId),
                interaction_type: isActive ? 'remove_watchlist' : 'watchlist'
            })
        });

        if (response.ok) {
            btns.forEach(btn => {
                btn.classList.toggle('active');
                const icon = btn.querySelector('svg');
                if (icon) {
                    icon.setAttribute('fill', btn.classList.contains('active') ? 'currentColor' : 'none');
                }
            });

            if (!isActive) {
                this.userWatchlist.add(parseInt(contentId));
                this.showToast('Added to watchlist', 'success');
            } else {
                this.userWatchlist.delete(parseInt(contentId));
                this.showToast('Removed from watchlist', 'success');
            }

            // Update global state if available
            if (window.contentCardManager) {
                if (!isActive) {
                    window.contentCardManager.userWatchlist.add(parseInt(contentId));
                } else {
                    window.contentCardManager.userWatchlist.delete(parseInt(contentId));
                }
            }
        } else {
            throw new Error('Failed to update watchlist');
        }
    } catch (error) {
        console.error('Error updating watchlist:', error);
        this.showToast('Failed to update watchlist', 'error');
    } finally {
        setTimeout(() => {
            btns.forEach(btn => btn.disabled = false);
        }, 500);
    }
}

async toggleFavorite() {
    if (!this.isAuthenticated) {
        this.redirectToLogin('Please login to add to favorites');
        return;
    }

    const btns = ['favoriteBtn', 'mobileFavoriteBtn'].map(id => document.getElementById(id)).filter(Boolean);

    btns.forEach(btn => btn.disabled = true);

    const isActive = btns[0]?.classList.contains('active');
    const contentId = this.contentData.id;

    try {
        const response = await fetch(`${this.apiBase}/interactions`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${this.authToken}`
            },
            body: JSON.stringify({
                content_id: parseInt(contentId),
                interaction_type: isActive ? 'remove_favorite' : 'favorite'
            })
        });

        if (response.ok) {
            btns.forEach(btn => {
                btn.classList.toggle('active');
                const icon = btn.querySelector('svg');
                if (icon) {
                    icon.setAttribute('fill', btn.classList.contains('active') ? 'currentColor' : 'none');
                }
            });

            if (!isActive) {
                this.userFavorites.add(parseInt(contentId));
                this.showToast('Added to favorites', 'success');
            } else {
                this.userFavorites.delete(parseInt(contentId));
                this.showToast('Removed from favorites', 'success');
            }

            // Update global state if available
            if (window.contentCardManager) {
                if (!isActive) {
                    window.contentCardManager.userFavorites.add(parseInt(contentId));
                } else {
                    window.contentCardManager.userFavorites.delete(parseInt(contentId));
                }
            }
        } else {
            throw new Error('Failed to update favorites');
        }
    } catch (error) {
        console.error('Error updating favorites:', error);
        this.showToast('Failed to update favorites', 'error');
    } finally {
        setTimeout(() => {
            btns.forEach(btn => btn.disabled = false);
        }, 500);
    }
}
async submitRating(rating) {
    if (!this.isAuthenticated) {
        this.showToast('Please login to rate', 'warning');
        return;
    }

    try {
        const response = await fetch(`${this.apiBase}/interactions`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${this.authToken}`
            },
            body: JSON.stringify({
                content_id: this.contentData.id,
                interaction_type: 'rating',
                rating: rating
            })
        });

        if (response.ok) {
            this.showToast('Rating submitted', 'success');

            // Close modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('ratingModal'));
            if (modal) modal.hide();
        }
    } catch (error) {
        console.error('Error submitting rating:', error);
        this.showToast('Failed to submit rating', 'error');
    }
}

playTrailer(trailer) {
    if (!trailer || !trailer.embed_url) {
        this.showToast('No trailer available', 'warning');
        return;
    }

    const modal = document.getElementById('trailerModal');
    const trailerFrame = document.getElementById('trailerFrame');

    if (modal && trailerFrame) {
        trailerFrame.src = trailer.embed_url;

        const bsModal = new bootstrap.Modal(modal);
        bsModal.show();

        modal.addEventListener('hidden.bs.modal', () => {
            trailerFrame.src = '';
        }, { once: true });
    }
}

playVideo(key) {
    const url = `https://www.youtube.com/embed/${key}?autoplay=1`;
    this.playTrailer({ embed_url: url });
}

openLightbox(imageUrl) {
    const lightbox = document.getElementById('imageLightbox');
    const lightboxImage = document.getElementById('lightboxImage');

    if (lightbox && lightboxImage) {
        lightboxImage.src = imageUrl;
        lightbox.classList.add('active');

        // Close button
        const closeBtn = document.getElementById('closeLightbox');
        if (closeBtn) {
            closeBtn.addEventListener('click', () => {
                lightbox.classList.remove('active');
            }, { once: true });
        }

        // Click outside to close
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
                lightbox.classList.remove('active');
            }
        }, { once: true });
    }
}

openShareModal() {
    const modal = new bootstrap.Modal(document.getElementById('shareModal'));
    modal.show();
}

openRatingModal() {
    if (!this.isAuthenticated) {
        this.showToast('Please login to rate', 'warning');
        setTimeout(() => {
            // Include current page URL as redirect parameter
            window.location.href = '/auth/login.html?redirect=' + encodeURIComponent(window.location.href);
        }, 1000);
        return;
    }

    const modal = new bootstrap.Modal(document.getElementById('ratingModal'));
    modal.show();
}

setupCarouselNavigation(carouselContainer) {
    const wrapper = carouselContainer.querySelector('.carousel-wrapper');
    const prevBtn = carouselContainer.querySelector('.carousel-nav.prev');
    const nextBtn = carouselContainer.querySelector('.carousel-nav.next');

    if (!wrapper) return;

    const getScrollAmount = () => {
        const containerWidth = wrapper.clientWidth;
        const cardWidth = wrapper.querySelector('.content-card')?.offsetWidth || 180;
        const gap = parseInt(getComputedStyle(wrapper).gap) || 12;
        const visibleCards = Math.floor(containerWidth / (cardWidth + gap));
        return (cardWidth + gap) * Math.max(1, visibleCards - 1);
    };

    const updateNavButtons = () => {
        if (!prevBtn || !nextBtn) return;

        const scrollLeft = wrapper.scrollLeft;
        const maxScroll = wrapper.scrollWidth - wrapper.clientWidth;

        prevBtn.classList.toggle('disabled', scrollLeft <= 0);
        nextBtn.classList.toggle('disabled', scrollLeft >= maxScroll - 1);
    };

    if (prevBtn && nextBtn) {
        prevBtn.addEventListener('click', () => {
            wrapper.scrollBy({
                left: -getScrollAmount(),
                behavior: 'smooth'
            });
        });

        nextBtn.addEventListener('click', () => {
            wrapper.scrollBy({
                left: getScrollAmount(),
                behavior: 'smooth'
            });
        });

        wrapper.addEventListener('scroll', updateNavButtons);
        updateNavButtons();
    }
}

setupLazyLoading(card) {
    const img = card.querySelector('.card-poster');
    if (!img) return;

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const imgSrc = img.dataset.src;
                if (imgSrc) {
                    const tempImg = new Image();
                    tempImg.onload = () => {
                        img.src = imgSrc;
                        img.classList.add('loaded');
                    };
                    tempImg.onerror = () => {
                        img.src = this.getPlaceholderImage();
                        img.classList.add('loaded');
                    };
                    tempImg.src = imgSrc;
                }
                observer.unobserve(img);
            }
        });
    }, {
        rootMargin: '50px',
        threshold: 0.01
    });
    observer.observe(img);
}

updateActionButtons() {
    // Update watchlist buttons
    const isInWatchlist = this.userWatchlist.has(parseInt(this.contentData.id));
    ['watchlistBtn', 'mobileWatchlistBtn'].forEach(id => {
        const btn = document.getElementById(id);
        if (btn) {
            btn.classList.toggle('active', isInWatchlist);
        }
    });

    // Update favorite buttons
    const isInFavorites = this.userFavorites.has(parseInt(this.contentData.id));
    ['favoriteBtn', 'mobileFavoriteBtn'].forEach(id => {
        const btn = document.getElementById(id);
        if (btn) {
            btn.classList.toggle('active', isInFavorites);
        }
    });
}

async loadUserLists() {
    // Implementation to load user's watchlist and favorites
    // ... (similar to original)
}

// Helper methods
hideLoader() {
    const loader = document.getElementById('pageLoader');
    if (loader) {
        loader.classList.add('hidden');
        setTimeout(() => {
            if (loader.parentNode) {
                loader.parentNode.removeChild(loader);
            }
        }, 300);
    }
}

updateElement(elementId, value) {
    const element = document.getElementById(elementId);
    if (element) {
        element.textContent = value || '';
    }
}

formatPosterUrl(posterPath) {
    if (!posterPath) {
        return this.getPlaceholderImage();
    }
    if (posterPath.startsWith('http')) {
        return posterPath;
    }
    return `${this.posterBase}${posterPath}`;
}

formatRuntime(minutes) {
    if (!minutes) return '';
    const hours = Math.floor(minutes / 60);
    const mins = minutes % 60;
    return hours > 0 ? `${hours}h ${mins}m` : `${mins}m`;
}

formatDate(dateString) {
    if (!dateString) return 'N/A';
    try {
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
    } catch {
        return dateString;
    }
}

formatNumber(num) {
    if (!num) return '0';
    return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
}

formatCurrency(amount) {
    if (!amount) return 'N/A';
    return new Intl.NumberFormat('en-US', {
        style: 'currency',
        currency: 'USD',
        minimumFractionDigits: 0
    }).format(amount);
}

getLanguageName(code) {
    const languages = {
        'en': 'EN',
        'es': 'ES',
        'fr': 'FR',
        'de': 'DE',
        'ja': 'JA',
        'ko': 'KO',
        'zh': 'ZH',
        'hi': 'HI',
        'te': 'TE'
    };
    return languages[code] || code?.toUpperCase() || 'Unknown';
}

renderStars(rating) {
    const fullStars = Math.floor(rating / 2);
    const stars = [];

    for (let i = 0; i < 5; i++) {
        if (i < fullStars) {
            stars.push('<span style="color: var(--rating-star-color)">★</span>');
        } else {
            stars.push('<span style="color: var(--text-secondary)">★</span>');
        }
    }

    return stars.join('');
}

showToast(message, type = 'success') {
    if (window.topbar?.notificationSystem) {
        window.topbar.notificationSystem.show(message, type);
    }
}

showError(message) {
    const container = document.querySelector('#main-content');
    if (container) {
        container.innerHTML = `
            <div style="text-align: center; padding: 50px 20px;">
                <h2 style="color: var(--text-primary);">Error</h2>
                <p style="color: var(--text-secondary);">${this.escapeHtml(message)}</p>
                <a href="/" style="color: var(--cinebrain-primary);">Go Home</a>
            </div>
        `;
    }
}

escapeHtml(text) {
    if (!text || typeof text !== 'string') return '';
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, m => map[m]);
}

getPlaceholderImage() {
    return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjQ1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjQ1MCIgZmlsbD0iIzFhMWYzYSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmaWxsPSIjNjY3IiBmb250LXNpemU9IjE4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+Tm8gSW1hZ2U8L3RleHQ+PC9zdmc+';
}

getPlaceholderAvatar() {
    return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI2MCIgY3k9IjYwIiByPSI2MCIgZmlsbD0iIzFhMWYzYSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmaWxsPSIjNjY3IiBmb250LXNpemU9IjQwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+PzwvdGV4dD48L3N2Zz4=';
}
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
try {
const detailsPage = new DetailsPage();
window.detailsPage = detailsPage;
} catch (error) {
console.error('Failed to initialize details page:', error);
}
});