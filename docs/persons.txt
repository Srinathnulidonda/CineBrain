1. person.html

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com https://fonts.gstatic.com;
        style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data: https: blob:;
        connect-src 'self' https://backend-app-970m.onrender.com https://api.themoviedb.org https://image.tmdb.org https://api.jikan.moe https://www.omdbapi.com;
        base-uri 'self';
        form-action 'self';
        frame-src 'self' https://www.youtube.com https://www.youtube-nocookie.com;
    ">

    <title>Loading... - CineBrain</title>
    <meta name="title" content="Person Details - CineBrain" id="meta-title">
    <meta name="description"
        content="Explore detailed information about your favorite actors, directors, and crew members on CineBrain."
        id="meta-description">
    <meta name="theme-color" content="#113CCF">

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-icon-180x180.png">
    <link rel="canonical" href="" id="canonical-url">

    <meta property="og:type" content="profile" id="og-type">
    <meta property="og:url" content="" id="og-url">
    <meta property="og:title" content="Person Details on CineBrain" id="og-title">
    <meta property="og:description" content="Discover detailed information about actors, directors, and crew members."
        id="og-description">
    <meta property="og:image" content="https://cinebrain.vercel.app/assets/images/og-image-1200x630.jpg" id="og-image">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://image.tmdb.org">

    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="/assets/css/topbar.css">
    <link rel="stylesheet" href="/assets/css/mobile-nav.css">
    <link rel="stylesheet" href="/assets/css/content-card.css">
    <link rel="stylesheet" href="/assets/css/theme.css">
    <link rel="stylesheet" href="/assets/css/details.css">
    <link rel="stylesheet" href="/assets/css/person.css">

    <style>
        /* Enhanced styles for upcoming content and improved social media */
        .filmography-card.upcoming {
            border: 2px solid var(--cinebrain-primary);
            position: relative;
            background: linear-gradient(135deg,
                    var(--card-bg) 0%,
                    rgba(var(--cinebrain-primary-rgb), 0.05) 100%);
        }

        .upcoming-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--cinebrain-primary);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 2;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filmography-overview {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 8px;
            line-height: 1.4;
        }

        .social-link-card {
            display: flex;
            align-items: center;
            padding: 16px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .social-link-card:hover {
            color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: var(--cinebrain-primary);
        }

        .social-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            background: var(--card-bg-secondary);
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .social-icon i {
            width: 20px;
            height: 20px;
        }

        .social-info {
            flex: 1;
            min-width: 0;
        }

        .social-name {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 4px;
        }

        .social-handle {
            font-size: 0.875rem;
            color: var(--text-secondary);
            word-break: break-all;
        }

        .social-arrow {
            margin-left: 12px;
            opacity: 0.5;
            transition: all 0.3s ease;
        }

        .social-link-card:hover .social-arrow {
            opacity: 1;
            transform: translateX(4px);
        }

        /* Platform-specific colors */
        .social-link-card[data-platform="twitter"]:hover .social-icon {
            background: #1DA1F2;
            border-color: #1DA1F2;
            color: white;
        }

        .social-link-card[data-platform="instagram"]:hover .social-icon {
            background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D);
            border-color: #E1306C;
            color: white;
        }

        .social-link-card[data-platform="facebook"]:hover .social-icon {
            background: #1877F2;
            border-color: #1877F2;
            color: white;
        }

        .social-link-card[data-platform="tiktok"]:hover .social-icon {
            background: #000000;
            border-color: #000000;
            color: white;
        }

        .social-link-card[data-platform="youtube"]:hover .social-icon {
            background: #FF0000;
            border-color: #FF0000;
            color: white;
        }

        .social-link-card[data-platform="imdb"]:hover .social-icon {
            background: #F5C518;
            border-color: #F5C518;
            color: #000000;
        }

        .quick-stat-item.highlight {
            background: linear-gradient(135deg,
                    rgba(var(--cinebrain-primary-rgb), 0.1) 0%,
                    rgba(var(--cinebrain-primary-rgb), 0.05) 100%);
            border: 1px solid rgba(var(--cinebrain-primary-rgb), 0.2);
        }

        .quick-stat-item.highlight .quick-stat-value {
            color: var(--cinebrain-primary);
        }

        .career-highlight-item {
            background: var(--card-bg-secondary);
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .career-highlight-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .highlight-icon {
            width: 24px;
            height: 24px;
            color: var(--cinebrain-primary);
            margin-bottom: 8px;
        }

        .highlight-title {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .highlight-value {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .filter-tab {
            position: relative;
            background: transparent;
            border: 1px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .filter-tab.active,
        .filter-tab:hover {
            background: var(--cinebrain-primary);
            border-color: var(--cinebrain-primary);
            color: white;
        }

        .photo-card {
            aspect-ratio: 2/3;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .photo-card:hover {
            transform: scale(1.03);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .photo-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .loading-shimmer {
            background: linear-gradient(90deg,
                    var(--card-bg) 25%,
                    var(--card-bg-secondary) 50%,
                    var(--card-bg) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        .error-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .error-state i {
            width: 48px;
            height: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .retry-btn {
            background: var(--cinebrain-primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            margin-top: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .retry-btn:hover {
            background: var(--cinebrain-primary-dark);
            transform: translateY(-2px);
        }

        /* Enhanced responsive design */
        @media (max-width: 768px) {
            .social-link-card {
                padding: 12px;
            }

            .social-icon {
                width: 40px;
                height: 40px;
                margin-right: 12px;
            }

            .career-highlight-item {
                padding: 12px;
            }

            .filter-tabs {
                gap: 8px;
                padding: 0 8px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .filter-tab {
                padding: 6px 12px;
                font-size: 0.8rem;
                flex-shrink: 0;
            }
        }
    </style>

    <script>
        (function () {
            try {
                const savedTheme = localStorage.getItem('cinebrain-theme');
                const theme = (savedTheme === 'light' || savedTheme === 'dark') ? savedTheme : 'dark';
                document.documentElement.setAttribute('data-theme', theme);
                document.documentElement.setAttribute('data-bs-theme', theme);
            } catch (e) {
                document.documentElement.setAttribute('data-theme', 'dark');
                document.documentElement.setAttribute('data-bs-theme', 'dark');
            }
        })();
    </script>
</head>

<body itemscope itemtype="https://schema.org/Person">
    <a href="#main-content" class="visually-hidden-focusable">Skip to main content</a>

    <!-- Page Loader -->
    <div class="details-loader" id="pageLoader" role="progressbar" aria-label="Loading person details">
        <div class="loader-backdrop"></div>
        <div class="loader-content">
            <div class="cinebrain-pulse">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="loader-text">Loading Person Details</div>
            <div class="loader-subtext">Fetching comprehensive information...</div>
        </div>
    </div>

    <!-- Header -->
    <header itemscope itemtype="https://schema.org/WPHeader">
        <nav class="navbar navbar-expand-lg navbar-cinebrain fixed-top" role="navigation" aria-label="Main navigation">
            <div class="container-fluid">
                <div class="navbar-brand-wrapper">
                    <a href="/" style="text-decoration: none;" aria-label="CineBrain Home">
                        <h1 class="navbar-brand-cinebrain">CineBrain</h1>
                        <div class="tagline">
                            <span class="tagline-full">The Mind Behind Your Next Favorite</span>
                            <span class="tagline-medium" style="display: none;">Your Next Favorite</span>
                            <span class="tagline-short" style="display: none;">Next Favorite</span>
                        </div>
                    </a>
                </div>

                <div class="search-container desktop-search" id="desktopSearchContainer">
                    <div class="search-wrapper">
                        <div class="search-bar-wrapper">
                            <div class="search-input-wrapper">
                                <i data-feather="search" class="search-icon"></i>
                                <input type="text" class="form-control search-input" id="desktopSearchInput"
                                    placeholder="Search movies, shows, anime..." autocomplete="off" maxlength="100">
                                <button class="search-clear" id="searchClear" aria-label="Clear search"
                                    style="display: none;">
                                    <i data-feather="x"></i>
                                </button>
                            </div>
                            <div class="search-results" id="desktopSearchResults" role="listbox"></div>
                        </div>
                    </div>
                </div>

                <div class="nav-icons-section">
                    <button class="icon-button mobile-search-trigger" id="mobileSearchTrigger" aria-label="Open search">
                        <i data-feather="search"></i>
                    </button>
                    <button class="icon-button theme-toggle" id="themeToggle" aria-label="Toggle theme">
                        <i data-feather="sun" class="theme-icon theme-icon-light"></i>
                        <i data-feather="moon" class="theme-icon theme-icon-dark"></i>
                    </button>
                    <div class="dropdown">
                        <div class="avatar-menu" data-bs-toggle="dropdown" id="avatarMenu" role="button">
                            <i data-feather="user"></i>
                        </div>
                        <ul class="dropdown-menu dropdown-menu-end dropdown-menu-cinebrain" id="userDropdown"></ul>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Mobile Search Overlay -->
    <div class="mobile-search-overlay" id="mobileSearchOverlay" aria-hidden="true">
        <div class="container">
            <div class="mobile-search-header">
                <button class="btn-back" id="closeMobileSearch" aria-label="Close search">
                    <i data-feather="arrow-left"></i>
                </button>
                <div class="mobile-search-input-wrapper">
                    <i data-feather="search" class="search-icon"></i>
                    <input type="text" class="form-control search-input" id="mobileSearchInput"
                        placeholder="Search movies, shows, anime..." autocomplete="off" autofocus maxlength="100">
                </div>
            </div>
            <div class="search-results mobile-results" id="mobileSearchResults" role="listbox"></div>
        </div>
    </div>

    <!-- Main Content -->
    <main id="main-content" role="main">
        <!-- Person Hero Section -->
        <section class="person-hero" id="heroSection">
            <div class="hero-backdrop-container">
                <div class="hero-backdrop" id="heroBackdrop"></div>
                <div class="hero-gradient-overlay"></div>
            </div>

            <div class="hero-inner">
                <div class="container-xl">
                    <div class="person-hero-layout">
                        <div class="person-photo-section">
                            <div class="person-photo-card">
                                <div class="person-photo-container">
                                    <img id="personPhoto" class="person-photo-img" alt="Person photo" itemprop="image">
                                    <div class="photo-shimmer loading-shimmer"></div>
                                </div>
                                <div class="person-badges">
                                    <span class="department-badge" id="departmentBadge">ACTOR</span>
                                </div>
                                <div class="mobile-action-bar">
                                    <button class="action-icon-btn" id="mobileFollowBtn" title="Follow">
                                        <i data-feather="user-plus"></i>
                                    </button>
                                    <button class="action-icon-btn" id="mobileShareBtn" title="Share">
                                        <i data-feather="share-2"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="person-info-section">
                            <div class="person-title-block">
                                <h1 class="person-name" id="personName" itemprop="name">
                                    <span class="title-skeleton loading-shimmer"></span>
                                </h1>
                                <div class="person-subtitle" id="knownFor" itemprop="jobTitle"></div>
                            </div>

                            <div class="person-meta-pills">
                                <span class="meta-pill age" id="personAge" style="display: none;">
                                    <i data-feather="calendar"></i>
                                    <span>Age: 0</span>
                                </span>
                                <span class="meta-pill works" id="totalWorks">
                                    <i data-feather="film"></i>
                                    <span>0 Works</span>
                                </span>
                                <span class="meta-pill popularity" id="personPopularity">
                                    <i data-feather="trending-up"></i>
                                    <span>0.0</span>
                                </span>
                                <span class="meta-pill birthplace" id="birthPlace" style="display: none;">
                                    <i data-feather="map-pin"></i>
                                    <span>Unknown</span>
                                </span>
                            </div>

                            <div class="person-bio-preview" id="bioPreview" itemprop="description"></div>

                            <div class="desktop-actions">
                                <button class="btn-primary-action" id="viewFilmographyBtn"
                                    title="View complete filmography">
                                    <i data-feather="film"></i>
                                    <span>View Filmography</span>
                                </button>
                                <div class="action-buttons-group">
                                    <button class="btn-circle-action" id="followBtn" title="Follow this person">
                                        <i data-feather="user-plus"></i>
                                    </button>
                                    <button class="btn-circle-action" id="shareBtn" title="Share this person">
                                        <i data-feather="share-2"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="person-stats-bar">
                                <div class="stat-item">
                                    <div class="stat-value" id="yearsActive">0</div>
                                    <div class="stat-label">Years Active</div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-value" id="totalProjects">0</div>
                                    <div class="stat-label">Projects</div>
                                </div>
                                <div class="stat-item" id="highestRatedStat" style="display: none;">
                                    <div class="stat-value" id="highestRated">0.0</div>
                                    <div class="stat-label">Highest Rated</div>
                                </div>
                                <div class="stat-item" id="mostPopularStat" style="display: none;">
                                    <div class="stat-value" id="mostPopular">0.0</div>
                                    <div class="stat-label">Most Popular</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <section class="content-navigation" role="tablist" aria-label="Person information sections">
            <div class="container-xl">
                <div class="nav-tabs-wrapper">
                    <button class="nav-tab active" data-tab="overview" role="tab" aria-selected="true"
                        aria-controls="overviewTab">
                        <i data-feather="user"></i>
                        <span>Overview</span>
                    </button>
                    <button class="nav-tab" data-tab="filmography" role="tab" aria-selected="false"
                        aria-controls="filmographyTab">
                        <i data-feather="film"></i>
                        <span>Filmography</span>
                    </button>
                    <button class="nav-tab" data-tab="photos" role="tab" aria-selected="false"
                        aria-controls="photosTab">
                        <i data-feather="image"></i>
                        <span>Photos</span>
                    </button>
                    <button class="nav-tab" data-tab="social" role="tab" aria-selected="false"
                        aria-controls="socialTab">
                        <i data-feather="link"></i>
                        <span>Social</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Tab Content -->
        <div class="tab-content-container">
            <!-- Overview Tab -->
            <div class="tab-pane active" id="overviewTab" role="tabpanel" aria-labelledby="overview-tab">
                <div class="container-xl">
                    <div class="overview-grid">
                        <div class="overview-main">
                            <!-- Biography -->
                            <div class="detail-card">
                                <h2 class="card-title">
                                    <i data-feather="user"></i>
                                    Biography
                                </h2>
                                <div class="biography-content" id="biographyContent">
                                    <p class="biography-text" id="biographyText" itemprop="description"></p>
                                    <button class="expand-btn" id="expandBiographyBtn" style="display: none;"
                                        aria-expanded="false">
                                        <span>Show More</span>
                                        <i data-feather="chevron-down"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Career Highlights -->
                            <div class="detail-card" id="careerHighlightsCard">
                                <h2 class="card-title">
                                    <i data-feather="award"></i>
                                    Career Highlights
                                </h2>
                                <div class="career-highlights-grid" id="careerHighlights">
                                    <!-- Career highlights will be populated by JavaScript -->
                                </div>
                                <div class="empty-state" id="noCareerHighlights" style="display: none;">
                                    <i data-feather="award"></i>
                                    <p>No career highlights available</p>
                                </div>
                            </div>
                        </div>

                        <div class="overview-sidebar">
                            <!-- Personal Information -->
                            <div class="detail-card">
                                <h3 class="card-subtitle">Personal Information</h3>
                                <div class="info-grid">
                                    <div class="info-row">
                                        <span class="info-label">Known For</span>
                                        <span class="info-value" id="knownForDepartment" itemprop="jobTitle">-</span>
                                    </div>
                                    <div class="info-row" id="birthdayRow" style="display: none;">
                                        <span class="info-label">Birthday</span>
                                        <span class="info-value" id="birthday" itemprop="birthDate">-</span>
                                    </div>
                                    <div class="info-row" id="deathdayRow" style="display: none;">
                                        <span class="info-label">Died</span>
                                        <span class="info-value" id="deathday" itemprop="deathDate">-</span>
                                    </div>
                                    <div class="info-row" id="placeOfBirthRow" style="display: none;">
                                        <span class="info-label">Place of Birth</span>
                                        <span class="info-value" id="placeOfBirth" itemprop="birthPlace">-</span>
                                    </div>
                                    <div class="info-row" id="genderRow" style="display: none;">
                                        <span class="info-label">Gender</span>
                                        <span class="info-value" id="gender" itemprop="gender">-</span>
                                    </div>
                                    <div class="info-row">
                                        <span class="info-label">Popularity</span>
                                        <span class="info-value" id="popularityScore">0.0</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Also Known As -->
                            <div class="detail-card" id="alsoKnownAsCard" style="display: none;">
                                <h3 class="card-subtitle">Also Known As</h3>
                                <div class="also-known-list" id="alsoKnownAsList" itemprop="alternateName">
                                    <!-- Alternative names will be populated by JavaScript -->
                                </div>
                            </div>

                            <!-- Quick Stats -->
                            <div class="detail-card" id="quickStatsCard">
                                <h3 class="card-subtitle">Quick Stats</h3>
                                <div class="quick-stats-grid" id="quickStats">
                                    <!-- Quick stats will be populated by JavaScript -->
                                </div>
                                <div class="empty-state" id="noQuickStats" style="display: none;">
                                    <i data-feather="bar-chart"></i>
                                    <p>No statistics available</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filmography Tab -->
            <div class="tab-pane" id="filmographyTab" role="tabpanel" aria-labelledby="filmography-tab">
                <div class="container-xl">
                    <!-- Filmography Header -->
                    <div class="section-header">
                        <h2 class="section-title">Complete Filmography</h2>
                        <p class="section-subtitle">Explore all works including upcoming projects</p>
                    </div>

                    <!-- Filmography Filter -->
                    <div class="filmography-filter">
                        <div class="filter-tabs" role="tablist" aria-label="Filter filmography by role">
                            <button class="filter-tab active" data-filter="all" role="tab"
                                aria-selected="true">All</button>
                            <button class="filter-tab" data-filter="as_actor" role="tab"
                                aria-selected="false">Acting</button>
                            <button class="filter-tab" data-filter="as_director" role="tab"
                                aria-selected="false">Directing</button>
                            <button class="filter-tab" data-filter="as_writer" role="tab"
                                aria-selected="false">Writing</button>
                            <button class="filter-tab" data-filter="as_producer" role="tab"
                                aria-selected="false">Producing</button>
                            <button class="filter-tab" data-filter="upcoming" role="tab"
                                aria-selected="false">Upcoming</button>
                        </div>
                        <div class="filter-sort">
                            <label for="filmographySort" class="visually-hidden">Sort filmography</label>
                            <select class="sort-select" id="filmographySort" aria-label="Sort filmography by">
                                <option value="year-desc">Year (Newest)</option>
                                <option value="year-asc">Year (Oldest)</option>
                                <option value="rating-desc">Rating (Highest)</option>
                                <option value="popularity-desc">Popularity (Highest)</option>
                                <option value="title-asc">Title (A-Z)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Filmography Content -->
                    <div class="filmography-content" id="filmographyContent" role="region" aria-live="polite">
                        <!-- Filmography cards will be populated by JavaScript -->
                    </div>

                    <!-- Load More Button -->
                    <div class="load-more-container" id="loadMoreContainer" style="display: none;">
                        <button class="btn-load-more" id="loadMoreBtn" aria-label="Load more filmography items">
                            <span>Load More</span>
                            <i data-feather="chevron-down"></i>
                        </button>
                    </div>

                    <!-- Empty State -->
                    <div class="empty-state" id="noFilmography" style="display: none;">
                        <i data-feather="film"></i>
                        <h3>No Filmography Available</h3>
                        <p>This person's filmography information is not currently available.</p>
                    </div>

                    <!-- Error State -->
                    <div class="error-state" id="filmographyError" style="display: none;">
                        <i data-feather="alert-circle"></i>
                        <h3>Failed to Load Filmography</h3>
                        <p>There was an error loading the filmography data.</p>
                        <button class="retry-btn" onclick="window.location.reload()">Retry</button>
                    </div>
                </div>
            </div>

            <!-- Photos Tab -->
            <div class="tab-pane" id="photosTab" role="tabpanel" aria-labelledby="photos-tab">
                <div class="container-xl">
                    <div class="detail-card" id="photosCard">
                        <h2 class="card-title">
                            <i data-feather="image"></i>
                            Photo Gallery
                        </h2>
                        <p class="card-subtitle">Click any photo to view in full size</p>
                        <div class="photos-grid" id="photosGrid" role="grid" aria-label="Photo gallery">
                            <!-- Photos will be populated by JavaScript -->
                        </div>
                        <div class="empty-state" id="noPhotos" style="display: none;">
                            <i data-feather="image"></i>
                            <h3>No Photos Available</h3>
                            <p>No photos are currently available for this person.</p>
                        </div>
                        <div class="error-state" id="photosError" style="display: none;">
                            <i data-feather="alert-circle"></i>
                            <h3>Failed to Load Photos</h3>
                            <p>There was an error loading the photo gallery.</p>
                            <button class="retry-btn" onclick="window.location.reload()">Retry</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Social Tab -->
            <div class="tab-pane" id="socialTab" role="tabpanel" aria-labelledby="social-tab">
                <div class="container-xl">
                    <div class="detail-card" id="socialCard">
                        <h2 class="card-title">
                            <i data-feather="link"></i>
                            Social Media & External Links
                        </h2>
                        <p class="card-subtitle">Connect with this person on social media platforms</p>
                        <div class="social-links-grid" id="socialLinksGrid" role="list" aria-label="Social media links">
                            <!-- Social media links will be populated by JavaScript -->
                        </div>
                        <div class="empty-state" id="noSocial" style="display: none;">
                            <i data-feather="link"></i>
                            <h3>No Social Media Links</h3>
                            <p>No social media or external links are available for this person.</p>
                        </div>
                        <div class="error-state" id="socialError" style="display: none;">
                            <i data-feather="alert-circle"></i>
                            <h3>Failed to Load Social Links</h3>
                            <p>There was an error loading the social media information.</p>
                            <button class="retry-btn" onclick="window.location.reload()">Retry</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-bottom-nav" id="mobileBottomNav">
        <div class="mobile-nav-container" id="mobileNavContainer"></div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <aside class="mobile-menu-overlay" id="mobileMenuOverlay" aria-hidden="true">
        <div class="menu-handle"></div>
        <div class="menu-header">
            <h3 class="menu-title">CineBrain Menu</h3>
            <button class="menu-close-btn" id="mobileMenuClose" aria-label="Close menu">
                <i data-feather="x"></i>
            </button>
        </div>
        <section class="menu-section">
            <h4 class="menu-section-title">Browse Categories</h4>
            <div class="mobile-menu-grid" id="mobileMenuGrid"></div>
        </section>
        <section class="menu-section">
            <h4 class="menu-section-title" id="userSectionTitle">Account</h4>
            <div class="mobile-menu-list" id="mobileMenuList"></div>
        </section>
        <footer class="menu-footer">
            <div class="menu-footer-info">
                <span class="app-version">CineBrain v2.1.0</span>
                <span class="menu-footer-separator">•</span>
                <a href="/pages/privacy.html" class="menu-footer-link">Privacy</a>
                <span class="menu-footer-separator">•</span>
                <a href="/pages/terms.html" class="menu-footer-link">Terms</a>
            </div>
        </footer>
    </aside>

    <div class="mobile-backdrop" id="mobileBackdrop" aria-hidden="true"></div>

    <!-- Share Modal -->
    <div class="modal fade" id="shareModal" tabindex="-1" aria-hidden="true" aria-labelledby="shareModalLabel">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content share-modal-content">
                <div class="modal-header share-modal-header">
                    <h5 class="modal-title" id="shareModalLabel">
                        <i data-feather="share-2"></i>
                        Share Person
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="share-options">
                        <button class="share-option-btn" id="shareWhatsApp" aria-label="Share on WhatsApp">
                            <i data-feather="message-circle"></i>
                            <span>WhatsApp</span>
                        </button>
                        <button class="share-option-btn" id="shareTwitter" aria-label="Share on Twitter">
                            <i data-feather="twitter"></i>
                            <span>Twitter</span>
                        </button>
                        <button class="share-option-btn" id="shareFacebook" aria-label="Share on Facebook">
                            <i data-feather="facebook"></i>
                            <span>Facebook</span>
                        </button>
                        <button class="share-option-btn" id="shareLinkedIn" aria-label="Share on LinkedIn">
                            <i data-feather="linkedin"></i>
                            <span>LinkedIn</span>
                        </button>
                        <button class="share-option-btn" id="copyLink" aria-label="Copy link to clipboard">
                            <i data-feather="link"></i>
                            <span>Copy Link</span>
                        </button>
                        <button class="share-option-btn" id="shareMore" aria-label="More sharing options">
                            <i data-feather="more-horizontal"></i>
                            <span>More</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Image Lightbox -->
    <div class="image-lightbox" id="imageLightbox" role="dialog" aria-modal="true" aria-labelledby="lightboxTitle">
        <button class="lightbox-close" id="closeLightbox" title="Close (ESC)" aria-label="Close lightbox">
            <i data-feather="x"></i>
        </button>
        <button class="lightbox-nav prev" id="lightboxPrev" title="Previous (← Arrow)" aria-label="Previous image">
            <i data-feather="chevron-left"></i>
        </button>
        <button class="lightbox-nav next" id="lightboxNext" title="Next (→ Arrow)" aria-label="Next image">
            <i data-feather="chevron-right"></i>
        </button>
        <div class="lightbox-content">
            <img id="lightboxImage" alt="Enlarged image">
            <div class="lightbox-loading loading-shimmer" id="lightboxLoading"></div>
        </div>
        <div class="lightbox-info" id="lightboxInfo">
            <span id="lightboxCounter" aria-live="polite">1 / 1</span>
            <span id="lightboxTitle" class="visually-hidden">Photo gallery</span>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="/assets/js/theme-manager.js"></script>
    <script src="/assets/js/topbar.js"></script>
    <script src="/assets/js/mobile-nav.js"></script>
    <script src="/assets/js/content-card.js"></script>
    <script src="/assets/js/person.js"></script>

    <!-- Schema.org structured data -->
    <script type="application/ld+json" id="personSchema">
    {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "",
        "description": "",
        "image": "",
        "jobTitle": "",
        "birthPlace": "",
        "birthDate": "",
        "deathDate": "",
        "gender": "",
        "sameAs": []
    }
    </script>
</body>

</html>

2. person.css 

/* Person Page Specific Styles */
:root {
    --person-hero-height: clamp(400px, 60vh, 600px);
    --person-hero-mobile-height: clamp(450px, 70vh, 550px);
    --person-photo-width: clamp(160px, 22vw, 220px);
    --person-photo-mobile-width: clamp(120px, 30vw, 160px);
    --filmography-card-width: clamp(140px, 20vw, 180px);
    --filmography-card-height: clamp(210px, 30vw, 270px);
    --social-card-size: clamp(60px, 12vw, 80px);
}

/* Person Hero Section */
.person-hero {
    position: relative;
    min-height: var(--person-hero-height);
    padding-top: var(--navbar-height);
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden;
    background: var(--bs-body-bg);
    top: 0;
}

@media (max-width: 767px) {
    .person-hero {
        min-height: var(--person-hero-mobile-height);
        padding-top: var(--navbar-height);
    }
}

.person-hero-layout {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: clamp(24px, 5vw, 48px);
    align-items: center;
    width: 100%;
}

@media (max-width: 767px) {
    .person-hero-layout {
        grid-template-columns: 1fr;
        gap: clamp(16px, 4vw, 24px);
        text-align: center;
    }
}

/* Person Photo Section */
.person-photo-section {
    position: relative;
    display: flex;
    justify-content: center;
}

.person-photo-card {
    position: relative;
    width: var(--person-photo-width);
}

@media (max-width: 767px) {
    .person-photo-card {
        width: var(--person-photo-mobile-width);
    }
}

.person-photo-container {
    position: relative;
    aspect-ratio: 2/3;
    border-radius: clamp(12px, 3vw, 20px);
    overflow: hidden;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
    background: var(--skeleton-bg);
}

.person-photo-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center top;
    opacity: 0;
    transition: opacity 0.4s ease;
}

.person-photo-img.loaded {
    opacity: 1;
}

.photo-shimmer {
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg,
            var(--skeleton-bg) 0%,
            var(--skeleton-shine) 50%,
            var(--skeleton-bg) 100%);
    background-size: 200% 100%;
    animation: shimmer 1.2s infinite;
}

.person-photo-img.loaded+.photo-shimmer {
    display: none;
}

.person-badges {
    position: absolute;
    top: 8px;
    right: 8px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    z-index: var(--z-overlay);
}

.department-badge {
    padding: 4px 8px;
    background: var(--cinebrain-primary);
    color: white;
    border-radius: 4px;
    font-size: clamp(9px, 2vw, 11px);
    font-weight: 700;
    letter-spacing: 0.3px;
    text-transform: uppercase;
}

/* Person Info Section */
.person-info-section {
    display: flex;
    flex-direction: column;
    gap: clamp(16px, 3vw, 24px);
    min-width: 0;
}

.person-title-block {
    animation: fadeInUp 0.5s ease-out;
}

.person-name {
    font-size: var(--title-size);
    font-weight: 700;
    line-height: 1.1;
    color: var(--text-primary);
    margin-bottom: 6px;
    letter-spacing: -0.01em;
    word-wrap: break-word;
}

.person-subtitle {
    font-size: var(--subtitle-size);
    color: var(--text-secondary);
    font-style: italic;
    opacity: 0.8;
}

.person-meta-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    animation: fadeInUp 0.6s ease-out;
}

@media (max-width: 767px) {
    .person-meta-pills {
        justify-content: center;
    }
}

.person-bio-preview {
    font-size: var(--body-size);
    line-height: 1.5;
    color: var(--text-secondary);
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    animation: fadeInUp 0.8s ease-out;
}

@media (max-width: 767px) {
    .person-bio-preview {
        text-align: center;
    }
}

.person-stats-bar {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
    gap: 12px;
    padding: 12px;
    background: var(--menu-item-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 10px;
    animation: fadeInUp 1s ease-out;
}

@media (max-width: 767px) {
    .person-stats-bar {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* Biography Content */
.biography-content {
    position: relative;
}

.biography-text {
    font-size: var(--body-size);
    line-height: 1.6;
    color: var(--text-secondary);
    max-height: 200px;
    overflow: hidden;
    transition: max-height 0.4s ease;
}

.biography-text.expanded {
    max-height: none;
}

/* Career Highlights */
.career-highlights-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 16px;
}

.career-highlight-item {
    background: var(--menu-item-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 10px;
    padding: 16px;
    text-align: center;
    transition: all 0.2s ease;
}

.career-highlight-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.highlight-icon {
    width: 32px;
    height: 32px;
    margin: 0 auto 8px;
    color: var(--cinebrain-primary);
}

.highlight-title {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
    font-size: var(--small-size);
}

.highlight-value {
    color: var(--text-secondary);
    font-size: var(--small-size);
}

/* Also Known As */
.also-known-list {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.also-known-item {
    padding: 6px 10px;
    background: var(--menu-item-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 8px;
    font-size: var(--small-size);
    color: var(--text-primary);
}

/* Quick Stats */
.quick-stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
}

.quick-stat-item {
    text-align: center;
    padding: 8px;
    background: var(--menu-item-bg);
    border-radius: 6px;
}

.quick-stat-value {
    font-weight: 700;
    color: var(--text-primary);
    font-size: var(--body-size);
}

.quick-stat-label {
    font-size: var(--small-size);
    color: var(--text-secondary);
    margin-top: 2px;
}

/* Filmography Section */
.filmography-filter {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    gap: 16px;
    flex-wrap: wrap;
}

@media (max-width: 767px) {
    .filmography-filter {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
    }
}

.filter-tabs {
    display: flex;
    gap: 4px;
    overflow-x: auto;
    scrollbar-width: none;
    -webkit-overflow-scrolling: touch;
}

.filter-tabs::-webkit-scrollbar {
    display: none;
}

.filter-tab {
    flex-shrink: 0;
    padding: 8px 16px;
    background: var(--menu-item-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 16px;
    color: var(--text-secondary);
    font-size: var(--small-size);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
}

.filter-tab.active {
    background: var(--cinebrain-primary);
    color: white;
    border-color: var(--cinebrain-primary);
}

.filter-tab:hover:not(.active) {
    background: var(--menu-item-hover);
    color: var(--text-primary);
}

.filter-sort {
    min-width: 150px;
}

.sort-select {
    width: 100%;
    padding: 8px 12px;
    background: var(--menu-item-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 8px;
    color: var(--text-primary);
    font-size: var(--small-size);
    cursor: pointer;
}

.sort-select:focus {
    outline: 2px solid var(--cinebrain-primary);
    outline-offset: 2px;
}

/* Filmography Content */
.filmography-content {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(var(--filmography-card-width), 1fr));
    gap: clamp(12px, 3vw, 20px);
    margin-bottom: 20px;
}

.filmography-card {
    background: var(--card-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s ease;
    height: var(--filmography-card-height);
    display: flex;
    flex-direction: column;
}

.filmography-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.filmography-poster {
    width: 100%;
    height: 65%;
    object-fit: cover;
    background: var(--skeleton-bg);
}

.filmography-info {
    padding: 8px;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.filmography-title {
    font-weight: 600;
    font-size: var(--small-size);
    color: var(--text-primary);
    line-height: 1.2;
    margin-bottom: 2px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.filmography-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: auto;
}

.filmography-year {
    font-size: var(--small-size);
    color: var(--text-secondary);
}

.filmography-role {
    font-size: var(--small-size);
    color: var(--cinebrain-primary);
    font-weight: 500;
}

.filmography-rating {
    display: flex;
    align-items: center;
    gap: 2px;
    font-size: var(--small-size);
    color: var(--text-primary);
}

.filmography-rating svg {
    width: 12px;
    height: 12px;
    fill: var(--rating-star-color);
}

/* Load More Button */
.load-more-container {
    text-align: center;
    margin-top: 20px;
}

.btn-load-more {
    padding: 12px 24px;
    background: var(--menu-item-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 8px;
    color: var(--text-primary);
    font-size: var(--body-size);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-load-more:hover {
    background: var(--menu-item-hover);
    transform: translateY(-1px);
}

.btn-load-more:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

/* Photos Grid */
.photos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 12px;
    margin-bottom: 20px;
}

@media (max-width: 767px) {
    .photos-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 8px;
    }
}

.photo-card {
    aspect-ratio: 2/3;
    background: var(--skeleton-bg);
    border-radius: 8px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

.photo-card:hover {
    transform: scale(1.03);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.photo-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Social Links Grid */
.social-links-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 16px;
}

.social-link-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 16px;
    background: var(--menu-item-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 12px;
    text-decoration: none;
    color: var(--text-primary);
    transition: all 0.2s ease;
    cursor: pointer;
}

.social-link-card:hover {
    background: var(--menu-item-hover);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    color: var(--text-primary);
    text-decoration: none;
}

.social-icon {
    width: var(--social-card-size);
    height: var(--social-card-size);
    border-radius: 50%;
    background: var(--cinebrain-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
}

.social-icon svg {
    width: 24px;
    height: 24px;
}

.social-name {
    font-weight: 600;
    font-size: var(--small-size);
    text-align: center;
}

.social-handle {
    font-size: var(--small-size);
    color: var(--text-secondary);
    text-align: center;
}

/* Platform-specific colors */
.social-link-card[data-platform="twitter"]:hover .social-icon {
    background: #1DA1F2;
}

.social-link-card[data-platform="instagram"]:hover .social-icon {
    background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
}

.social-link-card[data-platform="facebook"]:hover .social-icon {
    background: #1877F2;
}

.social-link-card[data-platform="imdb"]:hover .social-icon {
    background: #F5C518;
    color: black;
}

.social-link-card[data-platform="tiktok"]:hover .social-icon {
    background: #000000;
}

.social-link-card[data-platform="youtube"]:hover .social-icon {
    background: #FF0000;
}

/* Year Navigation for Filmography */
.year-navigation {
    display: flex;
    gap: 8px;
    margin-bottom: 16px;
    overflow-x: auto;
    scrollbar-width: none;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 4px;
}

.year-navigation::-webkit-scrollbar {
    display: none;
}

.year-btn {
    flex-shrink: 0;
    padding: 6px 12px;
    background: var(--menu-item-bg);
    border: 1px solid var(--nav-button-border);
    border-radius: 16px;
    color: var(--text-secondary);
    font-size: var(--small-size);
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
}

.year-btn.active {
    background: var(--cinebrain-primary);
    color: white;
    border-color: var(--cinebrain-primary);
}

.year-btn:hover:not(.active) {
    background: var(--menu-item-hover);
    color: var(--text-primary);
}

/* Mobile Responsive Adjustments */
@media (max-width: 767px) {
    .person-info-section {
        text-align: center;
    }

    .person-meta-pills {
        justify-content: center;
    }

    .person-bio-preview {
        text-align: center;
    }

    .person-stats-bar {
        grid-template-columns: repeat(2, 1fr);
    }

    .filmography-filter {
        flex-direction: column;
        align-items: stretch;
    }

    .filter-tabs {
        justify-content: center;
    }

    .filmography-content {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 12px;
    }

    .photos-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
    }

    .social-links-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
    }
}

/* Print Styles */
@media print {

    .navbar-cinebrain,
    .mobile-bottom-nav,
    .content-navigation,
    .btn-primary-action,
    .action-buttons-group,
    .mobile-action-bar {
        display: none !important;
    }

    .person-hero {
        min-height: auto;
        margin-top: 0;
    }

    .hero-backdrop-container {
        display: none;
    }
}

/* Accessibility */
.btn-primary-action:focus-visible,
.btn-circle-action:focus-visible,
.nav-tab:focus-visible,
.expand-btn:focus-visible,
.filter-tab:focus-visible,
.filmography-card:focus-visible,
.photo-card:focus-visible,
.social-link-card:focus-visible {
    outline: 2px solid var(--cinebrain-primary);
    outline-offset: 2px;
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {

    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* Smooth Animations */
.filmography-card,
.photo-card,
.social-link-card,
.career-highlight-item {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.filmography-card:hover,
.photo-card:hover,
.social-link-card:hover,
.career-highlight-item:hover {
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
}

3. person.js

class PersonPage {
    constructor() {
        this.apiBase = 'https://backend-app-970m.onrender.com/api';
        this.personSlug = this.getPersonSlugFromUrl();
        this.personData = null;
        this.authToken = localStorage.getItem('cinebrain-token');
        this.isAuthenticated = !!this.authToken;
        this.currentTab = 'overview';
        this.currentFilter = 'all';
        this.currentSort = 'year-desc';
        this.currentImageIndex = 0;
        this.currentImageSet = [];
        this.filmographyData = null;
        this.filteredFilmography = [];
        this.displayedCount = 20;
        this.setupSmoothScrolling();
        this.init();
    }

    setupSmoothScrolling() {
        if (!CSS.supports('scroll-behavior', 'smooth')) {
            const style = document.createElement('style');
            style.textContent = `* { scroll-behavior: smooth !important; }`;
            document.head.appendChild(style);
        }
    }

    getPersonSlugFromUrl() {
        const queryString = window.location.search.substring(1);
        return decodeURIComponent(queryString);
    }

    async init() {
        try {
            if (!this.personSlug) {
                this.showError('No person specified');
                this.hideLoader();
                return;
            }

            await this.loadPersonDetails();
            this.setupEventListeners();
            this.setupTabNavigation();
            this.setupModals();

            if (typeof feather !== 'undefined') {
                feather.replace();
            }

            this.hideLoader();

        } catch (error) {
            console.error('Initialization error:', error);
            this.showError(error.message);
            this.hideLoader();
        }
    }

    async loadPersonDetails() {
        const url = `${this.apiBase}/person/${encodeURIComponent(this.personSlug)}`;

        try {
            const response = await fetch(url, {
                headers: {
                    'Accept': 'application/json',
                    ...(this.authToken && { 'Authorization': `Bearer ${this.authToken}` })
                }
            });

            if (!response.ok) {
                throw new Error(`Failed to load person (${response.status})`);
            }

            this.personData = await response.json();
            this.filmographyData = this.personData.filmography;
            await this.renderPerson();

        } catch (error) {
            console.error('Error loading person:', error);
            throw error;
        }
    }

    async renderPerson() {
        const data = this.personData;
        if (!data) return;

        this.updatePageMeta(data);
        this.renderHero(data);
        this.renderOverview(data);
        this.renderFilmography(data.filmography);
        this.renderPhotos(data.images);
        this.renderSocial(data.social_media);

        if (typeof feather !== 'undefined') {
            feather.replace();
        }
    }

    updatePageMeta(data) {
        const title = `${data.name || 'Person'} - CineBrain`;
        const description = data.biography ?
            data.biography.substring(0, 160) + '...' :
            `Learn about ${data.name}, ${data.known_for_department || 'entertainment professional'} on CineBrain.`;

        document.title = title;

        this.updateMetaTag('meta-title', 'content', title);
        this.updateMetaTag('meta-description', 'content', description);
        this.updateMetaTag('og-title', 'content', title);
        this.updateMetaTag('og-description', 'content', description);

        if (data.profile_path) {
            this.updateMetaTag('og-image', 'content', data.profile_path);
        }

        const canonicalUrl = window.location.href;
        this.updateMetaTag('canonical-url', 'href', canonicalUrl);
        this.updateMetaTag('og-url', 'content', canonicalUrl);
    }

    updateMetaTag(id, attribute, value) {
        const element = document.getElementById(id);
        if (element) {
            element.setAttribute(attribute, value);
        }
    }

    renderHero(data) {
        // Set backdrop if available
        if (data.profile_path) {
            const backdrop = document.getElementById('heroBackdrop');
            if (backdrop) {
                backdrop.style.backgroundImage = `url(${data.profile_path})`;
                backdrop.style.filter = 'blur(20px) brightness(0.3)';
            }
        }

        // Person photo
        const photo = document.getElementById('personPhoto');
        if (photo && data.profile_path) {
            const img = new Image();
            img.onload = () => {
                photo.src = img.src;
                photo.classList.add('loaded');
            };
            img.onerror = () => {
                photo.src = this.getPlaceholderAvatar();
                photo.classList.add('loaded');
            };
            img.src = data.profile_path;
            photo.alt = data.name || 'Person Photo';
        }

        // Department badge
        const departmentBadge = document.getElementById('departmentBadge');
        if (departmentBadge) {
            departmentBadge.textContent = (data.known_for_department || 'ACTOR').toUpperCase();
        }

        // Name and known for
        this.updateElement('personName', data.name);
        this.updateElement('knownFor', data.known_for_department || 'Actor');

        // Meta pills with enhanced info
        if (data.personal_info?.age) {
            const ageElement = document.getElementById('personAge');
            if (ageElement) {
                ageElement.style.display = 'inline-flex';
                ageElement.querySelector('span').textContent = `Age: ${data.personal_info.age}`;
            }
        }

        const totalWorksSpan = document.querySelector('#totalWorks span');
        if (totalWorksSpan) {
            const total = data.total_works || 0;
            const upcomingCount = data.upcoming_projects_count || 0;
            totalWorksSpan.textContent = upcomingCount > 0 ?
                `${total} Works (${upcomingCount} Upcoming)` :
                `${total} Works`;
        }

        const popularitySpan = document.querySelector('#personPopularity span');
        if (popularitySpan) {
            popularitySpan.textContent = Number(data.popularity || 0).toFixed(1);
        }

        if (data.place_of_birth) {
            const birthPlaceElement = document.getElementById('birthPlace');
            if (birthPlaceElement) {
                birthPlaceElement.style.display = 'inline-flex';
                birthPlaceElement.querySelector('span').textContent = this.truncateText(data.place_of_birth, 20);
            }
        }

        // Bio preview
        const bioPreview = document.getElementById('bioPreview');
        if (bioPreview) {
            const bio = data.biography || 'No biography available.';
            bioPreview.textContent = bio.substring(0, 200) + (bio.length > 200 ? '...' : '');
        }

        // Enhanced stats bar
        this.updateElement('yearsActive', data.personal_info?.career_span ||
            (data.filmography?.statistics?.years_active ? `${data.filmography.statistics.years_active} years` : '0'));

        this.updateElement('totalProjects', data.filmography?.statistics?.total_projects || '0');

        if (data.filmography?.statistics?.highest_rated) {
            document.getElementById('highestRatedStat').style.display = 'block';
            this.updateElement('highestRated', data.filmography.statistics.highest_rated.rating?.toFixed(1) || 'N/A');
        }

        if (data.filmography?.statistics?.most_popular) {
            document.getElementById('mostPopularStat').style.display = 'block';
            this.updateElement('mostPopular', Math.round(data.filmography.statistics.most_popular.popularity || 0));
        }
    }

    renderOverview(data) {
        // Biography
        const biographyText = document.getElementById('biographyText');
        const expandBtn = document.getElementById('expandBiographyBtn');

        if (biographyText) {
            const bio = data.biography || 'No biography available.';
            biographyText.textContent = bio;

            if (bio.length > 500) {
                expandBtn.style.display = 'inline-flex';
            }
        }

        // Enhanced Personal Information
        this.updateElement('knownForDepartment', data.known_for_department || 'Unknown');

        if (data.birthday) {
            document.getElementById('birthdayRow').style.display = 'flex';
            this.updateElement('birthday', this.formatDate(data.birthday));

            // Add age if available
            if (data.personal_info?.age) {
                const birthdayElement = document.getElementById('birthday');
                if (birthdayElement) {
                    birthdayElement.textContent += ` (Age ${data.personal_info.age})`;
                }
            }
        }

        if (data.deathday) {
            document.getElementById('deathdayRow').style.display = 'flex';
            this.updateElement('deathday', this.formatDate(data.deathday));

            // Add age at death if available
            if (data.personal_info?.age_at_death) {
                const deathdayElement = document.getElementById('deathday');
                if (deathdayElement) {
                    deathdayElement.textContent += ` (Age ${data.personal_info.age_at_death})`;
                }
            }
        }

        if (data.place_of_birth) {
            document.getElementById('placeOfBirthRow').style.display = 'flex';
            this.updateElement('placeOfBirth', data.place_of_birth);
        }

        if (data.gender) {
            document.getElementById('genderRow').style.display = 'flex';
            this.updateElement('gender', this.getGenderText(data.gender));
        }

        this.updateElement('popularityScore', Number(data.popularity || 0).toFixed(1));

        // Also Known As
        if (data.also_known_as && data.also_known_as.length > 0) {
            const card = document.getElementById('alsoKnownAsCard');
            const list = document.getElementById('alsoKnownAsList');

            if (card && list) {
                card.style.display = 'block';
                list.innerHTML = data.also_known_as.slice(0, 8).map(name => `
                    <div class="also-known-item">${this.escapeHtml(name)}</div>
                `).join('');
            }
        }

        // Enhanced Career Highlights
        this.renderCareerHighlights(data.career_highlights, data.filmography?.statistics);

        // Quick Stats with upcoming info
        this.renderQuickStats(data);
    }

    renderCareerHighlights(highlights, statistics) {
        const container = document.getElementById('careerHighlights');
        if (!container) return;

        const highlightItems = [];

        // Career span or debut
        if (this.personData.personal_info?.career_span) {
            highlightItems.push({
                icon: 'calendar',
                title: 'Career Span',
                value: this.personData.personal_info.career_span
            });
        } else if (highlights?.debut_work || statistics?.debut_year) {
            highlightItems.push({
                icon: 'calendar',
                title: 'Career Debut',
                value: highlights?.debut_work?.title || statistics?.debut_year || 'N/A'
            });
        }

        // Most successful decade
        if (highlights?.most_successful_decade) {
            const decade = highlights.most_successful_decade;
            highlightItems.push({
                icon: 'trending-up',
                title: 'Most Active',
                value: typeof decade === 'object' ?
                    `${decade.decade} (${decade.projects} projects)` :
                    decade
            });
        }

        // Highest rated work
        if (statistics?.highest_rated) {
            highlightItems.push({
                icon: 'star',
                title: 'Highest Rated',
                value: `${statistics.highest_rated.title} (${statistics.highest_rated.rating?.toFixed(1)})`
            });
        }

        // Most popular work
        if (statistics?.most_popular) {
            highlightItems.push({
                icon: 'award',
                title: 'Most Popular',
                value: statistics.most_popular.title || 'N/A'
            });
        }

        // Upcoming projects
        if (this.personData.upcoming_projects_count > 0) {
            highlightItems.push({
                icon: 'clock',
                title: 'Upcoming Projects',
                value: `${this.personData.upcoming_projects_count} projects`
            });
        }

        if (highlightItems.length > 0) {
            container.innerHTML = highlightItems.slice(0, 6).map(item => `
                <div class="career-highlight-item">
                    <i data-feather="${item.icon}" class="highlight-icon"></i>
                    <div class="highlight-title">${item.title}</div>
                    <div class="highlight-value">${this.escapeHtml(item.value)}</div>
                </div>
            `).join('');

            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        }
    }

    renderQuickStats(data) {
        const container = document.getElementById('quickStats');
        if (!container) return;

        const stats = [];

        if (data.filmography) {
            const actingCount = data.filmography.as_actor?.length || 0;
            const directingCount = data.filmography.as_director?.length || 0;
            const writingCount = data.filmography.as_writer?.length || 0;
            const producingCount = data.filmography.as_producer?.length || 0;
            const upcomingCount = data.filmography.upcoming?.length || 0;

            if (actingCount > 0) {
                stats.push({ label: 'Acting', value: actingCount });
            }
            if (directingCount > 0) {
                stats.push({ label: 'Directing', value: directingCount });
            }
            if (writingCount > 0) {
                stats.push({ label: 'Writing', value: writingCount });
            }
            if (producingCount > 0) {
                stats.push({ label: 'Producing', value: producingCount });
            }
            if (upcomingCount > 0) {
                stats.push({ label: 'Upcoming', value: upcomingCount, highlight: true });
            }
        }

        if (stats.length > 0) {
            container.innerHTML = stats.slice(0, 5).map(stat => `
                <div class="quick-stat-item ${stat.highlight ? 'highlight' : ''}">
                    <div class="quick-stat-value">${stat.value}</div>
                    <div class="quick-stat-label">${stat.label}</div>
                </div>
            `).join('');
        }
    }

    renderFilmography(filmography) {
        if (!filmography) {
            document.getElementById('noFilmography').style.display = 'flex';
            return;
        }

        // Update filter tabs to show counts
        this.updateFilterTabCounts(filmography);
        this.applyFilmographyFilter();
    }

    updateFilterTabCounts(filmography) {
        const filterCounts = {
            'all': 0,
            'as_actor': filmography.as_actor?.length || 0,
            'as_director': filmography.as_director?.length || 0,
            'as_writer': filmography.as_writer?.length || 0,
            'as_producer': filmography.as_producer?.length || 0,
            'upcoming': filmography.upcoming?.length || 0
        };

        // Calculate total for 'all'
        Object.keys(filterCounts).forEach(key => {
            if (key !== 'all' && key !== 'upcoming') {
                filterCounts.all += filterCounts[key];
            }
        });

        // Update tab text with counts
        document.querySelectorAll('.filter-tab').forEach(tab => {
            const filter = tab.dataset.filter;
            const count = filterCounts[filter] || 0;
            const originalText = tab.textContent.split(' (')[0]; // Remove existing count

            if (count > 0) {
                tab.textContent = `${originalText} (${count})`;
                tab.style.display = 'block';
            } else if (filter === 'upcoming') {
                tab.style.display = 'none'; // Hide upcoming tab if no upcoming projects
            }
        });
    }

    applyFilmographyFilter() {
        const container = document.getElementById('filmographyContent');
        const noFilmography = document.getElementById('noFilmography');

        if (!container || !this.filmographyData) return;

        // Get all works based on current filter
        let allWorks = [];

        if (this.currentFilter === 'all') {
            // Include all categories except upcoming for 'all' filter
            Object.keys(this.filmographyData).forEach(key => {
                if (key.startsWith('as_') && Array.isArray(this.filmographyData[key])) {
                    this.filmographyData[key].forEach(work => {
                        allWorks.push({
                            ...work,
                            role_type: key.replace('as_', '')
                        });
                    });
                }
            });
        } else if (this.currentFilter === 'upcoming') {
            // Handle upcoming projects specially
            if (this.filmographyData.upcoming && Array.isArray(this.filmographyData.upcoming)) {
                allWorks = this.filmographyData.upcoming.map(work => ({
                    ...work,
                    role_type: work.role_type || 'upcoming'
                }));
            }
        } else {
            // Handle specific role filters
            const filterKey = this.currentFilter;
            if (this.filmographyData[filterKey] && Array.isArray(this.filmographyData[filterKey])) {
                allWorks = this.filmographyData[filterKey].map(work => ({
                    ...work,
                    role_type: filterKey.replace('as_', '')
                }));
            }
        }

        // Sort works
        allWorks.sort((a, b) => {
            switch (this.currentSort) {
                case 'year-desc':
                    // For upcoming, prioritize by release date, then by year
                    if (this.currentFilter === 'upcoming') {
                        const dateA = a.release_date || '9999-12-31';
                        const dateB = b.release_date || '9999-12-31';
                        return dateA.localeCompare(dateB);
                    }
                    return (b.year || 0) - (a.year || 0);
                case 'year-asc':
                    return (a.year || 0) - (b.year || 0);
                case 'rating-desc':
                    return (b.rating || 0) - (a.rating || 0);
                case 'popularity-desc':
                    return (b.popularity || 0) - (a.popularity || 0);
                case 'title-asc':
                    return (a.title || '').localeCompare(b.title || '');
                default:
                    return 0;
            }
        });

        this.filteredFilmography = allWorks;

        if (allWorks.length === 0) {
            container.innerHTML = '';
            noFilmography.style.display = 'flex';
            document.getElementById('loadMoreContainer').style.display = 'none';
            return;
        }

        noFilmography.style.display = 'none';
        this.renderFilmographyCards();
    }

    renderFilmographyCards() {
        const container = document.getElementById('filmographyContent');
        const loadMoreContainer = document.getElementById('loadMoreContainer');

        if (!container) return;

        const worksToShow = this.filteredFilmography.slice(0, this.displayedCount);

        container.innerHTML = worksToShow.map(work => {
            const isUpcoming = work.status === 'Upcoming' || this.currentFilter === 'upcoming';
            const releaseInfo = this.getWorkReleaseInfo(work, isUpcoming);

            return `
                <div class="filmography-card ${isUpcoming ? 'upcoming' : ''}" 
                     data-content-slug="${work.slug || ''}" 
                     data-tmdb-id="${work.tmdb_id || ''}"
                     tabindex="0" 
                     role="button">
                    <img class="filmography-poster" 
                         src="${this.formatPosterUrl(work.poster_path)}" 
                         alt="${this.escapeHtml(work.title)}"
                         loading="lazy">
                    ${isUpcoming ? '<div class="upcoming-badge">Upcoming</div>' : ''}
                    <div class="filmography-info">
                        <div class="filmography-title">${this.escapeHtml(work.title)}</div>
                        <div class="filmography-meta">
                            <span class="filmography-year">${releaseInfo}</span>
                            ${work.rating && work.rating > 0 ? `
                                <div class="filmography-rating">
                                    <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                                    <span>${work.rating.toFixed(1)}</span>
                                </div>
                            ` : ''}
                        </div>
                        <div class="filmography-role">${this.getRoleText(work)}</div>
                        ${work.overview && work.overview.length > 0 ? `
                            <div class="filmography-overview">${this.truncateText(work.overview, 100)}</div>
                        ` : ''}
                    </div>
                </div>
            `;
        }).join('');

        // Show/hide load more button
        if (this.filteredFilmography.length > this.displayedCount) {
            loadMoreContainer.style.display = 'block';
        } else {
            loadMoreContainer.style.display = 'none';
        }

        // Add click handlers
        container.querySelectorAll('.filmography-card').forEach(card => {
            const clickHandler = () => {
                card.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    card.style.transform = '';
                    const slug = card.dataset.contentSlug;
                    const tmdbId = card.dataset.tmdbId;

                    if (slug) {
                        window.location.href = `/content/details.html?${encodeURIComponent(slug)}`;
                    } else if (tmdbId) {
                        // For upcoming content that might not have a slug yet
                        this.showToast('This content is not yet available for viewing', 'info');
                    }
                }, 100);
            };

            card.addEventListener('click', clickHandler);
            card.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    clickHandler();
                }
            });
        });
    }

    getWorkReleaseInfo(work, isUpcoming) {
        if (isUpcoming && work.release_date) {
            try {
                const releaseDate = new Date(work.release_date);
                const now = new Date();

                if (releaseDate > now) {
                    return releaseDate.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    });
                }
            } catch (e) {
                // Fall through to default handling
            }
        }

        return work.year || 'TBA';
    }

    getRoleText(work) {
        if (work.character) {
            return `as ${work.character}`;
        } else if (work.job) {
            return work.job;
        } else {
            return work.role_type?.charAt(0).toUpperCase() + work.role_type?.slice(1) || 'Unknown';
        }
    }

    renderPhotos(images) {
        const container = document.getElementById('photosGrid');
        const noPhotos = document.getElementById('noPhotos');

        if (!container) return;

        if (!images || images.length === 0) {
            container.innerHTML = '';
            noPhotos.style.display = 'flex';
            return;
        }

        noPhotos.style.display = 'none';
        this.currentImageSet = images;

        container.innerHTML = images.map((image, index) => {
            const imageUrl = image.url || image;
            return `
                <div class="photo-card" 
                     data-image-url="${imageUrl}" 
                     data-image-index="${index}"
                     tabindex="0" 
                     role="button"
                     title="Click to view full size">
                    <img src="${imageUrl}" 
                         alt="Photo ${index + 1}"
                         loading="lazy">
                </div>
            `;
        }).join('');

        // Add click handlers for lightbox
        container.querySelectorAll('.photo-card').forEach((card, index) => {
            const clickHandler = () => {
                card.style.transform = 'scale(0.98)';
                setTimeout(() => {
                    card.style.transform = '';
                    this.openLightbox(index);
                }, 100);
            };

            card.addEventListener('click', clickHandler);
            card.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    clickHandler();
                }
            });
        });
    }

    renderSocial(socialMedia) {
        const container = document.getElementById('socialLinksGrid');
        const noSocial = document.getElementById('noSocial');

        if (!container) return;

        if (!socialMedia || Object.keys(socialMedia).length === 0) {
            container.innerHTML = '';
            noSocial.style.display = 'flex';
            return;
        }

        noSocial.style.display = 'none';

        const socialLinks = [];

        // Handle the new backend format with enhanced data structure
        Object.entries(socialMedia).forEach(([platform, data]) => {
            if (data && typeof data === 'object' && data.url) {
                // New format: { url, handle, platform }
                const platformInfo = this.getSocialPlatformInfo(platform, data);
                if (platformInfo) {
                    socialLinks.push(platformInfo);
                }
            } else if (typeof data === 'string' && data.startsWith('http')) {
                // Fallback for old format: direct URL string
                const platformInfo = this.getSocialPlatformInfo(platform, { url: data });
                if (platformInfo) {
                    socialLinks.push(platformInfo);
                }
            }
        });

        if (socialLinks.length === 0) {
            noSocial.style.display = 'flex';
            return;
        }

        // Sort social links by platform priority
        const platformPriority = ['instagram', 'twitter', 'x', 'facebook', 'tiktok', 'youtube', 'imdb'];
        socialLinks.sort((a, b) => {
            const aIndex = platformPriority.indexOf(a.platform.toLowerCase());
            const bIndex = platformPriority.indexOf(b.platform.toLowerCase());
            if (aIndex === -1 && bIndex === -1) return 0;
            if (aIndex === -1) return 1;
            if (bIndex === -1) return -1;
            return aIndex - bIndex;
        });

        container.innerHTML = socialLinks.map(link => `
            <a href="${link.url}" 
               target="_blank" 
               rel="noopener noreferrer" 
               class="social-link-card"
               data-platform="${link.platform}"
               title="Follow on ${link.name}">
                <div class="social-icon ${link.platform}">
                    <i data-feather="${link.icon}"></i>
                </div>
                <div class="social-info">
                    <div class="social-name">${link.name}</div>
                    <div class="social-handle">${link.handle}</div>
                </div>
                <div class="social-arrow">
                    <i data-feather="external-link"></i>
                </div>
            </a>
        `).join('');

        if (typeof feather !== 'undefined') {
            feather.replace();
        }
    }

    getSocialPlatformInfo(platform, data) {
        const platformLower = platform.toLowerCase();
        const url = typeof data === 'string' ? data : data.url;
        const handle = data.handle || this.extractHandle(url, platform);
        const platformName = data.platform || platform;

        if (!url) return null;

        switch (platformLower) {
            case 'twitter':
            case 'x':
                return {
                    platform: 'twitter',
                    name: platformName || 'Twitter',
                    icon: 'twitter',
                    url: url,
                    handle: handle || this.extractHandle(url, 'twitter.com/')
                };
            case 'instagram':
                return {
                    platform: 'instagram',
                    name: platformName || 'Instagram',
                    icon: 'instagram',
                    url: url,
                    handle: handle || this.extractHandle(url, 'instagram.com/')
                };
            case 'facebook':
                return {
                    platform: 'facebook',
                    name: platformName || 'Facebook',
                    icon: 'facebook',
                    url: url,
                    handle: handle || this.extractHandle(url, 'facebook.com/')
                };
            case 'imdb':
                return {
                    platform: 'imdb',
                    name: platformName || 'IMDb',
                    icon: 'film',
                    url: url,
                    handle: handle || 'View Profile'
                };
            case 'tiktok':
                return {
                    platform: 'tiktok',
                    name: platformName || 'TikTok',
                    icon: 'music',
                    url: url,
                    handle: handle || this.extractHandle(url, 'tiktok.com/@')
                };
            case 'youtube':
                return {
                    platform: 'youtube',
                    name: platformName || 'YouTube',
                    icon: 'youtube',
                    url: url,
                    handle: handle || 'View Channel'
                };
            case 'wikidata':
                return {
                    platform: 'wikidata',
                    name: platformName || 'Wikidata',
                    icon: 'external-link',
                    url: url,
                    handle: handle || 'View Entry'
                };
            default:
                return {
                    platform: 'external',
                    name: platformName || platform.charAt(0).toUpperCase() + platform.slice(1),
                    icon: 'external-link',
                    url: url,
                    handle: handle || 'Visit Link'
                };
        }
    }

    extractHandle(url, pattern) {
        try {
            if (typeof pattern === 'string') {
                const match = url.match(new RegExp(pattern + '([^/?]+)'));
                return match ? '@' + match[1] : 'Visit Profile';
            }

            // Extract username from various social media URL patterns
            const patterns = [
                /(?:twitter\.com|x\.com)\/([^/?]+)/,
                /instagram\.com\/([^/?]+)/,
                /facebook\.com\/([^/?]+)/,
                /tiktok\.com\/@([^/?]+)/,
                /youtube\.com\/(?:channel\/|user\/|c\/)?([^/?]+)/
            ];

            for (const regex of patterns) {
                const match = url.match(regex);
                if (match && match[1]) {
                    return match[1].startsWith('@') ? match[1] : '@' + match[1];
                }
            }

            return 'Visit Profile';
        } catch {
            return 'Visit Profile';
        }
    }

    setupEventListeners() {
        // View Filmography button
        const viewFilmographyBtn = document.getElementById('viewFilmographyBtn');
        if (viewFilmographyBtn) {
            viewFilmographyBtn.addEventListener('click', () => {
                document.querySelector('[data-tab="filmography"]').click();
            });
        }

        // Share buttons
        ['shareBtn', 'mobileShareBtn'].forEach(id => {
            const btn = document.getElementById(id);
            if (btn) {
                btn.addEventListener('click', () => this.openShareModal());
            }
        });

        // Follow buttons (placeholder functionality)
        ['followBtn', 'mobileFollowBtn'].forEach(id => {
            const btn = document.getElementById(id);
            if (btn) {
                btn.addEventListener('click', () => {
                    this.showToast('Follow feature coming soon!', 'info');
                });
            }
        });

        // Biography expand button
        const expandBiographyBtn = document.getElementById('expandBiographyBtn');
        if (expandBiographyBtn) {
            expandBiographyBtn.addEventListener('click', () => {
                const biographyText = document.getElementById('biographyText');
                const isExpanded = biographyText.classList.contains('expanded');

                biographyText.classList.toggle('expanded');
                expandBiographyBtn.classList.toggle('expanded');
                expandBiographyBtn.querySelector('span').textContent = isExpanded ? 'Show More' : 'Show Less';

                if (!isExpanded) {
                    setTimeout(() => {
                        biographyText.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }, 200);
                }
            });
        }

        // Enhanced Filmography filters
        document.querySelectorAll('.filter-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                this.currentFilter = tab.dataset.filter;
                this.displayedCount = 20;
                this.applyFilmographyFilter();
            });
        });

        // Filmography sort
        const sortSelect = document.getElementById('filmographySort');
        if (sortSelect) {
            sortSelect.addEventListener('change', () => {
                this.currentSort = sortSelect.value;
                this.displayedCount = 20;
                this.applyFilmographyFilter();
            });
        }

        // Load more button
        const loadMoreBtn = document.getElementById('loadMoreBtn');
        if (loadMoreBtn) {
            loadMoreBtn.addEventListener('click', () => {
                this.displayedCount += 20;
                this.renderFilmographyCards();
            });
        }
    }

    setupTabNavigation() {
        const tabs = document.querySelectorAll('.nav-tab');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const targetTab = tab.dataset.tab;

                const currentPane = document.querySelector('.tab-pane.active');
                if (currentPane) {
                    currentPane.style.opacity = '0';
                    setTimeout(() => {
                        currentPane.classList.remove('active');

                        tabs.forEach(t => {
                            t.classList.remove('active');
                            t.setAttribute('aria-selected', 'false');
                        });

                        tab.classList.add('active');
                        tab.setAttribute('aria-selected', 'true');

                        const newPane = document.getElementById(`${targetTab}Tab`);
                        if (newPane) {
                            newPane.classList.add('active');
                            newPane.style.opacity = '0';
                            setTimeout(() => {
                                newPane.style.opacity = '1';
                            }, 50);
                        }

                        this.currentTab = targetTab;

                        if (typeof feather !== 'undefined') {
                            feather.replace();
                        }
                    }, 150);
                }
            });
        });
    }

    setupModals() {
        this.setupShareHandlers();
        this.setupLightbox();
    }

    setupShareHandlers() {
        const shareUrl = window.location.href;
        const shareTitle = this.personData?.name || 'Check out this person on CineBrain';
        const shareText = `${shareTitle}\n\n${this.personData?.biography?.substring(0, 100) || 'Discover amazing talent on CineBrain'}...`;

        const handlers = {
            shareWhatsApp: () => {
                const url = `https://wa.me/?text=${encodeURIComponent(shareText + '\n' + shareUrl)}`;
                window.open(url, '_blank');
            },
            shareTwitter: () => {
                const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareTitle)}&url=${encodeURIComponent(shareUrl)}`;
                window.open(url, '_blank');
            },
            shareFacebook: () => {
                const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}`;
                window.open(url, '_blank');
            },
            shareLinkedIn: () => {
                const url = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareUrl)}`;
                window.open(url, '_blank');
            },
            copyLink: async () => {
                try {
                    await navigator.clipboard.writeText(shareUrl);
                    this.showToast('Link copied to clipboard!', 'success');

                    const modal = bootstrap.Modal.getInstance(document.getElementById('shareModal'));
                    if (modal) modal.hide();
                } catch (error) {
                    this.showToast('Failed to copy link', 'error');
                }
            },
            shareMore: async () => {
                if (navigator.share) {
                    try {
                        await navigator.share({
                            title: shareTitle,
                            text: shareText,
                            url: shareUrl
                        });
                    } catch (error) {
                        console.log('Share cancelled or failed');
                    }
                } else {
                    this.showToast('Native sharing not supported', 'warning');
                }
            }
        };

        Object.entries(handlers).forEach(([id, handler]) => {
            const btn = document.getElementById(id);
            if (btn) {
                btn.addEventListener('click', handler);
            }
        });
    }

    setupLightbox() {
        // Lightbox is handled in renderPhotos method
    }

    openLightbox(imageIndex = 0) {
        if (!this.currentImageSet || this.currentImageSet.length === 0) return;

        this.currentImageIndex = imageIndex;
        const lightbox = document.getElementById('imageLightbox');
        const lightboxImage = document.getElementById('lightboxImage');

        if (!lightbox || !lightboxImage) return;

        this.updateLightboxImage();

        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';

        // Event handlers
        const closeBtn = document.getElementById('closeLightbox');
        const prevBtn = document.getElementById('lightboxPrev');
        const nextBtn = document.getElementById('lightboxNext');

        const closeLightbox = () => {
            lightbox.style.opacity = '0';
            setTimeout(() => {
                lightbox.classList.remove('active');
                lightbox.style.opacity = '1';
                document.body.style.overflow = '';
                document.removeEventListener('keydown', this.handleLightboxKeyboard);
            }, 200);
        };

        if (closeBtn) {
            closeBtn.addEventListener('click', closeLightbox, { once: true });
        }

        if (prevBtn) {
            prevBtn.addEventListener('click', () => this.navigateLightbox(-1));
        }

        if (nextBtn) {
            nextBtn.addEventListener('click', () => this.navigateLightbox(1));
        }

        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
                closeLightbox();
            }
        }, { once: true });

        this.handleLightboxKeyboard = (e) => {
            switch (e.key) {
                case 'Escape':
                    e.preventDefault();
                    closeLightbox();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    this.navigateLightbox(-1);
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    this.navigateLightbox(1);
                    break;
            }
        };

        document.addEventListener('keydown', this.handleLightboxKeyboard);
    }

    updateLightboxImage() {
        const lightboxImage = document.getElementById('lightboxImage');
        const lightboxCounter = document.getElementById('lightboxCounter');
        const prevBtn = document.getElementById('lightboxPrev');
        const nextBtn = document.getElementById('lightboxNext');

        if (!lightboxImage || !this.currentImageSet.length) return;

        const currentImage = this.currentImageSet[this.currentImageIndex];
        const imageUrl = currentImage.url || currentImage;

        lightboxImage.style.opacity = '0.5';
        lightboxImage.src = imageUrl;
        lightboxImage.alt = `Photo ${this.currentImageIndex + 1} of ${this.currentImageSet.length}`;

        lightboxImage.onload = () => {
            lightboxImage.style.opacity = '1';
        };

        if (lightboxCounter) {
            lightboxCounter.textContent = `${this.currentImageIndex + 1} / ${this.currentImageSet.length}`;
        }

        if (prevBtn) {
            prevBtn.classList.toggle('disabled', this.currentImageIndex === 0);
        }

        if (nextBtn) {
            nextBtn.classList.toggle('disabled', this.currentImageIndex === this.currentImageSet.length - 1);
        }
    }

    navigateLightbox(direction) {
        if (!this.currentImageSet.length) return;

        const newIndex = this.currentImageIndex + direction;

        if (newIndex >= 0 && newIndex < this.currentImageSet.length) {
            this.currentImageIndex = newIndex;
            this.updateLightboxImage();
        }
    }

    openShareModal() {
        const modal = new bootstrap.Modal(document.getElementById('shareModal'));
        modal.show();
    }

    hideLoader() {
        const loader = document.getElementById('pageLoader');
        if (loader) {
            loader.style.opacity = '0';
            setTimeout(() => {
                loader.classList.add('hidden');
                setTimeout(() => {
                    if (loader.parentNode) {
                        loader.parentNode.removeChild(loader);
                    }
                }, 300);
            }, 200);
        }
    }

    updateElement(elementId, value) {
        const element = document.getElementById(elementId);
        if (element) {
            element.textContent = value || '';
        }
    }

    formatPosterUrl(posterPath) {
        if (!posterPath) {
            return this.getPlaceholderImage();
        }
        if (posterPath.startsWith('http')) {
            return posterPath;
        }
        return `https://image.tmdb.org/t/p/w300${posterPath}`;
    }

    formatDate(dateString) {
        if (!dateString) return 'N/A';
        try {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        } catch {
            return dateString;
        }
    }

    getGenderText(gender) {
        const genderMap = {
            0: 'Not specified',
            1: 'Female',
            2: 'Male',
            3: 'Non-binary'
        };
        return genderMap[gender] || 'Not specified';
    }

    truncateText(text, maxLength) {
        if (!text || text.length <= maxLength) return text;
        return text.substring(0, maxLength) + '...';
    }

    showToast(message, type = 'success') {
        if (window.topbar?.notificationSystem) {
            window.topbar.notificationSystem.show(message, type);
        } else {
            console.log(`Toast: ${message} (${type})`);
        }
    }

    showError(message) {
        const container = document.querySelector('#main-content');
        if (container) {
            container.innerHTML = `
                <div style="text-align: center; padding: 50px 20px; min-height: 400px; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                    <i data-feather="alert-circle" style="width: 64px; height: 64px; color: var(--text-secondary); margin-bottom: 16px;"></i>
                    <h2 style="color: var(--text-primary); margin-bottom: 8px;">Error</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 20px;">${this.escapeHtml(message)}</p>
                    <a href="/" style="color: var(--cinebrain-primary); text-decoration: none; padding: 12px 24px; border: 1px solid var(--cinebrain-primary); border-radius: 8px;">Go Home</a>
                </div>
            `;

            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        }
    }

    escapeHtml(text) {
        if (!text || typeof text !== 'string') return '';
        const map = {
            '&': '&amp;',
            '<': '&lt;',
            '>': '&gt;',
            '"': '&quot;',
            "'": '&#039;'
        };
        return text.replace(/[&<>"']/g, m => map[m]);
    }

    getPlaceholderImage() {
        return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjQ1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjQ1MCIgZmlsbD0iIzFhMWYzYSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmaWxsPSIjNjY3IiBmb250LXNpemU9IjE4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+Tm8gSW1hZ2U8L3RleHQ+PC9zdmc+';
    }

    getPlaceholderAvatar() {
        return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iIzFhMWYzYSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmaWxsPSIjNjY3IiBmb250LXNpemU9IjE2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+Tm8gUGhvdG88L3RleHQ+PC9zdmc+';
    }
}

// Initialize the person page
document.addEventListener('DOMContentLoaded', () => {
    try {
        const personPage = new PersonPage();
        window.personPage = personPage;
    } catch (error) {
        console.error('Failed to initialize person page:', error);
    }
});