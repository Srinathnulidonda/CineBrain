<!-- Fixed Bottom Navigation (Mobile Only) -->
<nav class="mobile-bottom-nav fixed-bottom d-md-none bg-dark border-top border-secondary border-opacity-25 shadow-lg"
    style="backdrop-filter: blur(10px); z-index: 1040; padding-bottom: env(safe-area-inset-bottom);">

    <div class="container-fluid p-0">
        <div class="row g-0">
            <!-- Home Tab -->
            <div class="col">
                <button
                    class="nav-tab w-100 h-100 d-flex flex-column align-items-center justify-content-center py-2 bg-transparent border-0 text-light nav-item"
                    data-tab="home" data-url="index.html">
                    <i class="fas fa-home nav-icon mb-1" style="font-size: 1.2rem;"></i>
                    <span class="nav-label small" style="font-size: 0.7rem;">Home</span>
                </button>
            </div>

            <!-- Search Tab -->
            <div class="col">
                <button
                    class="nav-tab w-100 h-100 d-flex flex-column align-items-center justify-content-center py-2 bg-transparent border-0 text-light nav-item"
                    data-tab="search" data-url="content/search.html">
                    <i class="fas fa-search nav-icon mb-1" style="font-size: 1.2rem;"></i>
                    <span class="nav-label small" style="font-size: 0.7rem;">Search</span>
                </button>
            </div>

            <!-- Watchlist Tab -->
            <div class="col">
                <button
                    class="nav-tab w-100 h-100 d-flex flex-column align-items-center justify-content-center py-2 bg-transparent border-0 text-light nav-item"
                    data-tab="watchlist" data-url="user/watchlist.html">
                    <i class="fas fa-list nav-icon mb-1" style="font-size: 1.2rem;"></i>
                    <span class="nav-label small" style="font-size: 0.7rem;">Watchlist</span>
                </button>
            </div>

            <!-- Favorites Tab -->
            <div class="col">
                <button
                    class="nav-tab w-100 h-100 d-flex flex-column align-items-center justify-content-center py-2 bg-transparent border-0 text-light nav-item"
                    data-tab="favorites" data-url="user/favorites.html">
                    <i class="fas fa-heart nav-icon mb-1" style="font-size: 1.2rem;"></i>
                    <span class="nav-label small" style="font-size: 0.7rem;">Favorites</span>
                </button>
            </div>

            <!-- Profile Tab -->
            <div class="col">
                <button
                    class="nav-tab w-100 h-100 d-flex flex-column align-items-center justify-content-center py-2 bg-transparent border-0 text-light nav-item"
                    data-tab="profile" data-url="user/profile.html">
                    <i class="fas fa-user nav-icon mb-1" style="font-size: 1.2rem;"></i>
                    <span class="nav-label small" style="font-size: 0.7rem;">Profile</span>
                </button>
            </div>
        </div>
    </div>
</nav>

<script>
    class MobileNavigation {
        constructor() {
            this.currentTab = this.getCurrentTab();
            this.init();
        }

        init() {
            this.setActiveTab();
            this.attachEventListeners();
            this.addHapticFeedback();
        }

        getCurrentTab() {
            const path = window.location.pathname;

            if (path.includes('search')) return 'search';
            if (path.includes('watchlist')) return 'watchlist';
            if (path.includes('favorites')) return 'favorites';
            if (path.includes('profile')) return 'profile';

            return 'home';
        }

        setActiveTab() {
            // Remove active state from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.querySelector('.nav-icon').style.color = '#9ca3af';
                tab.querySelector('.nav-label').style.color = '#9ca3af';
            });

            // Set active tab
            const activeTab = document.querySelector(`[data-tab="${this.currentTab}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
                activeTab.querySelector('.nav-icon').style.color = '#3b82f6';
                activeTab.querySelector('.nav-label').style.color = '#3b82f6';
            }
        }

        attachEventListeners() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    const tabName = tab.dataset.tab;
                    const url = tab.dataset.url;

                    // Haptic feedback
                    this.triggerHapticFeedback();

                    // Visual feedback
                    this.animateTabPress(tab);

                    // Navigation
                    if (url && tabName !== this.currentTab) {
                        window.location.href = url;
                    }
                });
            });
        }

        addHapticFeedback() {
            // Check if device supports haptic feedback
            if ('vibrate' in navigator) {
                this.hapticSupported = true;
            }
        }

        triggerHapticFeedback() {
            if (this.hapticSupported) {
                // Light haptic feedback
                navigator.vibrate(10);
            }
        }

        animateTabPress(tab) {
            // Scale animation
            tab.style.transform = 'scale(0.95)';
            tab.style.transition = 'transform 0.1s ease';

            setTimeout(() => {
                tab.style.transform = 'scale(1)';
            }, 100);

            // Icon bounce
            const icon = tab.querySelector('.nav-icon');
            icon.style.transform = 'translateY(-2px)';
            icon.style.transition = 'transform 0.2s ease';

            setTimeout(() => {
                icon.style.transform = 'translateY(0)';
            }, 200);
        }

        updateActiveTab(newTab) {
            this.currentTab = newTab;
            this.setActiveTab();
        }
    }

    // Initialize mobile navigation
    document.addEventListener('DOMContentLoaded', () => {
        new MobileNavigation();
    });

    // Handle page changes for single-page apps
    window.addEventListener('popstate', () => {
        const mobileNav = new MobileNavigation();
    });
</script>

<style>
    .mobile-bottom-nav {
        height: calc(60px + env(safe-area-inset-bottom));
        background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
    }

    .nav-tab {
        min-height: 60px;
        transition: all 0.2s ease;
        position: relative;
    }

    .nav-tab:hover {
        background-color: rgba(59, 130, 246, 0.1) !important;
    }

    .nav-tab.active {
        background-color: rgba(59, 130, 246, 0.15) !important;
    }

    .nav-tab.active::before {
        content: '';
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 30px;
        height: 2px;
        background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        border-radius: 0 0 2px 2px;
    }

    .nav-icon {
        transition: all 0.2s ease;
    }

    .nav-label {
        transition: all 0.2s ease;
        font-weight: 500;
    }

    /* Safe area handling for iOS */
    @supports (padding-bottom: env(safe-area-inset-bottom)) {
        .mobile-bottom-nav {
            padding-bottom: env(safe-area-inset-bottom);
        }
    }

    /* Hide on desktop */
    @media (min-width: 768px) {
        .mobile-bottom-nav {
            display: none !important;
        }
    }
</style>