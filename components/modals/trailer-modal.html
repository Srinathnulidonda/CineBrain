<div class="trailer-modal" id="trailerModal">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
        <button class="modal-close" id="modalClose">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
        </button>
        <div class="trailer-container" id="trailerContainer"></div>
    </div>
</div>

<script>
(function() {
    const modal = document.getElementById('trailerModal');
    const container = document.getElementById('trailerContainer');
    const closeBtn = document.getElementById('modalClose');
    const backdrop = modal.querySelector('.modal-backdrop');
    
    function openTrailer(url) {
        if (!url) return;
        
        const videoId = url.includes('youtube.com') ? url.split('v=')[1]?.split('&')[0] : null;
        if (!videoId) return;
        
        container.innerHTML = `
            <iframe 
                src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
            </iframe>
        `;
        
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
    
    function closeTrailer() {
        modal.classList.remove('active');
        container.innerHTML = '';
        document.body.style.overflow = '';
    }
    
    window.addEventListener('openTrailer', (e) => openTrailer(e.detail.url));
    closeBtn.addEventListener('click', closeTrailer);
    backdrop.addEventListener('click', closeTrailer);
    
    // ESC key to close
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
            closeTrailer();
        }
    });
})();
</script>