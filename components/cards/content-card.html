<!-- CineBrain Content Card - Bootstrap 5 + Tailwind CSS -->
<div class="content-card card bg-dark border-secondary h-100 position-relative overflow-hidden" 
     style="transition: all 0.3s ease; cursor: pointer; border-radius: 12px;"
     onmouseover="hoverCardEffect(this, true)" 
     onmouseout="hoverCardEffect(this, false)"
     onclick="openContentDetails(this.dataset.contentId)">
  
  <!-- Poster Image -->
  <div class="position-relative overflow-hidden" style="height: 300px;">
    <img class="card-img-top content-poster w-100 h-100" 
         style="object-fit: cover; transition: transform 0.3s ease;" 
         alt="Content Poster"
         loading="lazy">
    
    <!-- Overlay with Play Button -->
    <div class="content-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center" 
         style="background: linear-gradient(135deg, rgba(0,0,0,0.3) 0%, rgba(59,130,246,0.1) 100%); opacity: 0; transition: opacity 0.3s ease;">
      <button class="btn btn-primary btn-lg rounded-circle" style="width: 60px; height: 60px;">
        <i class="fas fa-play"></i>
      </button>
    </div>

    <!-- Content Type Badge -->
    <div class="position-absolute top-2 start-2">
      <span class="content-type-badge badge text-white px-2 py-1 rounded-pill" 
            style="background: rgba(59, 130, 246, 0.9); font-size: 0.75rem; backdrop-filter: blur(5px);">
      </span>
    </div>

    <!-- Rating Badge -->
    <div class="position-absolute top-2 end-2">
      <span class="rating-badge badge text-white px-2 py-1 rounded-pill d-flex align-items-center gap-1" 
            style="background: rgba(245, 158, 11, 0.9); font-size: 0.75rem; backdrop-filter: blur(5px);">
        <i class="fas fa-star"></i>
        <span class="rating-value">N/A</span>
      </span>
    </div>
  </div>

  <!-- Card Body -->
  <div class="card-body p-3 d-flex flex-column">
    <!-- Title -->
    <h6 class="card-title text-white fw-semibold mb-2 content-title" 
        style="line-height: 1.3; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;">
    </h6>

    <!-- Genres -->
    <div class="content-genres mb-2">
      <!-- Genre chips will be populated here -->
    </div>

    <!-- Overview -->
    <p class="card-text text-muted small mb-3 content-overview flex-grow-1" 
       style="line-height: 1.4; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical;">
    </p>

    <!-- Action Buttons -->
    <div class="d-flex gap-2 mt-auto">
      <button class="btn btn-primary btn-sm flex-grow-1 watchlist-btn" 
              onclick="event.stopPropagation(); toggleWatchlist(this.closest('.content-card').dataset.contentId, this)">
        <i class="fas fa-bookmark me-1"></i>
        <span>Watchlist</span>
      </button>
      <button class="btn btn-outline-danger btn-sm favorite-btn" 
              onclick="event.stopPropagation(); toggleFavorite(this.closest('.content-card').dataset.contentId, this)"
              style="width: 45px;">
        <i class="fas fa-heart"></i>
      </button>
    </div>
  </div>
</div>

<script>
// Content Card Component JavaScript
(function() {
  // Card hover effects
  window.hoverCardEffect = function(card, isHover) {
    const poster = card.querySelector('.content-poster');
    const overlay = card.querySelector('.content-overlay');
    
    if (isHover) {
      card.style.transform = 'translateY(-8px) scale(1.02)';
      card.style.boxShadow = '0 20px 40px rgba(59, 130, 246, 0.3)';
      poster.style.transform = 'scale(1.1)';
      overlay.style.opacity = '1';
    } else {
      card.style.transform = 'translateY(0) scale(1)';
      card.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.3)';
      poster.style.transform = 'scale(1)';
      overlay.style.opacity = '0';
    }
  };

  // Open content details
  window.openContentDetails = function(contentId) {
    if (contentId) {
      window.location.href = `/content/details.html?id=${contentId}`;
    }
  };

  // Toggle watchlist
  window.toggleWatchlist = async function(contentId, button) {
    const token = localStorage.getItem('cinebrain_token');
    if (!token) {
      window.location.href = '/auth/login.html';
      return;
    }

    try {
      const response = await fetch(`${API_ENDPOINTS.BASE_URL}${API_ENDPOINTS.INTERACTIONS}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`
        },
        body: JSON.stringify({
          content_id: parseInt(contentId),
          interaction_type: 'watchlist'
        })
      });

      if (response.ok) {
        const icon = button.querySelector('i');
        const text = button.querySelector('span');
        
        if (button.classList.contains('btn-primary')) {
          button.classList.remove('btn-primary');
          button.classList.add('btn-success');
          icon.classList.remove('fa-bookmark');
          icon.classList.add('fa-check');
          text.textContent = 'Added';
          
          // Revert after 2 seconds
          setTimeout(() => {
            button.classList.remove('btn-success');
            button.classList.add('btn-primary');
            icon.classList.remove('fa-check');
            icon.classList.add('fa-bookmark');
            text.textContent = 'Watchlist';
          }, 2000);
        }
        
        // Add success animation
        button.style.transform = 'scale(0.95)';
        setTimeout(() => {
          button.style.transform = 'scale(1)';
        }, 150);
      }
    } catch (error) {
      console.error('Watchlist toggle failed:', error);
    }
  };

  // Toggle favorite
  window.toggleFavorite = async function(contentId, button) {
    const token = localStorage.getItem('cinebrain_token');
    if (!token) {
      window.location.href = '/auth/login.html';
      return;
    }

    try {
      const response = await fetch(`${API_ENDPOINTS.BASE_URL}${API_ENDPOINTS.INTERACTIONS}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`
        },
        body: JSON.stringify({
          content_id: parseInt(contentId),
          interaction_type: 'favorite'
        })
      });

      if (response.ok) {
        const icon = button.querySelector('i');
        
        // Toggle favorite state
        if (icon.classList.contains('fas')) {
          button.classList.remove('btn-outline-danger');
          button.classList.add('btn-danger');
          
          // Heart beat animation
          icon.style.animation = 'heartbeat 0.6s ease-in-out';
          setTimeout(() => {
            icon.style.animation = '';
          }, 600);
        } else {
          button.classList.remove('btn-danger');
          button.classList.add('btn-outline-danger');
        }
      }
    } catch (error) {
      console.error('Favorite toggle failed:', error);
    }
  };

  // Populate card with content data
  window.populateContentCard = function(cardElement, contentData) {
    // Set data attributes
    cardElement.dataset.contentId = contentData.id;
    
    // Populate poster
    const poster = cardElement.querySelector('.content-poster');
    poster.src = contentData.poster_path || '/assets/no-poster.jpg';
    poster.alt = contentData.title;
    poster.onerror = function() { this.src = '/assets/no-poster.jpg'; };
    
    // Populate title
    const title = cardElement.querySelector('.content-title');
    title.textContent = contentData.title;
    
    // Populate content type badge
    const typeBadge = cardElement.querySelector('.content-type-badge');
    typeBadge.textContent = contentData.content_type.toUpperCase();
    
    // Populate rating
    const ratingValue = cardElement.querySelector('.rating-value');
    const ratingBadge = cardElement.querySelector('.rating-badge');
    if (contentData.rating) {
      ratingValue.textContent = parseFloat(contentData.rating).toFixed(1);
      
      // Color code rating
      const rating = parseFloat(contentData.rating);
      if (rating >= 8) {
        ratingBadge.style.background = 'rgba(34, 197, 94, 0.9)'; // Green
      } else if (rating >= 6) {
        ratingBadge.style.background = 'rgba(245, 158, 11, 0.9)'; // Orange
      } else {
        ratingBadge.style.background = 'rgba(239, 68, 68, 0.9)'; // Red
      }
    } else {
      ratingValue.textContent = 'N/A';
    }
    
    // Populate genres
    const genresContainer = cardElement.querySelector('.content-genres');
    if (contentData.genres && contentData.genres.length > 0) {
      const genreChips = contentData.genres.slice(0, 2).map(genre => 
        `<span class="badge bg-secondary me-1 mb-1 text-white" style="font-size: 0.7rem;">${genre}</span>`
      ).join('');
      genresContainer.innerHTML = genreChips;
    }
    
    // Populate overview
    const overview = cardElement.querySelector('.content-overview');
    if (contentData.overview) {
      overview.textContent = contentData.overview;
    } else {
      overview.textContent = 'No description available.';
    }
  };
})();

// CSS Animations
const cardStyles = `
<style>
@keyframes heartbeat {
  0% { transform: scale(1); }
  25% { transform: scale(1.2); }
  50% { transform: scale(1); }
  75% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.content-card {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.content-card:hover {
  z-index: 10;
}

.content-poster {
  transition: transform 0.3s ease;
}

.content-overlay {
  transition: opacity 0.3s ease;
}

.btn {
  transition: all 0.2s ease;
}

.btn:active {
  transform: scale(0.95);
}
</style>
`;

// Inject styles
document.head.insertAdjacentHTML('beforeend', cardStyles);
</script>