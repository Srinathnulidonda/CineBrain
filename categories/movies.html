<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Movies - CineScope</title>
  
  <!-- CSS -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/components.css">
  <link rel="stylesheet" href="/css/responsive.css">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
  <style>
    .genre-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: var(--space-md);
      margin-bottom: var(--space-2xl);
    }
    
    .genre-card {
      background: var(--gradient-card);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-base);
      position: relative;
      overflow: hidden;
    }
    
    .genre-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: var(--gradient-primary);
      opacity: 0;
      transition: opacity var(--transition-base);
      border-radius: 50%;
    }
    
    .genre-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }
    
    .genre-card:hover::before {
      opacity: 0.1;
    }
    
    .genre-icon {
      font-size: 2rem;
      margin-bottom: var(--space-sm);
      position: relative;
      z-index: 1;
    }
    
    .genre-name {
      font-weight: 600;
      position: relative;
      z-index: 1;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar">
    <div class="container navbar-content">
      <a href="/" class="navbar-brand gradient-text">CineScope</a>
      
      <button class="mobile-menu-toggle md:hidden">
        <i class="fas fa-bars"></i>
      </button>
      
      <div class="navbar-menu hidden md:flex">
        <a href="/" class="navbar-link">Home</a>
        <a href="/categories/movies.html" class="navbar-link active">Movies</a>
        <a href="/categories/tv-shows.html" class="navbar-link">TV Shows</a>
        <a href="/categories/anime.html" class="navbar-link">Anime</a>
        
        <div class="search-container">
          <input type="text" class="search-input" placeholder="Search movies...">
          <i class="fas fa-search search-icon"></i>
          <div class="search-suggestions" style="display: none;"></div>
        </div>
        
        <div class="auth-buttons flex gap-sm">
          <a href="/login.html" class="btn btn-ghost btn-sm">Login</a>
          <a href="/login.html#register" class="btn btn-primary btn-sm">Sign Up</a>
        </div>
        
        <div class="user-menu" style="display: none;"></div>
      </div>
    </div>
  </nav>
  
  <!-- Page Header -->
  <header class="bg-gradient-primary p-xl mb-xl" style="margin-top: 60px;">
    <div class="container">
      <h1 class="text-white mb-sm">
        <i class="fas fa-film mr-sm"></i> Movies
      </h1>
      <p class="text-white opacity-80">Explore our vast collection of films from around the world</p>
    </div>
  </header>
  
  <!-- Main Content -->
  <main class="container">
    <!-- Browse by Genre -->
    <section class="mb-2xl">
      <h2 class="mb-lg">Browse by Genre</h2>
      <div class="genre-grid">
        <div class="genre-card" onclick="loadGenre('action')">
          <div class="genre-icon">💥</div>
          <div class="genre-name">Action</div>
        </div>
        <div class="genre-card" onclick="loadGenre('adventure')">
          <div class="genre-icon">🗺️</div>
          <div class="genre-name">Adventure</div>
        </div>
        <div class="genre-card" onclick="loadGenre('comedy')">
          <div class="genre-icon">😄</div>
          <div class="genre-name">Comedy</div>
        </div>
        <div class="genre-card" onclick="loadGenre('drama')">
          <div class="genre-icon">🎭</div>
          <div class="genre-name">Drama</div>
        </div>
        <div class="genre-card" onclick="loadGenre('horror')">
          <div class="genre-icon">👻</div>
          <div class="genre-name">Horror</div>
        </div>
        <div class="genre-card" onclick="loadGenre('romance')">
          <div class="genre-icon">💕</div>
          <div class="genre-name">Romance</div>
        </div>
        <div class="genre-card" onclick="loadGenre('sci-fi')">
          <div class="genre-icon">🚀</div>
          <div class="genre-name">Sci-Fi</div>
        </div>
        <div class="genre-card" onclick="loadGenre('thriller')">
          <div class="genre-icon">🔍</div>
          <div class="genre-name">Thriller</div>
        </div>
      </div>
    </section>
    
    <!-- Featured Collections -->
    <section class="mb-2xl">
      <h2 class="mb-lg">Featured Collections</h2>
      <div class="grid gap-lg" style="grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));">
        <div class="card p-lg cursor-pointer" onclick="loadCollection('oscar-winners')">
          <h3 class="mb-sm">🏆 Oscar Winners</h3>
          <p class="text-secondary text-sm">Academy Award winning films</p>
        </div>
        <div class="card p-lg cursor-pointer" onclick="loadCollection('box-office')">
          <h3 class="mb-sm">💰 Box Office Hits</h3>
          <p class="text-secondary text-sm">Highest grossing movies</p>
        </div>
        <div class="card p-lg cursor-pointer" onclick="loadCollection('indie')">
          <h3 class="mb-sm">🎬 Indie Gems</h3>
          <p class="text-secondary text-sm">Independent cinema masterpieces</p>
        </div>
        <div class="card p-lg cursor-pointer" onclick="loadCollection('classics')">
          <h3 class="mb-sm">🎞️ Classics</h3>
          <p class="text-secondary text-sm">Timeless cinematic treasures</p>
        </div>
      </div>
    </section>
    
    <!-- All Movies -->
    <section>
      <div class="flex-between mb-lg">
        <h2>All Movies</h2>
        <div class="filter-container">
          <select class="form-select filter-select" id="sort-filter">
            <option value="popularity">Most Popular</option>
            <option value="rating">Highest Rated</option>
            <option value="release">Latest Release</option>
            <option value="title">Title (A-Z)</option>
          </select>
        </div>
      </div>
      
      <div id="category-content">
        <div class="grid">
          <div class="skeleton" style="height: 300px;"></div>
          <div class="skeleton" style="height: 300px;"></div>
          <div class="skeleton" style="height: 300px;"></div>
          <div class="skeleton" style="height: 300px;"></div>
          <div class="skeleton" style="height: 300px;"></div>
          <div class="skeleton" style="height: 300px;"></div>
        </div>
      </div>
      
      <!-- Load More -->
      <div class="text-center mt-xl">
        <button class="btn btn-secondary" onclick="loadMore()">
          <i class="fas fa-plus mr-sm"></i> Load More Movies
        </button>
      </div>
    </section>
  </main>
  
  <!-- Toast Container -->
  <div class="toast-container"></div>
  
  <!-- Scripts -->
  <script src="/js/main.js"></script>
  <script>
    let currentPage = 1;
    let currentSort = 'popularity';
    let currentGenre = null;
    let allMovies = [];
    
    // Sort handler
    document.getElementById('sort-filter').addEventListener('change', (e) => {
      currentSort = e.target.value;
      sortMovies();
    });
    
    // Load movies by genre
    async function loadGenre(genre) {
      currentGenre = genre;
      currentPage = 1;
      allMovies = [];
      
      try {
        const data = await ApiService.getGenreRecommendations(genre, 'movie', 50);
        allMovies = data.recommendations || [];
        
        const container = document.getElementById('category-content');
        renderContentGrid(container, allMovies);
        
        // Scroll to movies section
        container.scrollIntoView({ behavior: 'smooth', block: 'start' });
        
      } catch (error) {
        console.error('Failed to load genre:', error);
      }
    }
    
    // Load collection
    async function loadCollection(collection) {
      showToast(`Loading ${collection.replace('-', ' ')} collection...`, 'info');
      
      // In a real app, this would load specific collections
      // For now, we'll load critics choice as a placeholder
      try {
        const data = await ApiService.getCriticsChoice('movie', 20);
        allMovies = data.recommendations || [];
        
        const container = document.getElementById('category-content');
        renderContentGrid(container, allMovies);
        
        container.scrollIntoView({ behavior: 'smooth', block: 'start' });
        
      } catch (error) {
        console.error('Failed to load collection:', error);
      }
    }
    
    // Load all movies
    async function loadMovies() {
      try {
        const data = await ApiService.getTrending('movie', 20);
        allMovies = currentPage === 1 ? data.recommendations || [] : [...allMovies, ...(data.recommendations || [])];
        
        const container = document.getElementById('category-content');
        renderContentGrid(container, allMovies);
        
      } catch (error) {
        console.error('Failed to load movies:', error);
      }
    }
    
    // Sort movies
    function sortMovies() {
      const sorted = [...allMovies];
      
      switch (currentSort) {
        case 'rating':
          sorted.sort((a, b) => (b.rating || 0) - (a.rating || 0));
          break;
        case 'release':
          sorted.sort((a, b) => {
            const dateA = a.release_date ? new Date(a.release_date) : new Date(0);
            const dateB = b.release_date ? new Date(b.release_date) : new Date(0);
            return dateB - dateA;
          });
          break;
        case 'title':
          sorted.sort((a, b) => a.title.localeCompare(b.title));
          break;
        case 'popularity':
        default:
          // Already sorted by popularity from API
          break;
      }
      
      const container = document.getElementById('category-content');
      renderContentGrid(container, sorted);
    }
    
    // Load more
    function loadMore() {
      currentPage++;
      loadMovies();
    }
    
    // Initialize
    updateAuthUI();
    loadMovies();
  </script>
</body>
</html>