<!-- CineScope Mobile Bottom Navigation -->
<nav id="mobile-nav" class="mobile-nav d-lg-none">
    <div class="d-flex justify-content-around align-items-center h-100">
        <!-- Home -->
        <a href="/" class="mobile-nav-item">
            <i class="bi bi-house-fill"></i>
            <span>Home</span>
        </a>

        <!-- Search -->
        <a href="/search" class="mobile-nav-item" id="mobile-search-link">
            <i class="bi bi-search"></i>
            <span>Search</span>
        </a>

        <!-- Discover -->
        <button class="mobile-nav-item border-0 bg-transparent" type="button" data-bs-toggle="offcanvas"
            data-bs-target="#discoverOffcanvas">
            <i class="bi bi-compass"></i>
            <span>Discover</span>
        </button>

        <!-- Profile/Login -->
        <a href="/login" class="mobile-nav-item" id="mobile-profile-link">
            <i class="bi bi-person-circle"></i>
            <span>Profile</span>
        </a>

        <!-- Watchlist (logged in users) -->
        <a href="#" class="mobile-nav-item d-none" id="mobile-watchlist-link" data-user-route="watchlist">
            <i class="bi bi-bookmark"></i>
            <span>Watchlist</span>
        </a>
    </div>
</nav>

<!-- Discover Offcanvas -->
<div class="offcanvas offcanvas-bottom" tabindex="-1" id="discoverOffcanvas">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Discover Content</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        <div class="row g-3">
            <!-- Categories -->
            <div class="col-6">
                <a href="/?section=trending" class="card bg-dark border-primary h-100 text-decoration-none">
                    <div class="card-body text-center">
                        <i class="bi bi-fire display-6 text-primary mb-2"></i>
                        <h6 class="card-title text-white">Trending</h6>
                        <p class="card-text text-muted small">What's hot now</p>
                    </div>
                </a>
            </div>
            <div class="col-6">
                <a href="/?section=new-releases" class="card bg-dark border-success h-100 text-decoration-none">
                    <div class="card-body text-center">
                        <i class="bi bi-star display-6 text-success mb-2"></i>
                        <h6 class="card-title text-white">New Releases</h6>
                        <p class="card-text text-muted small">Latest additions</p>
                    </div>
                </a>
            </div>
            <div class="col-6">
                <a href="/?section=critics-choice" class="card bg-dark border-warning h-100 text-decoration-none">
                    <div class="card-body text-center">
                        <i class="bi bi-award display-6 text-warning mb-2"></i>
                        <h6 class="card-title text-white">Critics' Choice</h6>
                        <p class="card-text text-muted small">Highly rated</p>
                    </div>
                </a>
            </div>
            <div class="col-6">
                <a href="/content/anime" class="card bg-dark border-info h-100 text-decoration-none">
                    <div class="card-body text-center">
                        <i class="bi bi-heart-eyes display-6 text-info mb-2"></i>
                        <h6 class="card-title text-white">Anime</h6>
                        <p class="card-text text-muted small">Japanese animation</p>
                    </div>
                </a>
            </div>
        </div>

        <!-- Genres -->
        <h6 class="mt-4 mb-3 text-white">Browse by Genre</h6>
        <div class="row g-2">
            <div class="col-4">
                <a href="/content/genre/action" class="btn btn-outline-primary w-100 btn-sm">Action</a>
            </div>
            <div class="col-4">
                <a href="/content/genre/comedy" class="btn btn-outline-primary w-100 btn-sm">Comedy</a>
            </div>
            <div class="col-4">
                <a href="/content/genre/drama" class="btn btn-outline-primary w-100 btn-sm">Drama</a>
            </div>
            <div class="col-4">
                <a href="/content/genre/horror" class="btn btn-outline-primary w-100 btn-sm">Horror</a>
            </div>
            <div class="col-4">
                <a href="/content/genre/sci-fi" class="btn btn-outline-primary w-100 btn-sm">Sci-Fi</a>
            </div>
            <div class="col-4">
                <a href="/content/genre/romance" class="btn btn-outline-primary w-100 btn-sm">Romance</a>
            </div>
        </div>

        <!-- Regional -->
        <h6 class="mt-4 mb-3 text-white">Regional Content</h6>
        <div class="row g-2">
            <div class="col-4">
                <a href="/content/regional/hindi" class="btn btn-outline-secondary w-100 btn-sm">Hindi</a>
            </div>
            <div class="col-4">
                <a href="/content/regional/telugu" class="btn btn-outline-secondary w-100 btn-sm">Telugu</a>
            </div>
            <div class="col-4">
                <a href="/content/regional/tamil" class="btn btn-outline-secondary w-100 btn-sm">Tamil</a>
            </div>
            <div class="col-4">
                <a href="/content/regional/kannada" class="btn btn-outline-secondary w-100 btn-sm">Kannada</a>
            </div>
            <div class="col-4">
                <a href="/content/regional/malayalam" class="btn btn-outline-secondary w-100 btn-sm">Malayalam</a>
            </div>
            <div class="col-4">
                <a href="/content/regional/english" class="btn btn-outline-secondary w-100 btn-sm">English</a>
            </div>
        </div>
    </div>
</div>

<script>
    // Initialize mobile navigation
    document.addEventListener('DOMContentLoaded', function () {
        // Update navigation based on user state
        const currentUser = CineScope.Storage.user.get();
        const profileLink = document.getElementById('mobile-profile-link');
        const watchlistLink = document.getElementById('mobile-watchlist-link');
        const searchLink = document.getElementById('mobile-search-link');

        if (currentUser) {
            // User is logged in
            profileLink.href = `/${currentUser.username}/profile`;
            profileLink.querySelector('span').textContent = currentUser.username;

            // Update search link
            searchLink.href = `/${currentUser.username}/search`;

            // Show watchlist link
            watchlistLink.classList.remove('d-none');
            watchlistLink.href = `/${currentUser.username}/watchlist`;
        } else {
            // User not logged in
            profileLink.href = '/login';
            profileLink.querySelector('span').textContent = 'Login';
            searchLink.href = '/search';
            watchlistLink.classList.add('d-none');
        }

        // Set active state based on current URL
        const currentPath = window.location.pathname;
        const navItems = document.querySelectorAll('.mobile-nav-item');

        navItems.forEach(item => {
            const href = item.getAttribute('href');
            if (href && (currentPath === href || currentPath.startsWith(href + '/'))) {
                item.classList.add('active');
            }
        });
    });
</script>