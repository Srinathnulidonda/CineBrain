<!-- CineScope Container Layout Template -->
<div class="container-layout">
    <!-- Top Bar Container (Desktop) -->
    <div id="topbar-container" class="d-none d-lg-block"></div>

    <!-- Main Content Area -->
    <main class="main-content">
        <div class="container-fluid">
            <!-- Page Header Slot -->
            <div id="page-header" class="page-header mb-4">
                <!-- Dynamic page header content -->
            </div>

            <!-- Content Area -->
            <div id="content-area" class="content-area">
                <!-- Dynamic page content -->
            </div>

            <!-- Footer Slot -->
            <div id="page-footer" class="page-footer mt-5">
                <!-- Dynamic page footer content -->
            </div>
        </div>
    </main>

    <!-- Mobile Navigation Container -->
    <div id="mobile-nav-container" class="d-lg-none"></div>

    <!-- Overlay for mobile interactions -->
    <div id="mobile-overlay" class="mobile-overlay"></div>
</div>

<!-- Common Modals Container -->
<div id="modals-container">
    <!-- Dynamic modals will be inserted here -->
</div>

<!-- Toast Container -->
<div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 9999;"></div>

<style>
    .container-layout {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }

    .main-content {
        flex: 1;
        padding-top: 80px;
        /* Desktop topbar height */
        padding-bottom: 20px;
    }

    .page-header {
        padding: 2rem 0 1rem;
        border-bottom: 1px solid var(--cs-border);
        margin-bottom: 2rem;
    }

    .page-header h1 {
        margin-bottom: 0.5rem;
        background: var(--cs-gradient-primary);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .page-header .breadcrumb {
        background: transparent;
        padding: 0;
        margin: 0;
    }

    .page-header .breadcrumb-item+.breadcrumb-item::before {
        color: var(--cs-text-muted);
    }

    .content-area {
        min-height: 60vh;
    }

    .page-footer {
        border-top: 1px solid var(--cs-border);
        padding: 2rem 0;
        text-align: center;
        color: var(--cs-text-muted);
    }

    .mobile-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(4px);
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .mobile-overlay.show {
        opacity: 1;
        visibility: visible;
    }

    /* Mobile Adjustments */
    @media (max-width: 991.98px) {
        .main-content {
            padding-top: 20px;
            padding-bottom: calc(80px + env(safe-area-inset-bottom, 0));
        }

        .page-header {
            padding: 1rem 0 0.5rem;
            margin-bottom: 1.5rem;
        }

        .page-header h1 {
            font-size: 1.75rem;
        }
    }

    /* Loading State */
    .content-area.loading {
        opacity: 0.7;
        pointer-events: none;
    }

    .content-area.loading::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 40px;
        height: 40px;
        margin: -20px 0 0 -20px;
        border: 3px solid var(--cs-border);
        border-top-color: var(--cs-premium-blue);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        to {
            transform: rotate(360deg);
        }
    }

    /* Error State */
    .content-area.error {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 400px;
        text-align: center;
    }

    .content-area.error .error-content {
        max-width: 400px;
    }

    .content-area.error .error-icon {
        font-size: 4rem;
        color: var(--cs-text-muted);
        margin-bottom: 1rem;
    }

    .content-area.error .error-title {
        font-size: 1.5rem;
        color: var(--cs-text-primary);
        margin-bottom: 0.5rem;
    }

    .content-area.error .error-message {
        color: var(--cs-text-muted);
        margin-bottom: 2rem;
    }

    /* Empty State */
    .content-area.empty {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 400px;
        text-align: center;
    }

    .content-area.empty .empty-content {
        max-width: 400px;
    }

    .content-area.empty .empty-icon {
        font-size: 4rem;
        color: var(--cs-text-muted);
        margin-bottom: 1rem;
    }

    .content-area.empty .empty-title {
        font-size: 1.5rem;
        color: var(--cs-text-primary);
        margin-bottom: 0.5rem;
    }

    .content-area.empty .empty-message {
        color: var(--cs-text-muted);
        margin-bottom: 2rem;
    }
</style>

<script>
    // Container layout utilities
    window.CineScope = window.CineScope || {};
    window.CineScope.Layout = {
        // Set page header
        setHeader(title, subtitle = '', breadcrumbs = []) {
            const headerContainer = document.getElementById('page-header');
            if (!headerContainer) return;

            let breadcrumbHtml = '';
            if (breadcrumbs.length > 0) {
                const breadcrumbItems = breadcrumbs.map((item, index) => {
                    const isLast = index === breadcrumbs.length - 1;
                    if (isLast) {
                        return `<li class="breadcrumb-item active">${item.label}</li>`;
                    } else {
                        return `<li class="breadcrumb-item"><a href="${item.href}" class="text-decoration-none">${item.label}</a></li>`;
                    }
                }).join('');

                breadcrumbHtml = `
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            ${breadcrumbItems}
          </ol>
        </nav>
      `;
            }

            headerContainer.innerHTML = `
      ${breadcrumbHtml}
      <h1>${title}</h1>
      ${subtitle ? `<p class="lead text-muted">${subtitle}</p>` : ''}
    `;
        },

        // Set content area
        setContent(html) {
            const contentArea = document.getElementById('content-area');
            if (contentArea) {
                contentArea.className = 'content-area';
                contentArea.innerHTML = html;
            }
        },

        // Show loading state
        showLoading(message = 'Loading...') {
            const contentArea = document.getElementById('content-area');
            if (contentArea) {
                contentArea.className = 'content-area loading';
                contentArea.innerHTML = `
        <div class="d-flex justify-content-center align-items-center py-5">
          <div class="text-center">
            <div class="spinner-border text-primary mb-3" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="text-muted">${message}</p>
          </div>
        </div>
      `;
            }
        },

        // Show error state
        showError(title = 'Something went wrong', message = 'Please try again later') {
            const contentArea = document.getElementById('content-area');
            if (contentArea) {
                contentArea.className = 'content-area error';
                contentArea.innerHTML = `
        <div class="error-content">
          <i class="bi bi-exclamation-triangle error-icon"></i>
          <h3 class="error-title">${title}</h3>
          <p class="error-message">${message}</p>
          <button class="btn btn-primary" onclick="window.location.reload()">
            <i class="bi bi-arrow-clockwise me-2"></i>Try Again
          </button>
        </div>
      `;
            }
        },

        // Show empty state
        showEmpty(title = 'No content found', message = 'Try adjusting your search or filters', actionButton = null) {
            const contentArea = document.getElementById('content-area');
            if (contentArea) {
                contentArea.className = 'content-area empty';

                let actionHtml = '';
                if (actionButton) {
                    actionHtml = `
          <button class="btn btn-primary" onclick="${actionButton.onClick}">
            ${actionButton.icon ? `<i class="bi bi-${actionButton.icon} me-2"></i>` : ''}
            ${actionButton.text}
          </button>
        `;
                }

                contentArea.innerHTML = `
        <div class="empty-content">
          <i class="bi bi-search empty-icon"></i>
          <h3 class="empty-title">${title}</h3>
          <p class="empty-message">${message}</p>
          ${actionHtml}
        </div>
      `;
            }
        },

        // Set footer
        setFooter(html) {
            const footerContainer = document.getElementById('page-footer');
            if (footerContainer) {
                footerContainer.innerHTML = html;
            }
        },

        // Show mobile overlay
        showMobileOverlay() {
            const overlay = document.getElementById('mobile-overlay');
            if (overlay) {
                overlay.classList.add('show');
            }
        },

        // Hide mobile overlay
        hideMobileOverlay() {
            const overlay = document.getElementById('mobile-overlay');
            if (overlay) {
                overlay.classList.remove('show');
            }
        }
    };

    // Initialize layout on DOM ready
    document.addEventListener('DOMContentLoaded', function () {
        // Set default footer
        CineScope.Layout.setFooter(`
    <div class="row">
      <div class="col-md-6">
        <h6 class="text-primary mb-3">CineScope</h6>
        <p class="small">Your premium destination for movie and TV discovery. Powered by advanced AI recommendations.</p>
      </div>
      <div class="col-md-6">
        <div class="row">
          <div class="col-6">
            <h6 class="small text-uppercase mb-3">Quick Links</h6>
            <ul class="list-unstyled small">
              <li><a href="/" class="text-muted text-decoration-none">Home</a></li>
              <li><a href="/search" class="text-muted text-decoration-none">Search</a></li>
              <li><a href="/content/anime" class="text-muted text-decoration-none">Anime</a></li>
            </ul>
          </div>
          <div class="col-6">
            <h6 class="small text-uppercase mb-3">Categories</h6>
            <ul class="list-unstyled small">
              <li><a href="/content/genre/action" class="text-muted text-decoration-none">Action</a></li>
              <li><a href="/content/genre/comedy" class="text-muted text-decoration-none">Comedy</a></li>
              <li><a href="/content/genre/drama" class="text-muted text-decoration-none">Drama</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <hr class="my-4">
    <div class="text-center">
      <p class="small mb-0">&copy; 2024 CineScope. All rights reserved. | <a href="#" class="text-muted">Privacy Policy</a> | <a href="#" class="text-muted">Terms of Service</a></p>
    </div>
  `);

        // Handle mobile overlay clicks
        const overlay = document.getElementById('mobile-overlay');
        if (overlay) {
            overlay.addEventListener('click', function () {
                CineScope.Layout.hideMobileOverlay();
            });
        }
    });
</script>